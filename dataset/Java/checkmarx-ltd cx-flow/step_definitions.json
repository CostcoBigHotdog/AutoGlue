[
  {
    "step_definition_id": 621,
    "annotation": "\n    @When(\"doing get results operation on SAST scan with {int} {int} {int} {int} results\")",
    "glue_code": "    @When(\"doing get results operation on SAST scan with {int} {int} {int} {int} results\")\n    public void getSASTResults(int high, int medium, int low, int info) throws InterruptedException {\n        try {\n            scanResultsToInject = createFakeSASTScanResults();\n            ScanRequest scanRequest = createScanRequest();\n            setFindingsSummary(high, medium, low, info);\n            addAdditionalInfoToResults();\n            addFlowSummaryToResults(high, medium, low, info);\n            CompletableFuture<ScanResults> task = resultsService.processScanResultsAsync(\n                    scanRequest, PROJECT_ID, SCAN_ID, null, null);\n            task.get(1, TimeUnit.MINUTES);\n        } catch (MachinaException | ExecutionException | TimeoutException e) {\n            String message = \"Error processing scan results.\";\n            log.error(message, e);\n            Assert.fail(message);\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 226,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get/GetResultsAnalyticsTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get",
      "filename": "GetResultsAnalyticsTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 622,
    "annotation": "\n    @When(\"doing get results operation on SCA scan with {int} {int} {int} results\")",
    "glue_code": "    @When(\"doing get results operation on SCA scan with {int} {int} {int} results\")\n    public void getSCAResults(int high, int medium, int low) throws InterruptedException {\n        try {\n            scanResultsToInject = createFakeSCAScanResults(high, medium, low);\n            ScanRequest scanRequest = createScanRequest();\n\n            //addAdditionalInfoToResults();\n            //addFlowSummaryToResults(high, medium, low, info);\n            CompletableFuture<ScanResults> task = resultsService.processScanResultsAsync(\n                    scanRequest, PROJECT_ID, SCAN_ID, null, null);\n            task.get(1, TimeUnit.MINUTES);\n        } catch (MachinaException | ExecutionException | TimeoutException e) {\n            String message = \"Error processing scan results.\";\n            log.error(message, e);\n            Assert.fail(message);\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 244,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get/GetResultsAnalyticsTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get",
      "filename": "GetResultsAnalyticsTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 623,
    "annotation": "\n    @When(\"doing get results operation on SAST scan with {int} {int} {int} {int} results and filter is {string}\")",
    "glue_code": "    @When(\"doing get results operation on SAST scan with {int} {int} {int} {int} results and filter is {string}\")\n    public void getResultsWithFilter(int high, int medium, int low, int info, String filter) throws InterruptedException  {\n        try {\n            scanResultsToInject = createFakeSASTScanResults();\n            ScanRequest scanRequest = createScanRequest();\n            setFindingsSummary(high, medium, low, info, filter);\n            addAdditionalInfoToResults();\n            addFlowSummaryToResults(high, medium, low, info);\n            CompletableFuture<ScanResults> task = resultsService.processScanResultsAsync(\n                    scanRequest, PROJECT_ID, SCAN_ID, null, null);\n            task.get(1, TimeUnit.MINUTES);\n        } catch (MachinaException | ExecutionException | TimeoutException e) {\n            String message = \"Error processing scan results.\";\n            log.error(message, e);\n            Assert.fail(message);\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 262,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get/GetResultsAnalyticsTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get",
      "filename": "GetResultsAnalyticsTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 624,
    "annotation": "    @Then(\"we should see the expected number of tickets in analytics for SAST\")",
    "glue_code": "    public void verifyReportSAST() throws CheckmarxException {\n        ScanResultsReport report = getLatestReport();\n        assertScanSASTSummary(report);\n        assertScanSASTResults(report);\n        Assert.assertEquals(\"Scan ID does not match !\", Integer.valueOf(SCAN_ID), Integer.valueOf(report.getScanId()));\n    }\n\n    @Then(\"we should see the expected number of tickets in analytics for SCA\")\n    public void verifyReportSCA() throws CheckmarxException {",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 280,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get/GetResultsAnalyticsTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get",
      "filename": "GetResultsAnalyticsTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 625,
    "annotation": "\n    @Then(\"we should see the expected number of tickets in analytics for SCA\")",
    "glue_code": "    @Then(\"we should see the expected number of tickets in analytics for SCA\")\n    public void verifyReportSCA() throws CheckmarxException {\n        ScanResultsReport report = getLatestReport();\n        assertScanSCASummary(report);\n        Assert.assertEquals(\"Scan ID does not match !\", Integer.valueOf(SCAN_ID), Integer.valueOf(report.getScanId()));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 287,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get/GetResultsAnalyticsTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/get",
      "filename": "GetResultsAnalyticsTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 636,
    "annotation": "\n    @Given(\"thresholds are configured as HIGH: {int}, MEDIUM: {int}, LOW: {int}\")",
    "glue_code": "    @Given(\"thresholds are configured as HIGH: {int}, MEDIUM: {int}, LOW: {int}\")\n    public void thresholdsAreConfiguredAs(int high, int medium, int low) {\n        Map<FindingSeverity, Integer> thresholds = toSeverityMap(high, medium, low);\n        flowProperties.setThresholds(thresholds);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 102,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 637,
    "annotation": "\n    @Given(\"SCA Scan in configured in application.yml\")",
    "glue_code": "    @Given(\"SCA Scan in configured in application.yml\")\n    public void scanScanIsconfigured(){}",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 108,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 638,
    "annotation": "\n    @And(\"filters are disabled\")",
    "glue_code": "    @And(\"filters are disabled\")\n    public void filtersAreDisabled() {\n        state.filter = FilterConfiguration.fromSimpleFilters(Collections.emptyList());\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 111,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 639,
    "annotation": "\n    @When(\"pull request is created for a repo with URL: {string} in GitHub\")",
    "glue_code": "    @When(\"pull request is created for a repo with URL: {string} in GitHub\")\n    public void pullRequestIsCreated(String repoUrl) {\n        state.scanRequest = createScanRequest(repoUrl);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 116,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 640,
    "annotation": "\n    @And(\"SAST returns scan ID: {int} and finding count per severity: HIGH: {int}, MEDIUM: {int}, LOW: {int}\")",
    "glue_code": "    @And(\"SAST returns scan ID: {int} and finding count per severity: HIGH: {int}, MEDIUM: {int}, LOW: {int}\")\n    public void sastReturnsScanID(int scanId, int high, int medium, int low) throws InterruptedException {\n        state.fakeScanId = scanId;\n        state.findingsPerSeverity = toSeverityMap(high, medium, low);\n        state.scanResultsToInject = createFakeSASTScanResults(state.findingsPerSeverity);\n        processScanResultsInCxFlow();\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 121,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 641,
    "annotation": "\n    @And(\"SCA returns scan ID: {int} and finding count per severity: HIGH: {int}, MEDIUM: {int}, LOW: {int}\")",
    "glue_code": "    @And(\"SCA returns scan ID: {int} and finding count per severity: HIGH: {int}, MEDIUM: {int}, LOW: {int}\")\n    public void scaReturnsScanID(int scanId, int high, int medium, int low) throws InterruptedException {\n        state.fakeScanId = scanId;\n        state.findingsPerSeverity = toSeverityMap(high, medium, low);\n        state.scanResultsToInject = createFakeSCAScanResults(state.findingsPerSeverity, scanId);\n        processScanResultsInCxFlow();\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 129,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 642,
    "annotation": "\n    @Then(\"in analytics report, the operation is {string}\")",
    "glue_code": "    @Then(\"in analytics report, the operation is {string}\")\n    public void inAnalyticsReportTheOperationIs(String operation) throws CheckmarxException {\n        state.lastAnalyticsReport = (PullRequestReport) loggerUtils.getReportNode(operation, PullRequestReport.class);\n\n        Assert.assertNotEquals(String.format(\"JSON node not found for the '%s' operation\", operation),\n                null,\n                state.lastAnalyticsReport);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 137,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 643,
    "annotation": "\n    @And(\"pullRequestStatus is {string}\")",
    "glue_code": "    @And(\"pullRequestStatus is {string}\")\n    public void pullrequeststatusIs(String expectedStatus) {\n        OperationResult result = state.lastAnalyticsReport.getPullRequestResult();\n        Assert.assertEquals(\"Unexpected pull request status.\", expectedStatus, result.getStatus().toString());\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 146,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 644,
    "annotation": "\n    @And(\"repoUrl contains encrypted {string}\")",
    "glue_code": "    @And(\"repoUrl contains encrypted {string}\")\n    public void repoUrlIsEncryptedRepoUrl(String expectedRepoUrl) throws IOException {\n        String encryptedRepoUrl = state.lastAnalyticsReport.getRepoUrl();\n        String decryptedRepoUrl = AesEncryptionUtils.decrypt(encryptedRepoUrl);\n        Assert.assertEquals(\"Incorrect encrypted repo URL.\", expectedRepoUrl, decryptedRepoUrl);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 152,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 645,
    "annotation": "\n    @And(\"scanInitiator is {string}, scanId is {string}\")",
    "glue_code": "    @And(\"scanInitiator is {string}, scanId is {string}\")\n    public void scanInitiatorIs(String initiator, String scanId) {\n        Assert.assertEquals(\"Unexpected initiator.\", initiator, state.lastAnalyticsReport.getScanInitiator());\n        Assert.assertEquals(\"Unexpected scan ID.\", scanId, state.lastAnalyticsReport.getScanId());\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 159,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 646,
    "annotation": "\n    @And(\"findingsMap is HIGH: {int}, MEDIUM: {int}, LOW: {int}\")",
    "glue_code": "    @And(\"findingsMap is HIGH: {int}, MEDIUM: {int}, LOW: {int}\")\n    public void findingsPerSeverity(int high, int medium, int low) {\n        Map<FindingSeverity, Integer> expectedMap = toSeverityMap(high, medium, low);\n        Map<FindingSeverity, Integer> actualMap = state.lastAnalyticsReport.getFindingsPerSeverity();\n        actualMap.remove(FindingSeverity.INFO);\n        Assert.assertEquals(\"Incorrect finding map\", expectedMap, actualMap);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 165,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 647,
    "annotation": "\n    @And(\"thresholds are HIGH: {int}, MEDIUM: {int}, LOW: {int}\")",
    "glue_code": "    @And(\"thresholds are HIGH: {int}, MEDIUM: {int}, LOW: {int}\")\n    public void thresholdsAre(int high, int medium, int low) {\n        Map<FindingSeverity, Integer> actualThresholds = state.lastAnalyticsReport.getThresholds();\n        Map<FindingSeverity, Integer> expectedThresholds = toSeverityMap(high, medium, low);\n        Assert.assertEquals(\"Incorrect thresholds\", expectedThresholds, actualThresholds);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 173,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest/AnalyticsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/analytics/pullrequest",
      "filename": "AnalyticsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 626,
    "annotation": "\n    @When(\"repository is {string} and scanner is {string}\")",
    "glue_code": "    @When(\"repository is {string} and scanner is {string}\")\n    public void setRepoAndScanner(String repo, String scannerType){\n\n        resultsService = initResultsService(repo);\n        this.scannerType = scannerType;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 342,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse/GitHubCommentsASTSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse",
      "filename": "GitHubCommentsASTSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 627,
    "annotation": "    @And(\"doing get results operation on scan with {int} {int} {int} {int} results\")",
    "glue_code": "    public void getASTResults(int high, int medium, int low, int info) throws InterruptedException {\n        try {\n            if(scannerType.equalsIgnoreCase(AST)) {\n                scanResultsToInject = createFakeASTScanResults(high, medium, low);\n                addFlowSummaryToResults(high, medium, low, info);\n            }\n            if(scannerType.equalsIgnoreCase(AST_SCA)) {\n                scanResultsToInject = createFakeSCAScanResults(high, medium, low);\n                ScanResults astScanResults = createFakeASTScanResults(high, medium, low);\n                scanResultsToInject.setAstResults(astScanResults.getAstResults());\n                addFlowSummaryToResults(high*2, medium*2, low*2, info*2);\n            }\n            \n            ScanRequest scanRequest = createScanRequest();\n\n            CompletableFuture<ScanResults> task = resultsService.processScanResultsAsync(\n                    scanRequest, PROJECT_ID, SCAN_ID, null, null);\n            task.get(1, TimeUnit.MINUTES);\n            \n        } catch (MachinaException | ExecutionException | TimeoutException e) {\n            String message = \"Error processing scan results.\";\n            log.error(message, e);\n            Assert.fail(message);\n        }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 349,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse/GitHubCommentsASTSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse",
      "filename": "GitHubCommentsASTSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 628,
    "annotation": "\n\n\n    @Then(\"we should see the expected number of results in comments\")",
    "glue_code": "\n\n    @Then(\"we should see the expected number of results in comments\")\n    public void verifyComments(){\n\n        int actaulHighCounter = StringUtils.countMatches(comment, \"HIGH\");\n        int actualMediumCounter = StringUtils.countMatches(comment, \"MEDIUM\");\n        int actaulLowCounter = StringUtils.countMatches(comment, \"LOW\");\n\n        \n        if (scannerType.equalsIgnoreCase(AST_SCA)) {\n            Assert.assertTrue(PullRequestCommentsHelper.isSastAndScaComment(comment) );\n\n            Assert.assertEquals(scanResultsToInject.getAstResults().getSummary().getHighVulnerabilityCount()+\n                    scanResultsToInject.getScaResults().getSummary().getFindingCounts().get(Filter.Severity.HIGH), actaulHighCounter);\n            Assert.assertEquals(scanResultsToInject.getAstResults().getSummary().getMediumVulnerabilityCount() +\n                    scanResultsToInject.getScaResults().getSummary().getFindingCounts().get(Filter.Severity.MEDIUM), actualMediumCounter);\n            \n            // add 1 to the results \n            Assert.assertEquals(scanResultsToInject.getAstResults().getSummary().getLowVulnerabilityCount()+ 1 +\n                    scanResultsToInject.getScaResults().getSummary().getFindingCounts().get(Filter.Severity.LOW), actaulLowCounter);\n\n        }\n        else if (scannerType.equalsIgnoreCase(AST)) {\n            \n            Assert.assertTrue(PullRequestCommentsHelper.isSastFindingsComment(comment));\n\n            int expectedHigh = getExpectedResults(scanResultsToInject.getAstResults().getSummary().getHighVulnerabilityCount());\n            int expectedMedium = getExpectedResults(scanResultsToInject.getAstResults().getSummary().getMediumVulnerabilityCount());\n            int expectedLow = getExpectedResults(scanResultsToInject.getAstResults().getSummary().getLowVulnerabilityCount());\n            \n            Assert.assertEquals(expectedHigh  , actaulHighCounter);\n            Assert.assertEquals(expectedMedium  , actualMediumCounter);\n            Assert.assertEquals(expectedLow , actaulLowCounter);\n    \n            if(!comment.contains(NO_POLICY_VIOLATION_MESSAGE)) {\n                Assert.assertTrue(comment.contains(AST_WEB_REPORT_LINK));\n            }\n        }\n\n        \n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 386,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse/GitHubCommentsASTSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/ast/parse",
      "filename": "GitHubCommentsASTSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 629,
    "annotation": "\n    @Given(\"SAST client is mocked - to allow tests to pass without active SAST environment\")",
    "glue_code": "    @Given(\"SAST client is mocked - to allow tests to pass without active SAST environment\")\n    public void sastClientIsMocked() throws CheckmarxException {\n        when(cxClient.getTeamId(anyString())).thenReturn(ScanFixture.TEAM_ID);\n        when(cxClient.getProjects(anyString())).thenReturn(ScanFixture.getProjects());\n\n        FilterConfiguration filter = FilterConfiguration.fromSimpleFilters(ScanFixture.getScanFilters());\n        when(cxClient.getReportContentByScanId(ScanFixture.SCAN_ID, filter))\n                .thenReturn(ScanFixture.getScanResults());\n\n        CxScannerService cxScannerService = new CxScannerService(cxProperties,null, null, null, null );\n        \n        cxFlowRunner = new CxFlowRunner(flowProperties,\n                        cxScannerService,\n                        jiraProperties,\n                        bitBucketProperties,\n                        gitHubProperties,\n                        gitLabProperties,\n                        iastService,\n                        adoProperties,\n                pdfProperties,\n                helperService,\n                executors,\n                resultsService,\n                osaScannerService,\n                filterFactory,\n                configOverrider,\n                buildProperties,\n                scanners, thresholdValidator);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 59,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/batch/BatchComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/batch",
      "filename": "BatchComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 630,
    "annotation": "\n    @Given(\"project is provided: {string} and team: {string}\")",
    "glue_code": "    @Given(\"project is provided: {string} and team: {string}\")\n    public void projectIsProvidedProjectNameAndTeamTeamName(String projectName, String teamName) {\n        this.projectName = projectName;\n        this.teamName = teamName;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 89,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/batch/BatchComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/batch",
      "filename": "BatchComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 631,
    "annotation": "\n    @When(\"scan project in batch mode\")",
    "glue_code": "    @When(\"scan project in batch mode\")\n    public void scanProjectInBatchMode() throws Exception {\n        TestUtils.runCxFlow(cxFlowRunner, \"--\" + CxFlowRunner.THROW_INSTEAD_OF_EXIT_OPTION +\n                \" --batch --project --cx-project=\" + this.projectName +\n                \" --cx-team=\" + this.teamName);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 95,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/batch/BatchComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/batch",
      "filename": "BatchComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 632,
    "annotation": "\n    @Then(\"Json file is created in path: {string}\")",
    "glue_code": "    @Then(\"Json file is created in path: {string}\")\n    public void jsonFileIsCreatedInPath(String path) {\n        boolean exists = Files.exists(Paths.get(path));\n        assertTrue(exists);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 102,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/batch/BatchComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/batch",
      "filename": "BatchComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 648,
    "annotation": "\n    @And(\"Scan request contains feature branch name {string}\")",
    "glue_code": "    @And(\"Scan request contains feature branch name {string}\")\n    public void setScanRequestBranch(String branchName){\n\n        this.branchName = branchName;\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 128,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript/CommentScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript",
      "filename": "CommentScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 649,
    "annotation": "\n\n    @When(\"CxFlow triggers SAST scan\")",
    "glue_code": "\n    @When(\"CxFlow triggers SAST scan\")\n    public void cxFlowTriggerScan() {\n        FlowController.CxScanRequest cxScanRequest = new FlowController.CxScanRequest();\n        cxScanRequest.setProduct(ScanRequest.Product.CX.toString());\n        cxScanRequest.setProject(MEANINGLESS_STRING);\n        cxScanRequest.setGitUrl(MEANINGLESS_STRING);\n\n        String branch = ScanUtils.empty(branchName) ? MEANINGLESS_STRING : branchName;\n        cxScanRequest.setBranch(branch);\n        flowProperties.setToken(WEBHOOK_TOKEN);\n\n        flowController.initiateScan(cxScanRequest, WEBHOOK_TOKEN);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 148,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript/CommentScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript",
      "filename": "CommentScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 650,
    "annotation": "\n    @Then(\"CxFlow scan comment is equal to {string}\")",
    "glue_code": "    @Then(\"CxFlow scan comment is equal to {string}\")\n    public void compareComments(String expectedComment){\n        assertEquals(expectedComment, commentMessageFromRequest,\n                \"fail comparing expected comment to actual comment in scan request\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 163,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript/CommentScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/commentscript",
      "filename": "CommentScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 633,
    "annotation": "\n    @Given(\"Sast results having the following findings: {}\")",
    "glue_code": "    @Given(\"Sast results having the following findings: {}\")\n    public void setSastScanResults(String description) {\n        if (sastFilenamesByDescription.get(description) == null) {\n            throw new PendingException(\"Cannot find scan result file for description: \" + description);\n        }\n        scanResults.setXIssues(sastFilenamesByDescription.get(description));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 70,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker/CsvIssueTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker",
      "filename": "CsvIssueTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 634,
    "annotation": "\n    @When(\"publish findings using Csv issue tracker\")",
    "glue_code": "    @When(\"publish findings using Csv issue tracker\")\n    public void publishFindingsUsingCsvIssueTracker() throws MachinaException {\n        setScanRequestWithCsvBugTracker();\n        properties.setFileNameFormat(\"[TEAM]-[PROJECT]-123.csv\");\n        properties.setDataFolder(workDir);\n        flowProperties.setMitreUrl(\"url\");\n        issueService.setApplicationContext(applicationContext);\n        issueService.process(scanResults, scanRequest);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 78,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker/CsvIssueTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker",
      "filename": "CsvIssueTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 635,
    "annotation": "\n    @Then(\"Csv result generated with {} issue\\\\(s)\")",
    "glue_code": "    @Then(\"Csv result generated with {} issue\\\\(s)\")\n    public void checkCsvResult(long numberOfIssues) throws IOException {\n        Path reportAbsolutePath = Paths.get(workDir, String.format(\"%s-%s-123.csv\", team, project));\n        long lines = Files.lines(reportAbsolutePath).count() - 1;\n        assertThat(lines, equalTo(numberOfIssues));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 88,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker/CsvIssueTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/csvissuetracker",
      "filename": "CsvIssueTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 651,
    "annotation": "\n    @Given(\"read-multi-tenant-configuration flag is set to true\")",
    "glue_code": "    @Given(\"read-multi-tenant-configuration flag is set to true\")\n    public void setMultiTenantConf() {\n        cxIntegrationsProperties.setReadMultiTenantConfiguration(true);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 43,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations/CxIntegrationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations",
      "filename": "CxIntegrationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 652,
    "annotation": "\n    @When(\"cx-flow getting a new event\")",
    "glue_code": "    @When(\"cx-flow getting a new event\")\n    public void simulateNewRequestEvent() {\n        scanRequest = configOverrider.overrideScanRequestProperties(new CxConfig(), this.scanRequest);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 48,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations/CxIntegrationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations",
      "filename": "CxIntegrationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 653,
    "annotation": "\n    @Then(\"scanRequest is getting populated with cx-go new configuration\")",
    "glue_code": "    @Then(\"scanRequest is getting populated with cx-go new configuration\")\n    public void validateCxGoConfigurationOverride() {\n        Assert.assertEquals(CLIENT_SECRET, scanRequest.getScannerApiSec());\n        Assert.assertEquals(TEAM, scanRequest.getTeam());\n        Assert.assertTrue(scanRequest.getRepoUrlWithAuth().contains(SCM_ACCESS_TOKEN));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 53,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations/CxIntegrationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/cxintegrations",
      "filename": "CxIntegrationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 654,
    "annotation": "\n    @Given(\"Azure repo name is {string}\")",
    "glue_code": "    @Given(\"Azure repo name is {string}\")\n    public void setAdoRepoName(String repo){\n        adoRepo = repo;\n        initAdoProperties();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 172,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 655,
    "annotation": "\n    @And(\"Azure branch is {}\")",
    "glue_code": "    @And(\"Azure branch is {}\")\n    public void setAdoBranch(String branch){\n\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 178,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 656,
    "annotation": "\n    @Given(\"GitHub repo name is {string}\")",
    "glue_code": "    @Given(\"GitHub repo name is {string}\")\n    public void setGithubRepoName(String repoName){\n        this.repoName = repoName;\n        initGitHubProperties();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 183,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 657,
    "annotation": "\n    @And(\"no exception will be thrown\")",
    "glue_code": "    @And(\"no exception will be thrown\")\n    public void validateNoException() {\n        // If we have arrived here, no exception was thrown.\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 189,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 658,
    "annotation": "    \n    @And(\"GitHub trigger is {string}\")",
    "glue_code": "    @And(\"GitHub trigger is {string}\")\n    public void setTrigger(String trigger){\n        this.trigger = trigger;\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 194,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 659,
    "annotation": "    \n    @And(\"GitHub branch is {string}\")",
    "glue_code": "    @And(\"GitHub branch is {string}\")\n    public void setGithubBranch(String branch) {\n        this.githubBranch = branch;\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 199,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 660,
    "annotation": "    \n    @And(\"a project {string} {string} in SAST\")",
    "glue_code": "    @And(\"a project {string} {string} in SAST\")\n    public void setProjectId(String projectName, String exists){\n        int projectId;\n        if (exists.equals(\"exists\") || Boolean.parseBoolean(exists)) {\n            projectId = EXISTING_PROJECT_ID;\n        }else{\n            projectId = Constants.UNKNOWN_INT;\n        }\n        when(cxClientMock.getProjectId(anyString(), any())).thenReturn(projectId);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 204,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 661,
    "annotation": "    \n    @And(\"the {string} branch is {} as determined by application.yml\")",
    "glue_code": "    @And(\"the {string} branch is {} as determined by application.yml\")\n    public void theBranchIsSpecifiedAsProtected(String branch, String protectedOrNot) {\n        List<String> protectedBranches = flowProperties.getBranches();\n        if (Boolean.parseBoolean(protectedOrNot)) {\n            protectedBranches.add(branch);\n        } else {\n            protectedBranches.remove(branch);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 215,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 662,
    "annotation": "\n    @And(\"the Azure properties is {} by application.yml\")",
    "glue_code": "    @And(\"the Azure properties is {} by application.yml\")\n    public void theBranchIsSpecifiedAsProtected(boolean deleteBranch) {\n        adoProperties.setDeleteCxProject(deleteBranch);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 225,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 663,
    "annotation": "\n    @And(\"config-as-code in azure default branch include Cx-project {}\")",
    "glue_code": "    @And(\"config-as-code in azure default branch include Cx-project {}\")\n    public void setAzureConfigAsCodeProject(String cxProject) {\n        if (!cxProject.equals(\"none\")){\n            cxConfig.setProject(cxProject);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 230,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 664,
    "annotation": "\n    @When(\"GitHub notifies cxFlow that a {string} branch/ref was deleted\")",
    "glue_code": "    @When(\"GitHub notifies cxFlow that a {string} branch/ref was deleted\")\n    public void githubNotifiesCxFlowThatABranchWasDeleted(String deletedBranch) {\n        githubBranch = deletedBranch;\n        sendGithubDeleteEvent();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 237,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 665,
    "annotation": "\n    @When(\"Azure notifies cxFlow that a {string} branch was deleted\")",
    "glue_code": "    @When(\"Azure notifies cxFlow that a {string} branch was deleted\")\n    public void azureNotifiesCxFlowThatABranchWasDeleted(String deletedBranch) {\n        sendAzureDeleteEvent(deletedBranch);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 243,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 666,
    "annotation": "\n\n    @Then(\"CxFlow will {} the SAST delete API for the {string} project\")",
    "glue_code": "\n    @Then(\"CxFlow will {} the SAST delete API for the {string} project\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 248,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch/DeleteBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/deletebranch",
      "filename": "DeleteBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 676,
    "annotation": "\n\n    @Given(\"SAST report containing 3 findings, each in a different file and with a different vulnerability type\")",
    "glue_code": "\n    @Given(\"SAST report containing 3 findings, each in a different file and with a different vulnerability type\")\n    public void inputContainingFindings() {\n        sastReportPath = Paths.get(Constants.SAMPLE_SAST_RESULTS_DIR, SAST_REPORT_FILENAME).toString();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 62,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 677,
    "annotation": "\n    @And(\"finding #{int} has {string} severity, {string} status and {string} state\")",
    "glue_code": "    @And(\"finding #{int} has {string} severity, {string} status and {string} state\")\n    public void findingHasSeverityStatusAndState(int findingNumber, String severity, String status, String state)\n            throws IOException, ParserConfigurationException, SAXException {\n\n        NodeList findings = getXmlFindingsFromResource(sastReportPath);\n        findingFilenameToNumber = mapFilenamesToNumbers(findings);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 68,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 678,
    "annotation": "\n    @And(\"no simple filters are defined\")",
    "glue_code": "    @And(\"no simple filters are defined\")\n    public void noSimpleFilters() {\n        flowProperties.setFilterSeverity(null);\n        flowProperties.setFilterCwe(null);\n        flowProperties.setFilterCategory(null);\n        flowProperties.setFilterStatus(null);\n        flowProperties.setFilterState(null);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 82,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 679,
    "annotation": "\n    @And(\"filter script is {string}\")",
    "glue_code": "    @And(\"filter script is {string}\")\n    public void filterScriptId(String scriptText) {\n        if (scriptText.equals(\"<not specified>\")) {\n            scriptText = null;\n        }\n        log.info(\"Using filter script: '{}'\", scriptText);\n        flowProperties.setFilterScript(scriptText);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 91,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 680,
    "annotation": "\n    @When(\"CxFlow generates issues from findings\")",
    "glue_code": "    @When(\"CxFlow generates issues from findings\")\n    public void cxFlowGeneratesIssues() throws CheckmarxException, IOException {\n        RestTemplate restTemplateMock = getRestTemplateMock();\n        CxAuthService authClientMock = getAuthClientMock();\n        CxClient cxClientSpy = getCxClientSpy(restTemplateMock, authClientMock);\n        generateIssues(cxClientSpy);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 100,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 681,
    "annotation": "\n    @Then(\"CxFlow report is generated with issues corresponding to these findings: {string}\")",
    "glue_code": "    @Then(\"CxFlow report is generated with issues corresponding to these findings: {string}\")\n    public void cxflowReportIsGenerated(String issueDescription) {\n        if (reportGenerationException != null) {\n            fail(\"Unexpected exception while getting CxFlow report.\", reportGenerationException);\n        }\n\n        if (issueDescription.equals(\"<none>\")) {\n            assertTrue(findingNumbersAfterFiltering.isEmpty());\n        } else {\n            Set<Integer> expectedFindingNumbers = TestsParseUtils.parseCsvToList(issueDescription)\n                    .stream()\n                    .map(Integer::parseInt)\n                    .collect(Collectors.toSet());\n            assertEquals(expectedFindingNumbers, findingNumbersAfterFiltering);\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 108,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 682,
    "annotation": "\n    @Given(\"status filter is set to {string}\")",
    "glue_code": "    @Given(\"status filter is set to {string}\")\n    public void statusFilterIsSetTo(String status) {\n        flowProperties.setFilterStatus(Collections.singletonList(status));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 125,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 683,
    "annotation": "\n    @Then(\"CheckmarxRuntimeException is thrown\")",
    "glue_code": "    @Then(\"CheckmarxRuntimeException is thrown\")\n    public void checkmarxruntimeexceptionIsThrown() {\n        assertNotNull(reportGenerationException, \"Expected an exception, but didn't get any.\");\n\n        assertTrue(reportGenerationException instanceof CheckmarxRuntimeException,\n                () -> String.format(\"Expected CheckmarxRuntimeException to be thrown, but the actual exception was %s.\",\n                        reportGenerationException.getClass().getName()));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 130,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 684,
    "annotation": "\n    @And(\"the exception message contains the text: {string}\")",
    "glue_code": "    @And(\"the exception message contains the text: {string}\")\n    public void theExceptionMessageContainsTheText(String text) {\n        boolean messageContainsExpectedText = reportGenerationException.getMessage()\n                .toLowerCase(Locale.ROOT)\n                .contains(text.toLowerCase(Locale.ROOT));\n\n        assertTrue(messageContainsExpectedText,\n                String.format(\"Expected the exception message to contain '%s', but the actual message was '%s'.\",\n                        text,\n                        reportGenerationException.getMessage()));\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 139,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript/FilterScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/filterscript",
      "filename": "FilterScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 667,
    "annotation": "\n    @Given(\"input with no findings\")",
    "glue_code": "    @Given(\"input with no findings\")\n    public void setEmptySastScanResults() {\n        testContext.setInputFilename(\"empty-results.xml\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 46,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 668,
    "annotation": "\n    @Given(\"input having the following findings: {string}\")",
    "glue_code": "    @Given(\"input having the following findings: {string}\")\n    public void setSastScanResults(String description) {\n        String sastResultFilename = sastFilenamesByDescription.get(description);\n        if (sastResultFilename == null) {\n            throw new PendingException(\"Cannot find scan result file for description: \" + description);\n        }\n        testContext.setInputFilename(sastResultFilename);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 51,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 669,
    "annotation": "\n    @Given(\"input containing 3 findings with different severities: Medium, High, Critical\")",
    "glue_code": "    @Given(\"input containing 3 findings with different severities: Medium, High, Critical\")\n    public void sastScanResultsContainingFindingsWithDifferentSeverities() {\n        testContext.setInputFilename(\"3-findings-different-severity-medium-high-critical.xml\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 60,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 670,
    "annotation": "\n    @Given(\"input has {int} findings with {string} severity\")",
    "glue_code": "    @Given(\"input has {int} findings with {string} severity\")\n    public void inputHasFindingsWithSeverity(int findingCount, String severity) {\n        String fragment = String.format(\"%d-%s-\", findingCount,\n                severity.toLowerCase(Locale.ROOT));\n\n        testContext.appendToInputFilename(fragment);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 65,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 671,
    "annotation": "\n    @And(\"each finding has a unique combination of vulnerability type + filename\")",
    "glue_code": "    @And(\"each finding has a unique combination of vulnerability type + filename\")\n    public void eachFindingHasAUniqueCombination() {\n        // Assuming this is the last part of the filename.\n        String postfix = String.format(\"unique.%s\", TestContext.SAST_RESULT_EXTENSION);\n        testContext.appendToInputFilename(postfix);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 73,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 672,
    "annotation": "\n    @Given(\"input with {} finding\\\\(s)\")",
    "glue_code": "    @Given(\"input with {} finding\\\\(s)\")\n    public void inputWithANumberOfFindings(int findingCount) {\n        String beginning = String.format(\"%d-finding%s\", findingCount, findingCount > 1 ? \"s\" : \"\");\n        testContext.appendToInputFilename(beginning);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 80,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 673,
    "annotation": "\n    @And(\"the execution path of each finding contains {int} nodes\")",
    "glue_code": "    @And(\"the execution path of each finding contains {int} nodes\")\n    public void theExecutionPathOfEachFindingContainsNodes(int nodeCount) {\n        String fragment = String.format(\"-%d-nodes\", nodeCount);\n        testContext.appendToInputFilename(fragment);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 86,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 674,
    "annotation": "\n    @And(\"each of the findings has a different filename\")",
    "glue_code": "    @And(\"each of the findings has a different filename\")\n    public void eachOfTheFindingsHasADifferentFilename() {\n        // For 1 finding, the \"different filename\" statement is obviously always true,\n        // but we still use this statement here for consistency.\n        String ending = String.format(\"-different-files.%s\", TestContext.SAST_RESULT_EXTENSION);\n        testContext.appendToInputFilename(ending);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 92,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 675,
    "annotation": "\n    @Given(\"reference CxFlow reports are available for specific inputs\")",
    "glue_code": "    @Given(\"reference CxFlow reports are available for specific inputs\")\n    public void referenceCxFlowReportsAreAvailable() throws IOException, URISyntaxException {\n        List<String> baseFilenames = getSastResultsHavingReferenceReports();\n        Assert.assertFalse(\"No matching reference reports found, nothing to test.\", baseFilenames.isEmpty());\n        testContext.setBaseFilenames(baseFilenames);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 100,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/LoadingSastResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "LoadingSastResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 685,
    "annotation": "\n    @When(\"parsing the input\")",
    "glue_code": "    @When(\"parsing the input\")\n    public void runParse() throws IOException {\n        runCxFlow(testContext.getInputFilename(), null, null);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 32,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/RunningCxFlowSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "RunningCxFlowSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 686,
    "annotation": "\n    @When(\"parsing the input with severity filter: {}\")",
    "glue_code": "    @When(\"parsing the input with severity filter: {}\")\n    public void parsingTheResultsWithSeverityFilter(String severities)\n            throws IOException {\n\n        String filterArgs = getCommandLineFilterArgs(severities);\n        runCxFlow(testContext.getInputFilename(), null, filterArgs);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 37,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/RunningCxFlowSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "RunningCxFlowSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 687,
    "annotation": "\n    @When(\"parsing each of these inputs\")",
    "glue_code": "    @When(\"parsing each of these inputs\")\n    public void parsingEachOfTheseResults() throws IOException {\n        for (String baseFilename : testContext.getBaseFilenames()) {\n            String inputFilename = String.format(\"%s.%s\", baseFilename, TestContext.SAST_RESULT_EXTENSION);\n            String outputFilename = String.format(\"%s.%s\", baseFilename, TestContext.CXFLOW_REPORT_EXTENSION);\n            runCxFlow(inputFilename, outputFilename, null);\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 45,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/RunningCxFlowSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "RunningCxFlowSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 688,
    "annotation": "\n    @When(\"running CxFlow with command line: {string}\")",
    "glue_code": "    @When(\"running CxFlow with command line: {string}\")\n    public void runningCxFlowWithCommandLine(String commandLine) {\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), commandLine);\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 54,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/RunningCxFlowSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "RunningCxFlowSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 689,
    "annotation": "\n    @Then(\"CxFlow exits with exit code {}\")",
    "glue_code": "    @Then(\"CxFlow exits with exit code {}\")\n    public void cxflowExitsWithStatusCodeStatusCode(int expectedExitCode) {\n        Throwable exception = testContext.getCxFlowExecutionException();\n\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", exception);\n        Assert.assertEquals(InvocationTargetException.class, exception.getClass());\n\n        Throwable targetException = ((InvocationTargetException) exception).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n        Assert.assertEquals(expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 65,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/RunningCxFlowSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "RunningCxFlowSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 690,
    "annotation": "\n    @Then(\"the generated CxFlow report contains no issues and the summary is empty\")",
    "glue_code": "    @Then(\"the generated CxFlow report contains no issues and the summary is empty\")\n    public void verifyReportContainsNoIssuesAndEmptySummary() throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        JsonNode issues = report.getIssues();\n        assertEquals(\"issues array must be empty\", 0, issues.size());\n\n        verifySummaryFieldCount(report.getSummary(), 0);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 28,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 691,
    "annotation": "\n    @Then(\"CxFlow report is generated with {} issue(s)\")",
    "glue_code": "    @Then(\"CxFlow report is generated with {} issue(s)\")\n    public void reportIsGeneratedWithNIssues(int expectedIssueCount) throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        JsonNode issues = report.getIssues();\n        assertEquals(\"Unexpected issue count in CxFlow response.\", expectedIssueCount, issues.size());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 37,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 692,
    "annotation": "\n    @And(\"each issue contains {} results and the same number of details\")",
    "glue_code": "    @And(\"each issue contains {} results and the same number of details\")\n    public void eachIssueContainsNumberOfDetails(int expectedResultCount) throws IOException {\n        verifyCxFlowResultCount(expectedResultCount, true);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 44,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 693,
    "annotation": "\n    @And(\"each issue contains {int} result\")",
    "glue_code": "    @And(\"each issue contains {int} result\")\n    public void eachIssueContainsResult(int expectedResultCount) throws IOException {\n        verifyCxFlowResultCount(expectedResultCount, false);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 49,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 694,
    "annotation": "\n    @Then(\"CxFlow report summary contains {} severities\")",
    "glue_code": "    @Then(\"CxFlow report summary contains {} severities\")\n    public void summaryContainsNumberOfSeverities(int expectedSeverityCount) throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        verifySummaryFieldCount(report.getSummary(), expectedSeverityCount);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 54,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 695,
    "annotation": "\n    @And(\"{string} object in each CxFlow result corresponds to the {string} execution path node in input\")",
    "glue_code": "    @And(\"{string} object in each CxFlow result corresponds to the {string} execution path node in input\")\n    public void objectInTheResultCorrespondsToExecutionPathNode(String jsonFieldName, String firstOrLast)\n            throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        Map<String, JsonNode> cxFlowResultMap = report.getResultMapByFilename();\n\n        SastResultParser parser = new SastResultParser();\n        Map<String, Element> sastPathMap = parser.getPathMapByFilename(testContext.getInputFilename());\n\n        for (Map.Entry<String, JsonNode> cxFlowResult : cxFlowResultMap.entrySet()) {\n            String filename = cxFlowResult.getKey();\n            Element sastPath = sastPathMap.get(filename);\n            verifyPathNodeMatch(cxFlowResult.getValue(), sastPath, jsonFieldName, firstOrLast);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 60,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 696,
    "annotation": "\n    @And(\"^(?:the issue severity is|issue severities are:) (.+)$\")",
    "glue_code": "    @And(\"^(?:the issue severity is|issue severities are:) (.+)$\")\n    public void issueSeveritiesAre(String severities) throws IOException {\n        String[] expectedSeverities = TestsParseUtils.parseCSV(severities).toArray(String[]::new);\n\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        String[] actualSeverities = report.getSeverities();\n\n        Arrays.sort(expectedSeverities);\n        Arrays.sort(actualSeverities);\n        assertArrayEquals(expectedSeverities, actualSeverities);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 76,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 697,
    "annotation": "\n    @Then(\"the generated CxFlow report matches a corresponding reference report\")",
    "glue_code": "    @Then(\"the generated CxFlow report matches a corresponding reference report\")\n    public void generatedCxFlowReportMatchesReferenceReport() throws IOException {\n        CxFlowReportComparer comparer = new CxFlowReportComparer(testContext);\n        List<String> baseFilenames = testContext.getBaseFilenames();\n        ComparisonResult comparisonResult = comparer.compareActualReportsToReferenceReports(baseFilenames);\n        if (comparisonResult.containsMismatches()) {\n            fail(\"Mismatches detected: \" + comparisonResult.toString());\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 88,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 698,
    "annotation": "\n    @Then(\"CxFlow report summary contains a {string} field with the value {int}\")",
    "glue_code": "    @Then(\"CxFlow report summary contains a {string} field with the value {int}\")\n    public void cxflowReportSummaryContainsAFieldWithTheValue(String fieldName, int expectedCount) throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        Integer actualCount = report.getSeverityCounterFromSummary(fieldName);\n\n        assertNotNull(actualCount);\n        assertEquals(expectedCount, actualCount.intValue());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 98,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 699,
    "annotation": "\n    @And(\"CxFlow report summary contains only these {int} fields\")",
    "glue_code": "    @And(\"CxFlow report summary contains only these {int} fields\")\n    public void cxflowReportSummaryContainsOnlyTheseFields(int expectedFieldCount) throws IOException {\n        CxFlowReport report = CxFlowReport.parse(testContext);\n        int actualFieldCount = report.getSummary().size();\n        assertEquals(expectedFieldCount, actualFieldCount);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 107,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/parse/VerifyingCxFlowReportSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/parse",
      "filename": "VerifyingCxFlowReportSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 700,
    "annotation": "\n    @When(\"Determine JIRA project key\")",
    "glue_code": "    @When(\"Determine JIRA project key\")\n    public void determineJIRAProjectKey() {\n        String jiraProjectKey = jiraService.determineJiraProjectKey(request);\n        request.getBugTracker().setProjectKey(jiraProjectKey);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 80,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript/JiraProjectKeyScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript",
      "filename": "JiraProjectKeyScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 701,
    "annotation": "\n    @Then(\"JIRA project key is equal to {string}\")",
    "glue_code": "    @Then(\"JIRA project key is equal to {string}\")\n    public void jiraProjectKeyIsEqualTo(String expectedProjectKey) {\n        log.info(\"Comparing expected project key '{}' to actual project key '{}'\",\n                 expectedProjectKey,\n                 request.getBugTracker().getProjectKey());\n\n        assertEquals(expectedProjectKey,  request.getBugTracker().getProjectKey(), \"fail comparing expected JIRA\" +\n                \" project key to actual project key in scan request\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 86,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript/JiraProjectKeyScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript",
      "filename": "JiraProjectKeyScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 702,
    "annotation": "\n    @When(\"Scan request contain feature repo name {string}\")",
    "glue_code": "    @When(\"Scan request contain feature repo name {string}\")\n    public void scanRequestContainFeatureRepoName(String repoName) {\n        request.setRepoName(repoName);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 96,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript/JiraProjectKeyScriptSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectkeyscript",
      "filename": "JiraProjectKeyScriptSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 703,
    "annotation": "\r\n    @Given(\"preserve-project-name is {} and multi-tenant is true\")\r",
    "glue_code": "    @Given(\"preserve-project-name is {} and multi-tenant is true\")\n    public void setPresrveProjectName(boolean presrveProjectName) {\n        flowProperties.setPreserveProjectName(presrveProjectName);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 35,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectname/ProjectNameSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectname",
      "filename": "ProjectNameSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 704,
    "annotation": "\r\n    @When(\"scan request arrives with repo-name {} and branch is {string}\")\r",
    "glue_code": "    @When(\"scan request arrives with repo-name {} and branch is {string}\")\n    public void setRepoName(String repoName, String branch) {\n        scanRequest.setRepoName(repoName);\n        scanRequest.setBranch(branch);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 40,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectname/ProjectNameSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectname",
      "filename": "ProjectNameSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 705,
    "annotation": "\r\n    @Then(\"project name used by scanner is {}\")\r",
    "glue_code": "    @Then(\"project name used by scanner is {}\")\n    public void checkProjectNameGenerationResult(String projectNameResult) {\n        String projectName = projectNameGenerator.determineProjectName(scanRequest);\n        assertThat(projectName, equalTo(projectNameResult));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 46,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectname/ProjectNameSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectname",
      "filename": "ProjectNameSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 706,
    "annotation": "\r\n    @Given(\"multi-tenant is {}\")\r",
    "glue_code": "    @Given(\"multi-tenant is {}\")\n    public void isMultiTenant(boolean isMultiTenant) {\n        cxScannerService.getProperties().setMultiTenant(isMultiTenant);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 52,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectname/ProjectNameSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectname",
      "filename": "ProjectNameSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 707,
    "annotation": "\r\n    @When(\"scan request arrives with namespace {}, repo-name {}, branch {} and application {}\")\r",
    "glue_code": "    @When(\"scan request arrives with namespace {}, repo-name {}, branch {} and application {}\")\n    public void scanRequestArrivesWithNamespaceRepoNameBranchAndApplication(String namespace, String repoName, String branch, String application) {\n        scanRequest.setNamespace(namespace);\n        scanRequest.setRepoName(repoName);\n        scanRequest.setBranch(branch);\n        scanRequest.setApplication(application);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 57,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/projectname/ProjectNameSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/projectname",
      "filename": "ProjectNameSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 708,
    "annotation": "\n    @Given(\"there is a SAST environment configured and running\")",
    "glue_code": "    @Given(\"there is a SAST environment configured and running\")\n    public void there_is_a_SAST_environment_configured_and_running() {\n        // Write code here that turns the phrase above into concrete actions\n        throw new PendingException();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 13,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/scan/ScansComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/scan",
      "filename": "ScansComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 709,
    "annotation": "\n    @When(\"running a scan with source name as {string} and output format as {string}\")",
    "glue_code": "    @When(\"running a scan with source name as {string} and output format as {string}\")\n    public void running_a_scan_with_source_name_as_and_output_format_as(String string, String string2) {\n        // Write code here that turns the phrase above into concrete actions\n        throw new PendingException();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 19,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/scan/ScansComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/scan",
      "filename": "ScansComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 710,
    "annotation": "\n    @When(\"running {int} scans in parallel, each with different expected output\")",
    "glue_code": "    @When(\"running {int} scans in parallel, each with different expected output\")\n    public void running_scans_in_parallel_each_with_different_expected_output(Integer int1) {\n        // Write code here that turns the phrase above into concrete actions\n        throw new PendingException();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 31,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/scan/ScansComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/scan",
      "filename": "ScansComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 711,
    "annotation": "\n    @Then(\"{int} output files are getting created on the output data folder after the scan is completed\")",
    "glue_code": "    @Then(\"{int} output files are getting created on the output data folder after the scan is completed\")\n    public void output_files_are_getting_created_on_the_output_data_folder_after_the_scan_is_completed(Integer int1) {\n        // Write code here that turns the phrase above into concrete actions\n        throw new PendingException();\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 37,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/scan/ScansComponentSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/scan",
      "filename": "ScansComponentSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 712,
    "annotation": "\n    @Given(\"thresholds section {} in cxflow configuration\")",
    "glue_code": "    @Given(\"thresholds section {} in cxflow configuration\")\n    public void setThresholdsSectionExist(boolean thresholdsExist) {\n        thresholdsSectionExist = thresholdsExist;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 135,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 713,
    "annotation": "\n    @And(\"thresholds {} by scan findings\")",
    "glue_code": "    @And(\"thresholds {} by scan findings\")\n    public void setThresholds(boolean thresholdsExceeded) {\n        if (thresholdsSectionExist){\n            if (thresholdsExceeded) {\n                thresholdForFindingsOfSeverityIs(DEFAULT_SEVERITY_HIGH, String.valueOf(DEFAULT_FINDINGS_COUNT - 1));\n            } else {\n                thresholdForFindingsOfSeverityIs(DEFAULT_SEVERITY_HIGH, String.valueOf(DEFAULT_FINDINGS_COUNT + 1));\n            }\n        }\n        else{ resetThresholds(); }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 140,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 714,
    "annotation": "\n    @Given(\"threshold for findings of {string} severity is {string}\")",
    "glue_code": "    @Given(\"threshold for findings of {string} severity is {string}\")\n    public void thresholdForFindingsOfSeverityIs(String severityName, String threshold) {\n        if (!threshold.equals(\"<omitted>\")) {\n            FindingSeverity severity = parseFindingSeverity(severityName);\n            int numericThreshold = Integer.parseInt(threshold);\n            flowProperties.getThresholds().put(severity, numericThreshold);\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 152,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 715,
    "annotation": "\n    @When(\"cxflow called with scan cli command\")",
    "glue_code": "    @When(\"cxflow called with scan cli command\")\n    public void runCxFlowFromCommandLine() {\n\n        flowProperties.setBugTracker(BugTracker.Type.NONE.toString());\n\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), CLI_COMMAND);\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 168,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 716,
    "annotation": "\n    @Then(\"cxflow should exit with the correct {}\")",
    "glue_code": "    @Then(\"cxflow should exit with the correct {}\")\n    public void validateExitCode(int expectedExitCode) {\n        Throwable exception = testContext.getCxFlowExecutionException();\n\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", exception);\n        Assert.assertEquals(InvocationTargetException.class, exception.getClass());\n\n        Throwable targetException = ((InvocationTargetException) exception).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n\n        Assert.assertEquals(\"The expected exist code did not match\",\n                expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 182,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 717,
    "annotation": "\n    @And(\"severity filter is set to {string}\")",
    "glue_code": "    @And(\"severity filter is set to {string}\")\n    public void severityFilterIsSetTo(String severity) {\n        filter = new Filter(Filter.Type.SEVERITY, severity);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 198,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 718,
    "annotation": "\n    @And(\"scan findings are {} after filter\")",
    "glue_code": "    @And(\"scan findings are {} after filter\")\n    public void severityFilterIsSetTo(boolean findingsPresentedAfterFilter) {\n        if (findingsPresentedAfterFilter){\n            addFindingsTo(scanResultsToInject, DEFAULT_FINDINGS_COUNT, DEFAULT_SEVERITY_HIGH);\n        }else{\n            scanResultsToInject = createFakeScanResults();\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 203,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 719,
    "annotation": "\n    @And(\"break-build property is set to {}\")",
    "glue_code": "    @And(\"break-build property is set to {}\")\n    public void setBreakBuildProperty(boolean breakBuild){\n        flowProperties.setBreakBuild(breakBuild);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 212,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 720,
    "annotation": "\n    @And(\"no severity filter is specified\")",
    "glue_code": "    @And(\"no severity filter is specified\")\n    public void noSeverityFilterIsSpecified() {\n        filter = null;\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 217,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 721,
    "annotation": "\n    @And(\"^(?:SAST detects )?(.*) findings of \\\"(.+)\\\" severity$\")",
    "glue_code": "    @And(\"^(?:SAST detects )?(.*) findings of \\\"(.+)\\\" severity$\")\n    public void sastDetectsFindings(int expectedFindingCount, String severity) {\n        addFindingsTo(scanResultsToInject, expectedFindingCount, severity);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 222,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 722,
    "annotation": "\n    @Then(\"CxFlow {string} the pull request on GitHub\")",
    "glue_code": "    @Then(\"CxFlow {string} the pull request on GitHub\")\n    public void cxflowApprovesOrFailsGithubPullRequest(String approvesOrFails) {\n        processScanResultsInCxFlow(true);\n\n        boolean expectingApproval = approvesOrFails.equals(\"approves\");\n        verifyPullRequestState(expectingApproval);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 235,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 723,
    "annotation": "\n    @And (\"blockMerge is {string} and errorMerge is {string}\")",
    "glue_code": "    @And (\"blockMerge is {string} and errorMerge is {string}\")\n    public void setFlags(String blockMergeStr, String errorMergeStr) {\n        boolean blockMerge  = Boolean.parseBoolean(blockMergeStr);\n        boolean errorMerge  = Boolean.parseBoolean(errorMergeStr);\n        \n        if(!(blockMerge && errorMerge)){\n            pullRequestWasApproved = true;             \n        }\n        this.adoProperties.setBlockMerge(blockMerge);\n        this.adoProperties.setErrorMerge(errorMerge);\n        this.gitHubProperties.setBlockMerge(blockMerge);\n        this.gitHubProperties.setErrorMerge(errorMerge);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 243,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 724,
    "annotation": "\n    @Then(\"CxFlow {string} the pull request on Azure\")",
    "glue_code": "    @Then(\"CxFlow {string} the pull request on Azure\")\n    public void cxflowApprovesOrFailsAzurePullRequest(String approvesOrFails) {\n        processScanResultsInCxFlow(false);\n\n        boolean expectingApproval = approvesOrFails.equals(\"approves\");\n        verifyPullRequestState(expectingApproval);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 257,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR/ThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/sastPR",
      "filename": "ThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 725,
    "annotation": "\n    @Given(\"the following thresholds-severities:\")",
    "glue_code": "    @Given(\"the following thresholds-severities:\")\n    public void the_following_thresholds_severities(List<Map<String, String>> thresholds) {\n        log.info(\"found {} threshold-severities definitions\", thresholds.size());\n        if (log.isDebugEnabled()) {\n            thresholds.forEach(threshold ->\n                    log.debug(\"{} --> high: {}, medium: {}, low: {}\",\n                            threshold.get(ThresholdFeatureKeys.THRESHOLD_NAME.toKey()),\n                            threshold.get(ThresholdFeatureKeys.THRESHOLD_FOR_HIGH.toKey()),\n                            threshold.get(ThresholdFeatureKeys.THRESHOLD_FOR_MEDIUM.toKey()),\n                            threshold.get(ThresholdFeatureKeys.THRESHOLD_FOR_LOW.toKey())));\n        }\n        thresholdDefs = thresholds;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 98,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 726,
    "annotation": "\n    @Given(\"the following scan findings:\")",
    "glue_code": "    @Given(\"the following scan findings:\")\n    public void the_following_scan_findings(List<Map<String, String>> findings) {\n        log.info(\"found {} findings definitions\", findings.size());\n        if (log.isDebugEnabled()) {\n            findings.forEach(finding -> log.debug(\"{} --> high: {}, medium: {}, low: {}\", finding.get(\"name\"), finding.get(\"high\"),\n                    finding.get(\"medium\"), finding.get(\"low\")));\n        }\n        findingsDefs = findings;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 112,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 727,
    "annotation": "\n    @Given(\"SCA thresholds section {} in cxflow configuration\")",
    "glue_code": "    @Given(\"SCA thresholds section {} in cxflow configuration\")\n    public void setThresholdsSectionExist(boolean thresholdsExist) {\n        thresholdsSectionExist = thresholdsExist;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 122,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 728,
    "annotation": "\n    @And(\"SCA thresholds {} by scan findings\")",
    "glue_code": "    @And(\"SCA thresholds {} by scan findings\")\n    public void setScaThresholds(boolean exceeded) {\n        if (thresholdsSectionExist){\n            int thresholdLimit;\n            if (exceeded){thresholdLimit = Integer.parseInt(DEFAULT_THRESHOLDS_LIMIT) - 1;}\n            else{thresholdLimit = Integer.parseInt(DEFAULT_THRESHOLDS_LIMIT) + 1;}\n\n            Map<Severity, Integer> map = new HashMap<>();\n            map.put(Severity.HIGH, thresholdLimit);\n            scaProperties.setThresholdsSeverity(map);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 127,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 729,
    "annotation": "\n    @And(\"cx-flow.break-build property is set to {}\")",
    "glue_code": "    @And(\"cx-flow.break-build property is set to {}\")\n    public void setBreakBuildProperty(boolean breakBuild){\n        flowProperties.setBreakBuild(breakBuild);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 140,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 730,
    "annotation": "\n    @When(\"cxflow called with get-latest-sca-project-results cli command\")",
    "glue_code": "    @When(\"cxflow called with get-latest-sca-project-results cli command\")\n    public void runCxFlowFromCommandLine() {\n\n        flowProperties.setBugTracker(BugTracker.Type.NONE.toString());\n\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), CLI_COMMAND);\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 145,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 731,
    "annotation": "\n    @When(\"threshold-severity is configured to {word}\")",
    "glue_code": "    @When(\"threshold-severity is configured to {word}\")\n    public void threshold_severity_is_configured_to_normal(String selectedConfig) {\n        configureThreshold(selectedConfig);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 172,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 732,
    "annotation": "\n    @Then(\"cxflow SCA should exit with the correct {}\")",
    "glue_code": "    @Then(\"cxflow SCA should exit with the correct {}\")\n    public void validateExitCode(int expectedExitCode) {\n        Throwable exception = testContext.getCxFlowExecutionException();\n\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", exception);\n        Assert.assertEquals(InvocationTargetException.class, exception.getClass());\n\n        Throwable targetException = ((InvocationTargetException) exception).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n\n        Assert.assertEquals(\"The expected exist code did not match\",\n                expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 177,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 733,
    "annotation": "\n    @When(\"scan finding is {word}\")",
    "glue_code": "    @When(\"scan finding is {word}\")\n    public void scan_finding_is_(String findings) {\n        this.scaResults = getFakeSCAResults(findings);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 207,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 734,
    "annotation": "\n    @Then(\"pull request should {word}\")",
    "glue_code": "    @Then(\"pull request should {word}\")\n    public void pull_request_should_fail(String expected) {\n        RepoProperties repoProperties = new RepoProperties();\n        repoProperties.setErrorMerge(true);\n        ScanResults scanResults = new ScanResults();\n        scanResults.setScaResults(scaResults);\n        PullRequestReport pullRequestReport = new PullRequestReport();\n        boolean actual = thresholdValidatorImpl.isMergeAllowed(scanResults, repoProperties, pullRequestReport);\n        log.info(\"is merged allowed = {} (expecting: {})\", actual, expected);\n        assertEquals(expected.equals(\"pass\"), actual, \"is merged allowed = \" + actual + \", but was expecting: \" + expected);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 212,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 735,
    "annotation": "\n    @When(\"max findings score is {word} threshold-score\")",
    "glue_code": "    @When(\"max findings score is {word} threshold-score\")\n    public void max_findings_score_threshold_score(String scoreType) {\n        Double findingsScore = generateScoreThresholds(scoreType);\n        scaResults = new SCAResults();\n        scaResults.setScanId(\"2\");\n        Summary summary = new Summary();\n        summary.setRiskScore(findingsScore);\n        List<Finding> findings = new ArrayList<>();\n        Stream<com.checkmarx.sdk.dto.sast.Filter.Severity> severityStream = Arrays.stream(Filter.Severity.values());\n        Arrays.stream(Severity.values()).forEach(severity -> populateFindings(findings, severity, 10));\n        scaResults.setFindings(findings);\n        Map<Filter.Severity, Integer> findingCounts = severityStream\n                .collect(Collectors.toMap(Function.identity(), v -> 10));\n        summary.setFindingCounts(findingCounts);\n        scaResults.setSummary(summary);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 224,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 736,
    "annotation": "\n    @When(\"the following thresholds fails on {word}\")",
    "glue_code": "    @When(\"the following thresholds fails on {word}\")\n    public void the_following_threshold_fails(String failType) {\n        boolean isPassSeverity = Arrays.asList(\"score\", \"none\").contains(failType);\n        boolean isPassScore = Arrays.asList(\"count\", \"none\").contains(failType);\n\n        thresholdDefs = Collections.singletonList(Arrays.stream(ThresholdFeatureKeys.values())\n                .collect(Collectors.toMap(\n                        key -> key.name().toLowerCase().replace('_', '-'),\n                        key -> key == ThresholdFeatureKeys.THRESHOLD_NAME ? \"spec\" : \"10\")));\n\n        findingsDefs = new ArrayList<>();\n\n        Map<String, String> map = new HashMap<>();\n        map.put(\"name\", \"findings-severity\");\n        Arrays.stream(Severity.values())\n                .forEach(key -> map.put(key.name().toLowerCase(), isPassSeverity ? \"5\" : \"15\"));\n        findingsDefs.add(map);\n\n        configureThreshold(\"spec\");\n        scaResults = getFakeSCAResults(\"findings-severity\");\n\n        Double findingsScore = generateScoreThresholds(isPassScore ? \"under\" : \"over\");\n        scaResults.getSummary().setRiskScore(findingsScore);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 253,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR/ScaThresholdsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/thresholds/scaPR",
      "filename": "ScaThresholdsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 737,
    "annotation": "\n    @Given(\"CxFlow is running as a service\")",
    "glue_code": "    @Given(\"CxFlow is running as a service\")\n    public void runAsService() {\n        ConfigurableApplicationContext context = TestUtils.runCxFlowAsService();\n        List<String> branchesAllowedForScan = context.getBean(FlowProperties.class).getBranches();\n\n        // As a result of this, the automation won't start in the background. This allows to avoid orphaned SAST scans.\n        // The automation flow is asynchronous, so request timing won't change.\n        branchesAllowedForScan.clear();\n\n        cxFlowPort = context.getEnvironment().getProperty(\"server.port\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 51,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/webhook/WebHookSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/webhook",
      "filename": "WebHookSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 738,
    "annotation": "\n    @When(\"GitHub sends WebHook requests to CxFlow {int} times per second\")",
    "glue_code": "    @When(\"GitHub sends WebHook requests to CxFlow {int} times per second\")\n    public void githubSendsWebHookRequests(int timesPerSecond) {\n        final int MILLISECONDS_IN_SECOND = 1000;\n\n        webHookRequest = testUtils.prepareWebhookRequest(GitHubTestUtils.EventType.PUSH);\n        sendWarmUpRequest();\n\n        int totalRequestCount = Integer.parseUnsignedInt(testProperties.getProperty(\"totalRequestCount\"));\n        Duration intervalBetweenRequests = Duration.ofMillis(MILLISECONDS_IN_SECOND / timesPerSecond);\n        log.info(\"Starting to send {} WebHook requests with the interval of {} ms.\",\n                totalRequestCount,\n                intervalBetweenRequests.toMillis());\n\n        for (int i = 0; i < totalRequestCount; i++) {\n            chillOutFor(intervalBetweenRequests);\n            CompletableFuture<Long> task = startRequestSendingTaskAsync(i);\n            requestSendingTasks.add(task);\n        }\n\n        waitForAllTasksToComplete(requestSendingTasks);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 63,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/webhook/WebHookSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/webhook",
      "filename": "WebHookSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 739,
    "annotation": "\n    @Then(\"each of the requests is answered in at most {int} ms\")",
    "glue_code": "    @Then(\"each of the requests is answered in at most {int} ms\")\n    public void eachOfTheRequestsIsAnsweredInAtMostMs(long expectedMaxDurationMs) {\n        List<Long> taskDurations = requestSendingTasks.stream()\n                .map(WebHookSteps::toExecutionTimeMs)\n                .collect(Collectors.toList());\n\n        log.info(\"Durations, ms: {}\", Arrays.toString(taskDurations.toArray()));\n\n        boolean allRequestsCompletedSuccessfully = taskDurations.stream().allMatch(Objects::nonNull);\n        Assert.assertTrue(\"Some of the requests failed.\", allRequestsCompletedSuccessfully);\n\n        Long actualMaxDurationMs = taskDurations.stream().max(Long::compare)\n                .orElseThrow(() -> new AssertionError(\"Actual max duration is not defined.\"));\n\n        String message = String.format(\"Actual max duration (%d ms) is greater than the expected max duration (%d ms).\",\n                actualMaxDurationMs,\n                expectedMaxDurationMs);\n        Assert.assertTrue(message, actualMaxDurationMs <= expectedMaxDurationMs);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 133,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/component/webhook/WebHookSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/component/webhook",
      "filename": "WebHookSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 751,
    "annotation": "\n    @Given(\"scan initiator is AST\")",
    "glue_code": "    @Given(\"scan initiator is AST\")\n    public void setScanInitiator() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(AstProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 69,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira/AstTicketsCreationViaJiraSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira",
      "filename": "AstTicketsCreationViaJiraSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 752,
    "annotation": "\n    @And(\"bug tracker is JIRA\")",
    "glue_code": "    @And(\"bug tracker is JIRA\")\n    public void setBugTracker() {\n        bugTracker = getBasicBugTrackerToJira();\n        flowProperties.setBugTracker(bugTracker.getType().name());\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 74,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira/AstTicketsCreationViaJiraSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira",
      "filename": "AstTicketsCreationViaJiraSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 753,
    "annotation": "\n    @When(\"publishing new known unfiltered AST results\")",
    "glue_code": "    @When(\"publishing new known unfiltered AST results\")\n    public void publishNewAstResults() throws IOException, MachinaException {\n        ScanResults scanResults = JsonUtils.json2Object(TestUtils.getFileFromRelativeResourcePath(INPUT_BASE_PATH + INPUT_FILE), ScanResults.class);\n        resultsService.processResults(getBasicScanRequest(), scanResults, null);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 80,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira/AstTicketsCreationViaJiraSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira",
      "filename": "AstTicketsCreationViaJiraSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 754,
    "annotation": "\n    @Then(\"new JIRA tickets should be open respectively\")",
    "glue_code": "    @Then(\"new JIRA tickets should be open respectively\")\n    public void validateJiraTicketsAreGettingOpen() {\n        int actualNumberOfIssuesInProject = jiraUtils.getNumberOfIssuesInProject(PROJECT_KEY);\n\n        Assert.assertEquals(\"Actual new AST-SAST tickets in JIRA are not as expected\",\n                EXPECTED_TICKETS_NUM, actualNumberOfIssuesInProject);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 86,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira/AstTicketsCreationViaJiraSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/bugtrackers/jira",
      "filename": "AstTicketsCreationViaJiraSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 740,
    "annotation": "\n    @When(\"CxFlow tries to start AST scan with the {string} and {string} credentials\")",
    "glue_code": "    @When(\"CxFlow tries to start AST scan with the {string} and {string} credentials\")\n    public void configureToken(String clientIdDescr, String clientSecretDescr){\n        astProperties.setClientId(toActualClientId(clientIdDescr));\n        astProperties.setClientSecret(toActualClientSecret(clientSecretDescr));\n        isAstEnabled = true;\n        try {\n            startScan(Collections.singletonList(astScanner), BRANCH, PUBLIC_REPO, true, \"AstScanCred\");\n        } catch (Exception e) {\n            scanException = e;\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 112,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 741,
    "annotation": "\n    @When(\"AST scan is initiated with API url: {string}\")",
    "glue_code": "    @When(\"AST scan is initiated with API url: {string}\")\n    public void configureAstInvalidMachine(String url) {\n        String effectiveUrl = url.replace(\"<ast url>\", astProperties.getApiUrl())\n                .replace(\"<sast url>\", cxProperties.getBaseUrl());\n\n        log.info(\"Setting url to {}\", effectiveUrl);\n        astProperties.setApiUrl(effectiveUrl);\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(AstProperties.CONFIG_PREFIX));\n        isAstEnabled = true;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 148,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 742,
    "annotation": "\n    @Then(\"an error will be thrown with the message containing {string}\")",
    "glue_code": "    @Then(\"an error will be thrown with the message containing {string}\")\n    public void errorWillBeThrown(String messageSubstring) {\n        assertNotNull(\"Expected an exception but didn't get any.\", scanException);\n\n        String testFailureMessage = String.format(\"The exception message ('%s') doesn't contain the expected text ('%s')\",\n                scanException.getMessage(),\n                messageSubstring);\n\n        assertTrue(testFailureMessage, StringUtils.containsIgnoreCase(scanException.getMessage(), messageSubstring));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 159,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 743,
    "annotation": "\n    @Then(\"an exception of type {string} will be thrown with the message containing {string}\")",
    "glue_code": "    @Then(\"an exception of type {string} will be thrown with the message containing {string}\")\n    public void astScanWithInvalidAstMachine(String exceptionType, String errorSubstring) {\n        List<VulnerabilityScanner> scanners = new LinkedList<>();\n        scanners.add(astScanner);\n        try {\n            startScan(scanners, BRANCH, PUBLIC_REPO, true, \"ast-negative-test\");\n            fail(\"no exception was thrown\");\n        } catch (Exception e) {\n            assertEquals(\"Unexpected exception type.\",exceptionType, e.getClass().getSimpleName());\n\n            String message = String.format(\"Expected error message to contain '%s'.\", errorSubstring);\n            boolean containsSubstring = StringUtils.containsIgnoreCase(e.getMessage(), errorSubstring);\n            assertTrue(message, containsSubstring);\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 170,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 744,
    "annotation": "\n    @Given(\"enabled vulnerability scanners are {string}\")",
    "glue_code": "    @Given(\"enabled vulnerability scanners are {string}\")\n    public void setScanInitiatorAndBranch(String initiatorList) {\n        List<VulnerabilityScanner> scanners = setScanInitiator(initiatorList);\n        startScan(scanners, BRANCH, PUBLIC_REPO, false, \"AstDetailsTest\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 186,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 745,
    "annotation": "\n    @Given(\"enabled vulnerability scanner is AST\")",
    "glue_code": "    @Given(\"enabled vulnerability scanner is AST\")\n    public void setScanInitiatorAst() {\n        List<VulnerabilityScanner> scanners = setScanInitiator(\"AST\");\n        startScan(scanners, BRANCH, PUBLIC_REPO, false, \"AstDetailsTest\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 192,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 746,
    "annotation": "    \n    @And(\"each finding will contain AST populated description field\")",
    "glue_code": "    @And(\"each finding will contain AST populated description field\")\n    public void validateAdditionalFields(){\n        assertTrue(\"AST description field is empty\", StringUtils.isNotEmpty(scanResults.getAstResults().getFindings().get(0).getDescription()));\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 198,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 747,
    "annotation": "\n    @And(\"finding with the same queryId will have the same description and there will be a unique finding description for each queryId\")",
    "glue_code": "    @And(\"finding with the same queryId will have the same description and there will be a unique finding description for each queryId\")\n    public void validateDescriptions() {\n        validateDescriptions(scanResults.getAstResults().getFindings());\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 203,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 748,
    "annotation": "    \n    @Given(\"enabled vulnerability scanners are {string} and repo {string}\")",
    "glue_code": "    @Given(\"enabled vulnerability scanners are {string} and repo {string}\")\n    public void startScanForInitiator(String initiatorList, String isPublic) {\n        List<VulnerabilityScanner> scanners = setScanInitiator(initiatorList);\n        startScan(scanners, BRANCH, PUBLIC_REPO, Boolean.parseBoolean(isPublic), \"AstIntegrationTest\");\n\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 233,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 749,
    "annotation": "\n\n    @Then(\"scan results contain populated results for all scanners\")",
    "glue_code": "\n    @Then(\"scan results contain populated results for all scanners\")\n    public void validateResults() {\n        if(isScaEnabled) {\n            assertNotNull(\"SCA results are null\", scanResults.getScaResults());\n            assertTrue(\"SCA scan ID is empty\", StringUtils.isNotEmpty(scanResults.getScaResults().getScanId()));\n        }\n        if(isAstEnabled) {\n            assertNotNull(\"AST results are null.\", scanResults.getAstResults());\n            assertTrue(\"AST scan ID is empty\", StringUtils.isNotEmpty(scanResults.getAstResults().getScanId()));\n        }\n     }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 261,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 750,
    "annotation": "\n    @And(\"sca finding count will be {string} and ast findings count {string} will be accordingly\")",
    "glue_code": "    @And(\"sca finding count will be {string} and ast findings count {string} will be accordingly\")\n    public void validateNumberOfFindings(String scaFindings, String astFindings) {\n        if (isScaEnabled) {\n            validateFindingCount(scaFindings, scanResults.getScaResults().getFindings(), \"SCA\");\n        }\n        if (isAstEnabled) {\n            validateFindingCount(astFindings, scanResults.getAstResults().getFindings(), \"AST\");\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 274,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans/AstRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ast/scans",
      "filename": "AstRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 755,
    "annotation": "    \n\n    @Given(\"application.yml contains the Azure project {string} and Asure namespace {string}\")",
    "glue_code": "\n    @Given(\"application.yml contains the Azure project {string} and Asure namespace {string}\")",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 148,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 756,
    "annotation": "\n    @And(\"commit or merge pull request is performed in github repo {string} and branch {string}\")",
    "glue_code": "    @And(\"commit or merge pull request is performed in github repo {string} and branch {string}\")\n    public void setBranchAppSet(String repoName, String branch){\n        this.branch = branch;\n        this.repoName = repoName;\n        gitHubProperties.setUrl(gitHubProperties.getUrl().concat(repoName));\n        \n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 163,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 757,
    "annotation": "\n    @And(\"SAST scan produces high and medium results\")",
    "glue_code": "    @And(\"SAST scan produces high and medium results\")\n    public void createScanResults() throws InterruptedException {\n        buildPushRequest();\n        processScanResultsInCxFlow();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 171,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 758,
    "annotation": "    \n    @Then(\"CxFlow will create appropriate tickets in project {string} in namespace {string} in Azure\")",
    "glue_code": "    @Then(\"CxFlow will create appropriate tickets in project {string} in namespace {string} in Azure\")\n    public void validateIssues(String project, String namespace){\n        try {\n            azureDevopsClient.init(namespace,project);\n            assertTrue(azureDevopsClient.projectExists());\n            assertEquals(2, azureDevopsClient.getIssues().size());\n            \n        } catch (IOException e) {\n            fail(e.getMessage());\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 215,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 759,
    "annotation": "\n    @And(\"Additional fields are populated\")",
    "glue_code": "    @And(\"Additional fields are populated\")\n    public void validateAdditionalFields() throws IOException {\n        azureDevopsClient.getIssues().forEach(issue -> {\n            Assert.assertTrue(issue.getBody().contains(DESCRIPTION_AST));\n        });\n\n        azureDevopsClient.deleteProjectIssues();\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 227,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 760,
    "annotation": "\n    @And(\"project {string} exists in Azure under namespace {string}\")",
    "glue_code": "    @And(\"project {string} exists in Azure under namespace {string}\")\n    public void validateProjectName(String project, String namespace) {\n\n        try {\n            azureDevopsClient.init(namespace, project);\n            azureDevopsClient.ensureProjectExists();\n            azureDevopsClient.deleteProjectIssues();\n        } catch (Exception e) {\n            fail(e.getMessage());\n        }\n\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 236,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 761,
    "annotation": "\n    @And(\"Scanner is AST\")",
    "glue_code": "    @And(\"Scanner is AST\")\n    public void setScannerAST(){\n        this.scannerType = AST;\n        flowProperties.setEnabledVulnerabilityScanners(Arrays.asList(AST));\n        scanResultsToInject = createFakeResults();\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 336,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 762,
    "annotation": "\n    @And(\"Scanner is SAST\")",
    "glue_code": "    @And(\"Scanner is SAST\")\n    public void setScannerSAST(){\n        this.scannerType = SAST;\n        flowProperties.setEnabledVulnerabilityScanners(Arrays.asList(SAST));\n        scanResultsToInject = createFakeResults();\n\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 343,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado/Github2AdoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/github2ado",
      "filename": "Github2AdoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 763,
    "annotation": "\n    @Given(\"issue tracker is ADO\")",
    "glue_code": "    @Given(\"issue tracker is ADO\")\n    public void issueTrackerIsADO() {\n        flowProperties.setBugTracker(ISSUE_TRACKER_NAME);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 88,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 764,
    "annotation": "\n    @And(\"CxFlow filters are disabled\")",
    "glue_code": "    @And(\"CxFlow filters are disabled\")\n    public void cxflowFiltersAreDisabled() {\n        flowProperties.setFilterSeverity(new ArrayList<>());\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 98,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 765,
    "annotation": "\n    @When(\"GitHub notifies CxFlow about a {string}\")",
    "glue_code": "    @When(\"GitHub notifies CxFlow about a {string}\")\n    public void githubNotifiesCxFlowAboutEvent(String eventName) {\n        currentGitHubEventType = determineEventType(eventName);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 103,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 766,
    "annotation": "\n    @And(\"SAST scan returns a report with 1 finding\")",
    "glue_code": "    @And(\"SAST scan returns a report with 1 finding\")\n    public void sastScanReturnsAReportWithFinding() {\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 108,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 767,
    "annotation": "\n    @And(\"CxFlow publishes the report\")",
    "glue_code": "    @And(\"CxFlow publishes the report\")\n    public void cxFlowPublishesReport() {\n        GitHubController gitHubController = getGitHubControllerInstance();\n        testUtils.callController(gitHubController, currentGitHubEventType, null);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 112,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 768,
    "annotation": "\n    @Then(\"ADO contains {int} issues\")",
    "glue_code": "    @Then(\"ADO contains {int} issues\")\n    public void adoContainsIssueCount(int expectedIssueCount) {\n        Duration timeout = Duration.ofSeconds(30);\n        Duration pollInterval = Duration.ofSeconds(5);\n        try {\n            Awaitility.await().atMost(timeout)\n                    .pollInterval(pollInterval)\n                    .until(() -> adoClient.getIssueCount() == expectedIssueCount);\n        } catch (ConditionTimeoutException e) {\n            String message = String.format(\"Waited for %s but didn't get the expected ADO issue count (%d).\",\n                    timeout, expectedIssueCount);\n\n            Assert.fail(message);\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 118,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/githubflow",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 777,
    "annotation": "\n    @Given(\"Azure DevOps initially contains {int} {string} issue with title: {string}\")",
    "glue_code": "    @Given(\"Azure DevOps initially contains {int} {string} issue with title: {string}\")\n    public void azureDevOpsInitiallyContainsIssueWithState(int issueCount, String stateDescription, String title) throws IOException {\n        String desiredState = stateDescription.equals(\"open\") ? adoProperties.getOpenStatus() : adoProperties.getClosedStatus();\n        String stateAllowedForCreation = adoProperties.getOpenStatus();\n\n        boolean needToUpdateAfterCreation = !desiredState.equals(stateAllowedForCreation);\n        for (int i = 0; i < issueCount; i++) {\n            Issue issue = createIssue(title, DESCRIPTION_STUB);\n            if (needToUpdateAfterCreation) {\n                adoClient.updateIssueState(issue, desiredState);\n            }\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 77,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 778,
    "annotation": "\n    @Given(\"Azure DevOps initially contains {int} open issue with title: {string} and description containing link: {string}\")",
    "glue_code": "    @Given(\"Azure DevOps initially contains {int} open issue with title: {string} and description containing link: {string}\")\n    public void azureDevOpsInitiallyContainsIssue(int issueCount, String title, String link) throws IOException {\n        String description = String.format(\"Description containing %s link\", link);\n        for (int i = 0; i < issueCount; i++) {\n            createIssue(title, description);\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 91,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 779,
    "annotation": "\n    @Given(\"Azure DevOps initially contains 2 open issues with titles {string} and {string}\")",
    "glue_code": "    @Given(\"Azure DevOps initially contains 2 open issues with titles {string} and {string}\")\n    public void azureDevOpsInitiallyContainsOpenIssues(String title1, String title2) throws IOException {\n        createIssue(title1, DESCRIPTION_STUB);\n        createIssue(title2, DESCRIPTION_STUB);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 99,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 780,
    "annotation": "\n    @Then(\"Azure DevOps contains {int} issues\")",
    "glue_code": "    @Then(\"Azure DevOps contains {int} issues\")\n    public void azureDevOpsContainsIssueCountIssues(int expectedCount) throws IOException {\n        List<Issue> issues = getIssues();\n        verifyIssueCount(issues, expectedCount);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 111,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 781,
    "annotation": "\n    @Given(\"Azure DevOps contains {int} open issue with title: {string} and description containing link: {string}\")",
    "glue_code": "    @Given(\"Azure DevOps contains {int} open issue with title: {string} and description containing link: {string}\")\n    public void azureDevOpsContainsIssue(int issueCount, String title, String link) throws IOException {\n        List<Issue> issues = getIssues();\n        verifyIssueCount(issues, issueCount);\n        String linkInHtmlAttribute = HtmlUtils.htmlEscape(link);\n        for (Issue issue : issues) {\n            assertEquals(adoProperties.getOpenStatus(), issue.getState(), \"Invalid issue state.\");\n            assertEquals(title, issue.getTitle(), \"Invalid issue title.\");\n\n            String description = issue.getBody();\n            assertNotNull(description, \"Issue is missing description.\");\n            assertTrue(description.contains(linkInHtmlAttribute), \"Description doesn't contain the link: \" + link);\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 117,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 782,
    "annotation": "\n    @Then(\"Azure DevOps contains {int} issue with the title {string} and {string} state\")",
    "glue_code": "    @Then(\"Azure DevOps contains {int} issue with the title {string} and {string} state\")\n    public void azureDevOpsContainsClosedIssueWithTheTitle(int issueCount, String title, String state) throws IOException {\n        List<Issue> issues = getIssues();\n        verifyIssueCount(issues, issueCount);\n        boolean allIssuesAreCorrect = issues.stream().allMatch(issueHas(title, state));\n        assertTrue(allIssuesAreCorrect, getIssueError(issues));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 132,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 783,
    "annotation": "\n    @When(\"^publishing (?:the|a SAST) report$\")",
    "glue_code": "    @When(\"^publishing (?:the|a SAST) report$\")\n    public void publishingTheReport() throws Exception, ExitThrowable {\n        ScanRequest request = prepareScanRequest();\n\n        String sastReportPath = Paths.get(Constants.SAMPLE_SAST_RESULTS_DIR, sastReportFilename).toString();\n        File sastReport = TestUtils.getFileFromResource(sastReportPath);\n\n        try {\n            sastScanner.cxParseResults(request, sastReport);\n        } catch (Throwable e) {\n            if (expectingException) {\n                lastCxFlowException = e;\n            } else {\n                throw e;\n            }\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 140,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 784,
    "annotation": "\n    @And(\"SAST report contains {int} findings with the same vulnerability type and in the same file, and not marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains {int} findings with the same vulnerability type and in the same file, and not marked as false positive\")\n    public void sastReportContainsFindingsSameVulnAndFile(int findingCount) {\n        switch (findingCount) {\n            case 0:\n                sastReportFilename = \"empty-results.xml\";\n                break;\n            case 1:\n                sastReportFilename = REPORT_WITH_ONE_FINDING;\n                break;\n            case 2:\n                sastReportFilename = \"2-findings-same-vuln-type-same-file.xml\";\n                break;\n            default:\n                fail(\"Unexpected finding count: \" + findingCount);\n                break;\n        }\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 158,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 785,
    "annotation": "\n    @And(\"SAST report contains 2 findings, each with a different vulnerability type and filename, and not marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains 2 findings, each with a different vulnerability type and filename, and not marked as false positive\")\n    public void sastReportContainsNumberOfFindingsDifferentVulnAndFile() {\n        sastReportFilename = \"2-findings-different-vuln-type-different-files.xml\";\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 176,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 786,
    "annotation": "\n    @And(\"SAST report contains 3 findings, all marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains 3 findings, all marked as false positive\")\n    public void sastReportContainsFindingsAllMarkedAsFalsePositive() {\n        sastReportFilename = \"3-findings-all-false-positive.xml\";\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 181,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 787,
    "annotation": "\n    @And(\"SAST report contains 1 finding with vulnerability type {string} and filename {string}, not marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains 1 finding with vulnerability type {string} and filename {string}, not marked as false positive\")\n    public void sastReportContainsFinding(String vulnerabilityType, String filename) {\n        sastReportFilename = REPORT_WITH_ONE_FINDING;\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 186,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 788,
    "annotation": "\n    @And(\"SAST report contains 1 finding with vulnerability type {string}, filename {string}, link {string}, and not marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains 1 finding with vulnerability type {string}, filename {string}, link {string}, and not marked as false positive\")\n    public void sastReportContainsFindingWithLink(String vulnerabilityType, String filename, String link) {\n        sastReportFilename = REPORT_WITH_ONE_FINDING;\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 191,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 789,
    "annotation": "\n    @And(\"SAST report contains 2 findings with vulnerability type {string}, filename {string} and marked as false positive\")",
    "glue_code": "    @And(\"SAST report contains 2 findings with vulnerability type {string}, filename {string} and marked as false positive\")\n    public void sastReportContainsFindingsMarkedAsFalsePositive(String vulnerabilityType, String filename) {\n        sastReportFilename = \"2-findings-same-vuln-type-same-file-false-positive.xml\";\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 196,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 790,
    "annotation": "\n    @And(\"^(?:one of the issues|the other issue) has the title: \\\"(.*)\\\" and is in \\\"(.*)\\\" state$\")",
    "glue_code": "    @And(\"^(?:one of the issues|the other issue) has the title: \\\"(.*)\\\" and is in \\\"(.*)\\\" state$\")\n    public void oneOfTheIssuesHasTheTitleAndIsInState(String title, String state) {\n        List<Issue> matchingIssues = issuesAfterPublish.stream()\n                .filter(issue -> issue.getTitle().equals(title) &&\n                        issue.getState().equals(state))\n                .collect(Collectors.toList());\n\n        verifyIssueCount(matchingIssues, 1);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 201,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 791,
    "annotation": "\n    @And(\"an issue with the title {string} is in {string} state\")",
    "glue_code": "    @And(\"an issue with the title {string} is in {string} state\")\n    public void anIssueWithTheTitleIsInState(String title, String state) {\n        Optional<Issue> targetIssue = issuesAfterPublish.stream()\n                .filter(issue -> StringUtils.equals(issue.getTitle(), title))\n                .findFirst();\n\n        assertTrue(targetIssue.isPresent(), \"Unable to find an issue with the title: \" + title);\n\n        String actualState = targetIssue.get().getState();\n        String message = String.format(\"Unexpected issue state (issue ID: %s).\", targetIssue.get().getId());\n        assertEquals(state, actualState, message);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 211,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 792,
    "annotation": "\n    @Given(\"invalid Azure DevOps URL is provided in configuration\")",
    "glue_code": "    @Given(\"invalid Azure DevOps URL is provided in configuration\")\n    public void invalidAzureDevOpsURLIsProvidedInConfiguration() {\n        adoProperties.setUrl(\"http://invalid.url\");\n        expectingException = true;\n        sastReportFilename = REPORT_WITH_ONE_FINDING;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 224,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 793,
    "annotation": "\n    @Then(\"CxFlow should throw {string}\")",
    "glue_code": "    @Then(\"CxFlow should throw {string}\")\n    public void cxflowShouldThrowAnException(String exceptionClassName) {\n        assertNotNull(lastCxFlowException, \"Expected CxFlow to throw an exception.\");\n\n        Class<?> expectedExceptionClass = null;\n        try {\n            expectedExceptionClass = Class.forName(exceptionClassName);\n        } catch (ClassNotFoundException e) {\n            fail(\"Invalid class name: \" + exceptionClassName);\n        }\n        Class<? extends Throwable> actualExceptionClass = lastCxFlowException.getClass();\n        log.info(\"Caught a {}: {}\", actualExceptionClass.getName(), lastCxFlowException.getMessage());\n\n        assertEquals(expectedExceptionClass, actualExceptionClass, \"Unexpected exception type.\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 231,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing/PublishingSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/azure/publishing/issueprocessing",
      "filename": "PublishingSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 769,
    "annotation": "\n    @Given(\"scanner is {}\")",
    "glue_code": "    @Given(\"scanner is {}\")\n    public void setScanInitiator(String initiatorList) {\n\n        List<String> scanners = Arrays.asList(initiatorList.toLowerCase().split(SEPARATOR));\n        flowProperties.setEnabledVulnerabilityScanners(scanners);\n\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 98,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 770,
    "annotation": "    @And(\"source directory contains vulnerable files\")",
    "glue_code": "    public void sourceDirectoryContainsVulnerableFiles() throws IOException {\n        directoryToScan = getTempDir();\n        copyTestProjectTo(directoryToScan);\n    }\n\n\n    @When(\"running a AST scan with break-build on {}\")\n    public void runningWithBreakBuild(String issueType) {",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 106,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 771,
    "annotation": "\n\n    @When(\"running a AST scan with break-build on {}\")",
    "glue_code": "\n    @When(\"running a AST scan with break-build on {}\")",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 111,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 772,
    "annotation": "\n    @Then(\"run should exit with exit code {}\")",
    "glue_code": "    @Then(\"run should exit with exit code {}\")\n    public void validateExitCode(int expectedExitCode) {\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", cxFlowExecutionException);\n        Assert.assertEquals(InvocationTargetException.class, cxFlowExecutionException.getClass());\n\n        Throwable targetException = ((InvocationTargetException) cxFlowExecutionException).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n\n        Assert.assertEquals(\"The expected exit code did not match\", expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 143,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 773,
    "annotation": "    \n\n    @When(\"repository is github\")",
    "glue_code": "\n    @When(\"repository is github\")\n    public void runnningScan() {\n        \n        customAstProjectName = \"test\";\n        \n        StringBuilder commandLine = new StringBuilder();\n        commandLine.append(\" --scan --app=MyApp --cx-project=test\").append(GITHUB_REPO_ARGS);\n\n        tryRunCxFlow(commandLine.toString());\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 156,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 774,
    "annotation": "\n    @Then(\"bug tracker contains {} issues\")",
    "glue_code": "    @Then(\"bug tracker contains {} issues\")\n    public void validateBugTrackerIssues(int expectedIssuesCount) {\n\n        int actualIssueCount = jiraUtils.getNumberOfIssuesInProject(jiraProperties.getProject());\n        Iterable<Issue> actualIssues = jiraUtils.searchForAllIssues(jiraProperties.getProject()).getIssues();\n\n        actualIssues.forEach(issue -> {\n            \n            if(flowProperties.getEnabledVulnerabilityScanners().size() ==1 && flowProperties.getEnabledVulnerabilityScanners().get(0).equalsIgnoreCase(\"AST\")) {\n                \n                //validate state\n                Assert.assertTrue(issue.getDescription().contains(\"TO_VERIFY\"));\n\n                //validate description\n                if (issue.getDescription().contains(\"Cross_Site_History_Manipulation\")) {\n                    Assert.assertTrue(issue.getDescription().contains(\"Method @SourceMethod at line @SourceLine of @SourceFile may leak server-side conditional values, enabling user tracking from another website. This may constitute a Privacy Violation.\"));\n                }\n//                if (issue.getDescription().contains(\"Hardcoded_password_in_Connection_String\")) {\n//                    Assert.assertTrue(issue.getDescription().contains(\"The application contains hardcoded connection details, @SourceElement, at line@SourceLine of@SourceFile. This connection string contains a hardcoded password,which is used in @DestinationMethod at line @DestinationLine of @DestinationFile to connect to a database server with @DestinationElement. This can expose the database password, and impede proper password management.\"));\n//                }\n            }\n        });\n\n        log.info(\"comparing expected number of issues: {}, to actual bug tracker issues; {}\", expectedIssuesCount, actualIssueCount);\n        Assert.assertEquals(\"Wrong issue count in bug tracker.\", expectedIssuesCount, actualIssueCount);\n        \n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 168,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 775,
    "annotation": "\n\n    @When(\"running CxFlow with `scan local sources` option and {}\")",
    "glue_code": "\n    @When(\"running CxFlow with `scan local sources` option and {}\")",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 196,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 776,
    "annotation": "\n\n    @And(\"no exception is thrown\")",
    "glue_code": "\n    @And(\"no exception is thrown\")\n    public void noExceptionIsThrown() {\n        Assert.assertNull(\"Unexpected exception while running CxFlow\", cxFlowExecutionException);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 207,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast/AstCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/ast",
      "filename": "AstCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 794,
    "annotation": "\n    @Given(\"mock CLI runner {} {} {}\")",
    "glue_code": "    @Given(\"mock CLI runner {} {} {}\")\n    public void mockCliRunner(String scanTag, String bugTracker, String params) {\n        scanTag = removeQuotes(scanTag);\n        bugTracker = removeQuotes(bugTracker);\n        params = removeQuotes(params);\n        cxFlowRunner = new CxFlowRunner(\n                        flowProperties,\n                        cxScannerService,\n                        jiraProperties,\n                        bitBucketProperties,\n                        gitHubProperties,\n                        gitLabProperties,\n                        iastService,\n                        adoProperties,\n                pdfProperties,\n                helperService,\n                executors,\n                resultsService,\n                osaScannerService,\n                filterFactory,\n                configOverrider,\n                buildProperties,\n                scanners\n                , thresholdValidator);\n        String arguments = ARGS + \" --scan-tag=\" + scanTag + \" --bug-tracker=\" + bugTracker + \" \" + params;\n        String[] argsParam = arguments.split(\" \");\n        this.args = new DefaultApplicationArguments(argsParam);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 114,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 795,
    "annotation": "    @When(\"running cli {} {}\")",
    "glue_code": "    public void runningIastCli(String exitCode, String scanTag) {\n        exitCode = removeQuotes(exitCode);\n        try {\n            Method method = cxFlowRunner.getClass().getDeclaredMethod(\"commandLineRunner\", ApplicationArguments.class);\n            method.setAccessible(true);\n            method.invoke(cxFlowRunner, args);\n        } catch (InvocationTargetException e) {\n            //catch ExitThrowable. That exception throw when we try to finish application. That is normal situation whe we fall build by Thresholds Severity\n            String messageExitCode = e.getTargetException().getMessage().toLowerCase(Locale.ROOT);\n\n            System.out.println(scanTag);\n            Assert.assertEquals(\"exit code:\" + exitCode, messageExitCode);\n        }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 145,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 796,
    "annotation": "\n    @When(\"I am using these parameters {} {} {} {} {}\")",
    "glue_code": "    @When(\"I am using these parameters {} {} {} {} {}\")\n    public void requestBodyBuild(String projectId, String namespace, String assignee, String bugTrackerProject, String repoName) {\n        body = new JSONObject();\n        if (!Strings.isEmpty(projectId)) {\n            body.put(\"project-id\", Integer.valueOf(removeQuotes(projectId, false)));\n        }\n        if (!Strings.isEmpty(namespace)) {\n            body.put(\"namespace\", removeQuotes(namespace, false));\n        }\n        if (!Strings.isEmpty(assignee)) {\n            body.put(\"assignee\", removeQuotes(assignee, false));\n        }\n        if (!Strings.isEmpty(bugTrackerProject)) {\n            body.put(\"bugTrackerProject\", removeQuotes(bugTrackerProject, false));\n        }\n        if (!Strings.isEmpty(repoName)) {\n            body.put(\"repoName\", removeQuotes(repoName, false));\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 160,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 797,
    "annotation": "\n    @When(\"I do a request to bug tracker {} using this scan tag {} and this request token {}\")",
    "glue_code": "    @When(\"I do a request to bug tracker {} using this scan tag {} and this request token {}\")\n    public void doRequest(String bugTracker, String scanTag, String requestToken) throws Exception {\n        headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_JSON);\n        headers.add(TOKEN_HEADER, requestToken);\n\n        urlRequest = \"/iast/stop-scan-and-create-\" + removeQuotes(bugTracker, false) + \"-issue/\" + removeQuotes(scanTag, false);\n\n        mvcResult = mvc.perform(MockMvcRequestBuilders.post(urlRequest)\n                .content(body.toString())\n                .headers(headers)\n        ).andReturn();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 180,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 798,
    "annotation": "    @Then(\"the status code should be equals to {}\")",
    "glue_code": "    public void checkStatusCode(int statusCode) {\n        Assert.assertEquals(mvcResult.getResponse().getStatus(), statusCode);\n    }\n\n    @Given(\"mock services {} {} {}\")\n    public void mockServices(String scanTag, String filter, String thresholdsSeverity) throws Exception {",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 196,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 799,
    "annotation": "\n    @Given(\"mock services {} {} {}\")",
    "glue_code": "    @Given(\"mock services {} {} {}\")\n    public void mockServices(String scanTag, String filter, String thresholdsSeverity) throws Exception {\n        scanTag = removeQuotes(scanTag);\n        filter = removeQuotes(filter);\n        thresholdsSeverity = removeQuotes(thresholdsSeverity);\n\n        List<Severity> filterSeverity = new ArrayList<>(4);\n        String[] filterNames = filter.split(\",\");\n        for (String filterName : filterNames) {\n            filterSeverity.add(Severity.valueOf(filterName.trim()));\n        }\n        iastProperties.setFilterSeverity(filterSeverity);\n\n        String[] thresholdsSeverityArray = thresholdsSeverity.split(\",\");\n        Map<Severity, Integer> thresholdsSeverityMap = new HashMap<>();\n        for (String s : thresholdsSeverityArray) {\n            String[] split = s.split(\"=\");\n            thresholdsSeverityMap.put(Severity.valueOf(split[0]),Integer.valueOf(split[1]));\n        }\n        iastProperties.setThresholdsSeverity(thresholdsSeverityMap);\n\n        reset(jiraService, gitHubIssueTracker, gitLabIssueTracker);\n\n        Scan scan = mockIastServiceRequestsApiScansScanTagFinish(scanTag);\n        ScanVulnerabilities scanVulnerabilities = mockIastServiceRequestsApiScanVulnerabilities(scan);\n        mockIastServiceRequestsApiScanResults(scan, scanVulnerabilities.getVulnerabilities().get(0));\n        mockIastServiceRequestsApiScanResults(scan, scanVulnerabilities.getVulnerabilities().get(1));\n        mockServiceCreateIssue();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 200,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 809,
    "annotation": "    @When(\"running iast service {}\")",
    "glue_code": "    public void runningIastService(String scanTag) {\n        scanTag = removeQuotes(scanTag);\n        try {\n            BugTracker.Type bugType = BugTracker.Type.GITHUBCOMMIT;\n            String assignee = \"test_user\";\n            BugTracker bt = BugTracker.builder()\n                    .type(bugType)\n                    .assignee(assignee)\n                    .build();\n\n            ScanRequest request = ScanRequest.builder()\n                    .bugTracker(bt)\n                    .build();\n\n            iastService.stopScanAndCreateIssue(request, scanTag);\n        } catch (IastThresholdsSeverityException e) {\n            //that is ok. Just Thresholds Severity\n        }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 245,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 810,
    "annotation": "    @Then(\"check how many create issue {} {}\")",
    "glue_code": "    public void checkHowManyCreateIssue(String createIssue, String bugTracker) {\n        int createdIssues = Integer.parseInt(removeQuotes(createIssue));\n        IssueTracker issueTracker = null;\n        switch (bugTracker) {\n            case \"jira\":\n                verify(jiraService, times(createdIssues)).createIssue(any(), any());\n                return;\n            case \"github\":\n                issueTracker = gitHubIssueTracker;\n                break;\n            case \"gitlab\":\n                issueTracker = gitLabIssueTracker;\n                break;\n            case \"ado\":\n                issueTracker = adoIssueTracker;\n                break;\n        }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 267,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast/IastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/iast",
      "filename": "IastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 800,
    "annotation": "\n    @Given(\"repository is github-sast\")",
    "glue_code": "    @Given(\"repository is github-sast\")\n    public void setRepo() {\n        commandlineConstantArgs = GITHUB_REPO_ARGS;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 74,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 801,
    "annotation": "\n    @When(\"running with break-build on {word}\")",
    "glue_code": "    @When(\"running with break-build on {word}\")\n    public void runningWithBreakBuild(String issueType) {\n        StringBuilder commandBuilder = new StringBuilder();\n\n\n        switch (issueType) {\n            case \"success\":\n                commandBuilder.append(\"--scan  --severity=High --cwe=1 --app=MyApp\").append(commandlineConstantArgs);\n                break;\n            case \"missing-mandatory-parameter\":\n                commandBuilder.append(\"--severity=High --severity=Medium\").append(commandlineConstantArgs);\n                break;\n            case \"error-processing-request\":\n                commandBuilder.append(\"--scan  --severity=High --severity=Medium\").append(commandlineConstantArgs);\n                break;\n\n            default:\n                throw new PendingException(\"Issues type \" + issueType + \" isn't supported\");\n        }\n\n        log.info(\"Running CxFlow scan with command line: {}\", commandBuilder.toString());\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), commandBuilder.toString());\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 79,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 802,
    "annotation": "\n    @Then(\"running cxflow to execute SAST scan\")",
    "glue_code": "    @Then(\"running cxflow to execute SAST scan\")\n    public void runCxFlowScan() {\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), STANDARD_CLI_SCAN + GITHUB_REPO_ARGS + PROJECT_NAME_ARG);\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 114,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 803,
    "annotation": "\n    @Then(\"cxflow should not wait for scan results\")",
    "glue_code": "    @Then(\"cxflow should not wait for scan results\")\n    public void validateScanNotFinished() throws CheckmarxException {\n\n        String teamId = cxProperties.getTeam();\n        String ownerId = cxService.getTeamId(teamId);\n        Integer projectId = cxService.getProjectId(ownerId, NONE__BUG_TRACKER_TEST_PROJECT_NAME);\n\n        log.info(\"Checking if there is any existing scan for Project:\");\n        Integer existingScanId = cxService.getScanIdOfExistingScanIfExists(projectId);\n\n        log.info(\"found scanId {}\", existingScanId);\n        Assert.assertNotEquals(-1, (long)existingScanId);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 125,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 804,
    "annotation": "\n    @Then(\"cxflow should exit with exit code: {}\")",
    "glue_code": "    @Then(\"cxflow should exit with exit code: {}\")\n    public void checkReturnCode(int expectedExitCode) {\n        Throwable exception = testContext.getCxFlowExecutionException();\n\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", exception);\n        Assert.assertEquals(InvocationTargetException.class, exception.getClass());\n\n        Throwable targetException = ((InvocationTargetException) exception).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n\n        Assert.assertEquals(\"The expected exist code did not match\",\n                expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 139,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 805,
    "annotation": "\n\n    @Given(\"code has x High, y Medium and z low issues\")",
    "glue_code": "\n    @Given(\"code has x High, y Medium and z low issues\")\n    public void setIssues() {\n        expectedHigh = 1;\n        expectedMedium = 5;\n        expectedLow = 1;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 155,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 806,
    "annotation": "\n    @When(\"running sast scan {word}\")",
    "glue_code": "    @When(\"running sast scan {word}\")\n    public void runnningScanWithFilter(String filter) {\n        StringBuilder commandBuilder = new StringBuilder();\n\n        switch (filter) {\n            case \"no-filter\":\n                commandBuilder.append(\" --scan  --scanner=sast --severity=High --severity=Medium --severity=Low --app=MyApp\").append(commandlineConstantArgs);\n                break;\n            case \"filter-High-and-Medium\":\n                commandBuilder.append(\" --scan  --scanner=sast --severity=High --severity=Medium --app=MyApp\").append(commandlineConstantArgs);\n                break;\n            case \"filter-only-Medium\":\n                commandBuilder.append(\" --scan  --scanner=sast --severity=Medium --app=MyApp\").append(commandlineConstantArgs);\n                break;\n            case \"filter-invalid-cwe\":\n                commandBuilder.append(\" --scan  --scanner=sast --cwe=1 --app=MyApp\").append(commandlineConstantArgs);\n                break;\n            default:\n                throw new PendingException(\"Filter \" + filter + \" isn't supported\");\n        }\n\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(testContext.getCxFlowRunner(), commandBuilder.toString());\n        } catch (Throwable e) {\n            exception = e;\n        }\n        testContext.setCxFlowExecutionException(exception);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 163,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 807,
    "annotation": "\n    @Then(\"bugTracker contains {} issues\")",
    "glue_code": "    @Then(\"bugTracker contains {} issues\")\n    public void validateBugTrackerIssues(String numberOfIssues) {\n        int expectedIssuesNumber;\n\n        switch (numberOfIssues) {\n            case \"x+y+z\":\n                expectedIssuesNumber = expectedHigh + expectedMedium + expectedLow;\n                break;\n            case \"x+y\":\n                expectedIssuesNumber = expectedHigh + expectedMedium;\n                break;\n            case \"y\":\n                expectedIssuesNumber = expectedMedium;\n                break;\n            case \"0\":\n                expectedIssuesNumber = 0;\n                break;\n\n            default:\n                throw new PendingException(\"Number of issues parameter \" + numberOfIssues + \" isn't supported\");\n        }\n\n        int actualOfJiraIssues = jiraUtils.getNumberOfIssuesInProject(jiraProperties.getProject());\n        Assert.assertEquals(expectedIssuesNumber, actualOfJiraIssues);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 193,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 808,
    "annotation": "\n    @And(\"and enabledZipScan is set to {string}\")",
    "glue_code": "    @And(\"and enabledZipScan is set to {string}\")\n    public void andEnabledZipScanIsSetTo(String enabledZipScan) {\n        if(enabledZipScan.equals(\"true\")){\n            cxProperties.setEnabledZipScan(true);\n        }else if(enabledZipScan.equals(\"false\")){\n            cxProperties.setEnabledZipScan(false);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 231,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast/SastCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sast",
      "filename": "SastCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 811,
    "annotation": "\n    @Given(\"source directory contains vulnerable files\")",
    "glue_code": "    @Given(\"source directory contains vulnerable files\")\n    public void sourceDirectoryContainsVulnerableFiles() throws IOException {\n        directoryToScan = getTempDir();\n        copyTestProjectTo(directoryToScan);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 91,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 812,
    "annotation": "\n    @Given(\"code has 6 High, 11 Medium and 1 low issues\")",
    "glue_code": "    @Given(\"code has 6 High, 11 Medium and 1 low issues\")\n    public void setProject() {\n        customScaProjectName = \"test\";\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 97,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 813,
    "annotation": "\n    @When(\"running a SCA scan with {} input\")",
    "glue_code": "    @When(\"running a SCA scan with {} input\")\n    public void runningWithBreakBuild(String input) {\n        StringBuilder commandBuilder = new StringBuilder();\n        setFilters(\"High\");\n        switch (input) {\n            case \"success\":\n                commandBuilder.append(\"--scan --sca-policy-disable=true  --severity=High --app=MyApp --cx-project=test\").append(GITHUB_REPO_ARGS);\n                scaProperties.setThresholdsScore(10.0);\n                break;\n            case \"break-build\":\n                commandBuilder.append(\"--scan  --severity=High --app=MyApp --cx-project=test\").append(GITHUB_REPO_ARGS);\n                scaProperties.setThresholdsScore(1.0);\n                break;\n            case \"missing-mandatory-parameter\":\n                commandBuilder.append(GITHUB_REPO_ARGS);\n                break;\n            case \"error-processing-request\":\n                commandBuilder.append(\"--scan --app=MyApp\").append(GITHUB_REPO_ARGS);\n                break;\n            case \"missing-project\":\n                commandBuilder.append(\"--scan --app=MyApp --f=nofile\").append(REPO_ARGS);\n                break;\n            default:\n                throw new PendingException(\"Issues type \" + input + \" isn't supported\");\n        }\n\n        log.info(\"Running CxFlow scan with command line: {}\", commandBuilder.toString());\n        Throwable exception = null;\n        try {\n            TestUtils.runCxFlow(cxFlowRunner, commandBuilder.toString());\n        } catch (Throwable e) {\n            exception = e;\n        }\n        cxFlowExecutionException = exception;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 102,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 814,
    "annotation": "\n    @Then(\"run should exit with exit code {}\")",
    "glue_code": "    @Then(\"run should exit with exit code {}\")\n    public void validateExitCode(int expectedExitCode) {\n        Assert.assertNotNull(\"Expected an exception to be thrown.\", cxFlowExecutionException);\n        Assert.assertEquals(InvocationTargetException.class, cxFlowExecutionException.getClass());\n\n        Throwable targetException = ((InvocationTargetException) cxFlowExecutionException).getTargetException();\n        Assert.assertTrue(targetException instanceof ExitThrowable);\n\n        int actualExitCode = ((ExitThrowable) targetException).getExitCode();\n\n        Assert.assertEquals(\"The expected exit code did not match\", expectedExitCode, actualExitCode);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 138,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 815,
    "annotation": "\n    @Given(\"last scan for a project {string} contains 50 High, 3 Medium and 1 Low-severity findings\")",
    "glue_code": "    @Given(\"last scan for a project {string} contains 50 High, 3 Medium and 1 Low-severity findings\")\n    public void setProjectWithFindings(String projectName){\n        customScaProjectName = projectName;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 151,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 816,
    "annotation": "\n    @When(\"running sca scan {word}\")",
    "glue_code": "    @When(\"running sca scan {word}\")\n    public void runnningScanWithFilter(String filters) {\n        setFilters(filters);\n        tryRunCxFlow(\" --scan --app=MyApp --cx-project=test\" + GITHUB_REPO_ARGS);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 156,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 817,
    "annotation": "\n    @Then(\"bug tracker contains {} issues\")",
    "glue_code": "    @Then(\"bug tracker contains {} issues\")\n    public void validateBugTrackerIssues(String description) {\n        int expectedIssueCount = getExpectedIssueCount(description);\n        int actualIssueCount = jiraUtils.getNumberOfIssuesInProject(jiraProperties.getProject());\n\n        log.info(\"comparing expected number of issues: {}, to actual bug tracker issues; {}\", expectedIssueCount, actualIssueCount);\n        if (expectedIssueCount == AT_LEAST_ONE) {\n            Assert.assertTrue(\"Expected at least one issue in bug tracker.\", actualIssueCount >= 0);\n        } else {\n            Assert.assertEquals(\"Wrong issue count in bug tracker.\", expectedIssueCount, actualIssueCount);\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 162,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 818,
    "annotation": "\n    @And(\"last scan for the project contains {} findings\")",
    "glue_code": "    @And(\"last scan for the project contains {} findings\")\n    public void lastScanForProjectContainsFindings(int findingCount) {\n        switch (findingCount) {\n            case 0:\n                customScaProjectName = \"ci-2-to-0-findings-test\";\n                break;\n            case 12:\n                customScaProjectName = \"cxflowtestuser-testsManual-master\";\n                break;\n            case 5:\n                customScaProjectName = \"ci-2-to-5-findings-test\";\n                break;\n            default:\n                throw new IllegalArgumentException(String.format(\"The %d finding count is not supported.\", findingCount));\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 175,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 819,
    "annotation": "\n    @Given(\"previous scan for a SCA project contains {int} findings\")",
    "glue_code": "    @Given(\"previous scan for a SCA project contains {int} findings\")\n    public void previousScanForASCAProjectContainsFindings(int count) {\n        log.info(\"Assuming finding count: {} for the previous scan.\", count);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 192,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 820,
    "annotation": "\n    @When(\"running CxFlow with `publish latest scan results` options\")",
    "glue_code": "    @When(\"running CxFlow with `publish latest scan results` options\")\n    public void runCxFlowWithPublishLatestScanResultsOptions() {\n        String commandLine = String.format(\"--project --cx-project=%s --app=MyApp --blocksysexit\", customScaProjectName);\n        tryRunCxFlow(commandLine);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 197,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 821,
    "annotation": "\n    @When(\"run CxFlow with `publish latest scan results` options and {}\")",
    "glue_code": "    @When(\"run CxFlow with `publish latest scan results` options and {}\")\n    public void runCxFlowGetLatestProjectResultsWithFilters(String filters){\n        setFilters(filters);\n        runCxFlowWithPublishLatestScanResultsOptions();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 203,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 822,
    "annotation": "\n    @When(\"running CxFlow with `scan local sources` options\")",
    "glue_code": "    @When(\"running CxFlow with `scan local sources` options\")\n    public void runningCxFlowWithScanLocalSourcesOptions() {\n        customScaProjectName = \"ci-local-scan-test\";\n\n        String commandLine = String.format(\"--scan --cx-project=%s --app=MyApp --f=%s --blocksysexit\",\n                customScaProjectName,\n                directoryToScan);\n\n        tryRunCxFlow(commandLine);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 219,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 823,
    "annotation": "\n    @And(\"no exception is thrown\")",
    "glue_code": "    @And(\"no exception is thrown\")\n    public void noExceptionIsThrown() {\n        Assert.assertNull(\"Unexpected exception while running CxFlow\", cxFlowExecutionException);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 242,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca/ScaCliSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cli/sca",
      "filename": "ScaCliSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 824,
    "annotation": "\n    @When(\"CxFlow parsing SAST results\")",
    "glue_code": "    @When(\"CxFlow parsing SAST results\")\n    public void getSastScanResults() {\n        String commandLine = String.format(COMMAND_LINE, CX_PROJECT_NAME);\n        tryRunCxFlow(commandLine);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 67,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing/CodeBashingLessonsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing",
      "filename": "CodeBashingLessonsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 825,
    "annotation": "\n\n    @And(\"CodeBashing tenant base url {}\")",
    "glue_code": "\n    @And(\"CodeBashing tenant base url {}\")",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 73,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing/CodeBashingLessonsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing",
      "filename": "CodeBashingLessonsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 826,
    "annotation": "\n    @Given(\"CxFlow uses Bug-Tracker type {}\")",
    "glue_code": "    @Given(\"CxFlow uses Bug-Tracker type {}\")\n    public void setBugTracker(String bugTrackerType) throws IOException {\n        flowProperties.setBugTracker(bugTrackerType);\n        if(bugTrackerType.equals(BugTracker.Type.JIRA.toString())){\n            initJiraBugTracker();\n        }\n        else{\n            initGitLabBugTracker();\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 88,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing/CodeBashingLessonsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing",
      "filename": "CodeBashingLessonsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 827,
    "annotation": "\n    @And(\"CxFlow finds a ticket with specific {} and {}\")",
    "glue_code": "    @And(\"CxFlow finds a ticket with specific {} and {}\")\n    public void getissueByCwe(String issueType, int cweId) {\n\n        if (flowProperties.getBugTracker().equals(BugTracker.Type.JIRA.toString())){\n            Issue issueToValidate;\n            Set<Issue> allIssues = jiraUtils.geAllIssuesInProject(JIRA_PROJECT);\n            issueToValidate = findJiraIssueByVulnerabilityTypeAndCwe(allIssues, issueType, \"*CWE:* \" + cweId);\n            issueDescription = issueToValidate.getDescription();\n        }\n        if (flowProperties.getBugTracker().equals(\"GitLab\")){\n            List<com.checkmarx.flow.dto.Issue> allIssues = gitLabTestUtils.getAllProjectIssues(GITLAB_PROJECT);\n            com.checkmarx.flow.dto.Issue issueToValidate = findGitLabIssueByVulnerabilityTypeAndCwe(allIssues, issueType, \"CWE:\" + cweId);\n            issueDescription = issueToValidate.getBody();\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 99,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing/CodeBashingLessonsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing",
      "filename": "CodeBashingLessonsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 828,
    "annotation": "\n    @Then(\"CxFlow should add the correct {} to the ticket\")",
    "glue_code": "    @Then(\"CxFlow should add the correct {} to the ticket\")\n    public void verifyLessonPathInTicket(String lessonPath) {\n        String expectedLessonPath;\n        if (lessonPath.equals(\"default\")){\n            expectedLessonPath = flowProperties.getCodebashUrl();\n        }\n        else{\n            expectedLessonPath= String.format(\"%s/%s\", TENANT_BASE_URL, lessonPath);\n        }\n        String actualLessonPath = getLessonPathFromTicket();\n\n        log.info(\"Comparing expected codebashing url: '{}' to actual '{}'\", expectedLessonPath, actualLessonPath);\n        Assert.assertEquals(expectedLessonPath, actualLessonPath);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 115,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing/CodeBashingLessonsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/codebashing",
      "filename": "CodeBashingLessonsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 829,
    "annotation": "\n    @Given(\"github repo contains a Checkmarx configuration\")",
    "glue_code": "    @Given(\"github repo contains a Checkmarx configuration\")\n    public void setSourceProviderType() {\n        sourceProviderType = SourceProviderType.GITHUB;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 34,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo/ConfigProviderRemoteRepoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo",
      "filename": "ConfigProviderRemoteRepoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 830,
    "annotation": "\n    @When(\"initializing config provider\")",
    "glue_code": "    @When(\"initializing config provider\")\n    public void initConfigProvider() throws ConfigurationException {\n        String nameSpace = \"cxflowtestuser\";\n        String repoName = \"configProviderTestRepo\";\n        String branchName = \"main\";\n\n        ConfigProvider configProvider = ConfigProvider.getInstance();\n        configProvider.init(uid, new RepoReader(gitHubProperties.getApiUrl(),\n                nameSpace, repoName, branchName,\n                gitHubProperties.getToken(), sourceProviderType));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 39,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo/ConfigProviderRemoteRepoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo",
      "filename": "ConfigProviderRemoteRepoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 831,
    "annotation": "\n    @And(\"getting {string} config provider configuration\")",
    "glue_code": "    @And(\"getting {string} config provider configuration\")\n    public void setVulnerabilityScanner(String scanner) {\n        ConfigProvider configProvider = ConfigProvider.getInstance();\n        switch (scanner) {\n            case ScaProperties.CONFIG_PREFIX:\n                scaConfiguration = configProvider.getConfiguration(uid, ScaProperties.CONFIG_PREFIX, ScaConfig.class);\n                break;\n            case AstProperties.CONFIG_PREFIX:\n                astConfiguration = configProvider.getConfiguration(uid, AstProperties.CONFIG_PREFIX, ASTConfig.class);\n                break;\n            default:\n                throw new MachinaRuntimeException(\"Scanner: \" + scanner + \" is not yet supported\");\n        }\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 51,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo/ConfigProviderRemoteRepoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo",
      "filename": "ConfigProviderRemoteRepoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 832,
    "annotation": "\n    @Then(\"{string} configuration on Cx-Flow side should match the remote repo configuration data\")",
    "glue_code": "    @Then(\"{string} configuration on Cx-Flow side should match the remote repo configuration data\")\n    public void validateScannerConfigurationProperties(String scanner) {\n        switch (scanner) {\n            case ScaProperties.CONFIG_PREFIX:\n                assertScaConfiguration();\n                break;\n            case AstProperties.CONFIG_PREFIX:\n                assertAstConfiguration();\n                break;\n            default:\n                throw new MachinaRuntimeException(\"Scanner: \" + scanner + \" is not yet supported\");\n        }\n\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 66,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo/ConfigProviderRemoteRepoSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/config_provider/remote_repo",
      "filename": "ConfigProviderRemoteRepoSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 833,
    "annotation": "\n    @Given(\"use-config-as-code-from-default-branch property in application.yml is set to {string}\")",
    "glue_code": "    @Given(\"use-config-as-code-from-default-branch property in application.yml is set to {string}\")\n    public void useConfigAsCodeFromDefaultBranch(String useDefaultBranch) {\n        boolean parsedPropValue = Boolean.parseBoolean(useDefaultBranch);\n        gitHubProperties.setUseConfigAsCodeFromDefaultBranch(parsedPropValue);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 44,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/ConfigAsCodeBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "ConfigAsCodeBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 834,
    "annotation": "\n    @And(\"GitHub repo default branch is {string}\")",
    "glue_code": "    @And(\"GitHub repo default branch is {string}\")\n    public void githubRepoDefaultBranchIs(String defaultBranch) {\n        this.defaultBranch = defaultBranch;\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 50,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/ConfigAsCodeBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "ConfigAsCodeBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 835,
    "annotation": "\n    @When(\"GitHub notifies CxFlow that a pull request was created for the {string} branch\")",
    "glue_code": "    @When(\"GitHub notifies CxFlow that a pull request was created for the {string} branch\")\n    public void githubNotifiesCxFlow(String srcBranch) {\n        log.info(\"Creating RestTemplate mock.\");\n        RestTemplate restTemplateMock = mock(RestTemplate.class);\n\n        //added mock for branch validation\n        when(restTemplateMock.exchange(\n                anyString(),                          // Match any URL\n                eq(HttpMethod.GET),                   // Match GET method\n                any(HttpEntity.class),                // Match any HttpEntity\n                eq(String.class),                     // Match response type\n                anyString(),                          // Match namespace\n                anyString(),                          // Match repoName\n                anyString()                           // Match branch\n        )).thenAnswer(invocation ->{\n            assertEquals(BRANCH_ARGUMENT_INDEX1 + 1, invocation.getArguments().length,\n                \"Unexpected argument count for the restTemplate call.\");\n            actualBranch = invocation.getArgument(BRANCH_ARGUMENT_INDEX1);\n            return new ResponseEntity<>(actualBranch, HttpStatus.OK);});\n\n        when(gettingFileFromRepo(restTemplateMock)).thenAnswer(this::interceptConfigAsCodeBranch);\n\n        PullEvent pullEvent = CxConfigSteps.createPullEventDto(srcBranch, defaultBranch, gitHubProperties);\n\n        GitHubController controllerSpy = getGitHubControllerSpy(restTemplateMock);\n        CxConfigSteps.sendPullRequest(pullEvent, controllerSpy, srcBranch);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 55,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/ConfigAsCodeBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "ConfigAsCodeBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 836,
    "annotation": "\n    @Then(\"CxFlow should get config-as-code from the {string} branch\")",
    "glue_code": "    @Then(\"CxFlow should get config-as-code from the {string} branch\")\n    public void cxflowShouldGetConfigAsCodeFromTheBranch(String expectedBranch) {\n        assertEquals(expectedBranch,\n                actualBranch,\n                \"CxFlow has tried to get config-as-code file from an incorrect branch.\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 110,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/ConfigAsCodeBranchSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "ConfigAsCodeBranchSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 837,
    "annotation": "\n    @Given(\"github branch is {string} and thresholds section is not set application.yml\")",
    "glue_code": "    @Given(\"github branch is {string} and thresholds section is not set application.yml\")\n    public void setBranchAndSendPullRequest(String branch) {\n        this.branch = branch;\n        PullEvent pullEvent = createPullEventDto(branch, null, gitHubProperties);\n        sendPullRequest(pullEvent, gitHubControllerSpy, branch);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 145,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 838,
    "annotation": "\n    @And(\"github branch is {string} with cx.config\")",
    "glue_code": "    @And(\"github branch is {string} with cx.config\")\n    public void setBranchAppSet(String branch) {\n        setBranchAndSendPullRequest(branch);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 152,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 839,
    "annotation": "\n    @Given(\"github branch is {string} with invalid cx.config\")",
    "glue_code": "    @Given(\"github branch is {string} with invalid cx.config\")\n    public void setBranchInvalid(String branch) {\n        //set filter from application.yml\n        setCurrentFilter(\"severity\");\n        setBranchAndSendPullRequest(branch);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 157,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 840,
    "annotation": "\n    @Given(\"application.xml contains high thresholds {string} medium thresholds {string} and low thresholds {string}\")",
    "glue_code": "    @Given(\"application.xml contains high thresholds {string} medium thresholds {string} and low thresholds {string}\")\n    public void thresholdForFindingsOfSeverityIs(String highCount, String mediumCount, String lowCount) {\n\n        flowProperties.setThresholds(new HashMap<>());\n        if (StringUtils.isEmptyOrNull(highCount) && StringUtils.isEmptyOrNull(mediumCount) && StringUtils.isEmptyOrNull(lowCount)) {\n            flowProperties.setThresholds(null);\n        } else {\n            if (!StringUtils.isEmptyOrNull(highCount)) {\n                flowProperties.getThresholds().put(FindingSeverity.HIGH, Integer.parseInt(highCount));\n            }\n            if (!StringUtils.isEmptyOrNull(mediumCount)) {\n                flowProperties.getThresholds().put(FindingSeverity.MEDIUM, Integer.parseInt(mediumCount));\n            }\n            if (!StringUtils.isEmptyOrNull(lowCount)) {\n                flowProperties.getThresholds().put(FindingSeverity.LOW, Integer.parseInt(lowCount));\n            }\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 216,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 841,
    "annotation": "\n\n    @Given(\"application.xml contains filters section with filter type {string}\")",
    "glue_code": "\n    @Given(\"application.xml contains filters section with filter type {string}\")",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 235,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 842,
    "annotation": "\n\n    @And(\"^(?:SAST detects )?(.*) findings of \\\"(.+)\\\" severity$\")",
    "glue_code": "\n    @And(\"^(?:SAST detects )?(.*) findings of \\\"(.+)\\\" severity$\")\n    public void sastDetectsFindings(int expectedFindingCount, String severity) {\n        addFindingsTo(scanResultsToInject, expectedFindingCount, severity);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 274,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 843,
    "annotation": "\n    @Then(\"CxFlow {string} the pull request\")",
    "glue_code": "    @Then(\"CxFlow {string} the pull request\")\n    public void cxflowApprovesOrFailsThePullRequest(String approvesOrFails) throws InterruptedException {\n\n        validateRequestByConfig(Boolean.FALSE);\n\n        processScanResultsInCxFlow();\n\n        boolean expectingApproval = approvesOrFails.equals(\"approves\");\n        verifyPullRequestState(expectingApproval);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 287,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 844,
    "annotation": "\n\n    @Then(\"CxFlow will return results as per the filter in cx.config\")",
    "glue_code": "\n    @Then(\"CxFlow will return results as per the filter in cx.config\")\n    public void validateFilter() {\n        validateRequestFilter();\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 298,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 845,
    "annotation": "\n    @Then(\"CxFlow will ignore the cxconfig and take all the values from application.yml\")",
    "glue_code": "    @Then(\"CxFlow will ignore the cxconfig and take all the values from application.yml\")\n    public void validateFilterFromApp() {\n        validateRequestFilter();\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 304,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 846,
    "annotation": "\n\n    @Then(\"CxFlow {string} the pull request and cx.config truncates the data in application.yml\")",
    "glue_code": "\n    @Then(\"CxFlow {string} the pull request and cx.config truncates the data in application.yml\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 398,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig/CxConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfig",
      "filename": "CxConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 847,
    "annotation": "\n\n    @Given(\"github branch is udi-tests\")",
    "glue_code": "\n    @Given(\"github branch is udi-tests\")\n    public void setBranchAndCreatePullReqeust(){\n        this.branch = BRANCH_NAME;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 152,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker/CxConfigBugTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker",
      "filename": "CxConfigBugTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 848,
    "annotation": "\n    @When(\"pull request webhook arrives\")",
    "glue_code": "    @When(\"pull request webhook arrives\")\n    public void sendPullRequestWebhookEvent() {\n        assertFlowPropertiesBugTracker(\"Json\");\n        ArgumentCaptor<ScanRequest> ac = ArgumentCaptor.forClass(ScanRequest.class);\n        FlowService flowServiceMock = Mockito.mock(FlowService.class);\n        gitHubControllerSpy = new GitHubController(gitHubProperties,flowProperties, jiraProperties, flowServiceMock,helperService, gitHubService,gitHubAppAuthService, filterFactory, configOverrider, scmConfigOverrider, gitAuthUrlGenerator);\n        gitHubControllerSpy = spy(gitHubControllerSpy);\n        initGitHubControllerSpy();\n        buildPullRequest();\n        verify(flowServiceMock, times(1)).initiateAutomation(ac.capture());\n        request = ac.getValue();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 158,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker/CxConfigBugTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker",
      "filename": "CxConfigBugTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 849,
    "annotation": "\n    @When(\"push event arrives\")",
    "glue_code": "    @When(\"push event arrives\")\n    public void sendPushEvent() {\n        assertFlowPropertiesBugTracker(\"Json\");\n        ArgumentCaptor<ScanRequest> ac = ArgumentCaptor.forClass(ScanRequest.class);\n        FlowService flowServiceMock = Mockito.mock(FlowService.class);\n        gitHubControllerSpy = new GitHubController(gitHubProperties,flowProperties, jiraProperties, flowServiceMock,helperService, gitHubService,gitHubAppAuthService, filterFactory, configOverrider, scmConfigOverrider, gitAuthUrlGenerator);\n        gitHubControllerSpy = spy(gitHubControllerSpy);\n        initGitHubControllerSpy();\n        buildPushRequest();\n        verify(flowServiceMock, times(1)).initiateAutomation(ac.capture());\n        request = ac.getValue();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 171,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker/CxConfigBugTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker",
      "filename": "CxConfigBugTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 850,
    "annotation": "\n    @Then(\"scan request should have GitHub bug tracker\")",
    "glue_code": "    @Then(\"scan request should have GitHub bug tracker\")\n    public void assertIssuesInGitHub() {\n        Assert.assertEquals(BugTracker.Type.CUSTOM, request.getBugTracker().getType());\n        Assert.assertEquals(CUSTOM_BEAN_NAME, request.getBugTracker().getCustomBean());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 188,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker/CxConfigBugTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker",
      "filename": "CxConfigBugTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 851,
    "annotation": "\n    @Then(\"scan request should have GITHUBPULL bug tracker\")",
    "glue_code": "    @Then(\"scan request should have GITHUBPULL bug tracker\")\n    public void assertBugtrackerType() {\n        Assert.assertEquals(BugTracker.Type.GITHUBPULL, request.getBugTracker().getType());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 194,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker/CxConfigBugTrackerSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxconfigbugtracker",
      "filename": "CxConfigBugTrackerSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 862,
    "annotation": "\n    @Given(\"SCM type is {}\")",
    "glue_code": "    @Given(\"SCM type is {}\")\n    public void setScmType(String scmType){\n        if(scmType.equals(\"Github\")) {\n            repoServiceMocker = new GithubServiceMocker();\n            repoServiceMocker.init(GITHUB_PROJECT_NAME, gitHubProperties, GITHUB_BRANCH, CXGO_PROJECT_NAME, CXGO_TEAM_NAME, restTemplate);\n            repoServiceMocker.initPullRequestDetails(PULL_REQUEST_ID, PR_COMMIT_HASH);\n            repoServiceMocker.setController(gitHubController);\n            repoService = gitHubService;\n        }\n        if(scmType.equals(\"Gitlab\")) {\n            repoServiceMocker = new GitlabServiceMocker();\n            repoServiceMocker.init(GITLAB_PROJECT_NAME, gitLabProperties, GITLAB_BRANCH, CXGO_PROJECT_NAME, CXGO_TEAM_NAME, restTemplate);\n            repoServiceMocker.setController(gitLabController);\n        }\n\n        deleteRepoPullRequestComments();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 122,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 863,
    "annotation": "\n    @And(\"Thresholds set to {}\")",
    "glue_code": "    @And(\"Thresholds set to {}\")\n    public void setThresholds(boolean thresholdsExceeded) {\n        flowProperties.setThresholds(new HashMap<>());\n        if(!thresholdsExceeded){\n            log.info(\"resetting thresholds to approve pull request\");\n            flowProperties.getThresholds().put(FindingSeverity.MEDIUM, 100);\n        }\n        else {\n            log.info(\"setting thresholds to reject pull request\");\n            flowProperties.getThresholds().put(FindingSeverity.MEDIUM, 1);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 140,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 864,
    "annotation": "\n    @And(\"Filters set to {}\")",
    "glue_code": "    @And(\"Filters set to {}\")\n    public void setFilters(String filters) {\n        // currently do nothing. Todo: add filters validation\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 153,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 865,
    "annotation": "\n    @And(\"Pull Request is opened in repo\")",
    "glue_code": "    @And(\"Pull Request is opened in repo\")\n    public void openPullRequest() {\n        repoServiceMocker.openPullRequest();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 158,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 866,
    "annotation": "\n    @And(\"Push event is sent to cxflow\")",
    "glue_code": "    @And(\"Push event is sent to cxflow\")\n    public void sendPushEvent() {\n        repoServiceMocker.sendPushEvent();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 163,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 867,
    "annotation": "\n    @Then(\"CxFlow initiate scan in CxGo\")",
    "glue_code": "    @Then(\"CxFlow initiate scan in CxGo\")\n    public void initCxGoScan() throws CheckmarxException {\n        String teamId = cxGoProperties.getTeam();\n        String ownerId = cxGoClient.getTeamId(teamId);\n        cxgoProjectId = cxGoClient.getProjectId(ownerId, CXGO_PROJECT_NAME);\n        oldScanId = cxGoClient.getLastScanId(cxgoProjectId);\n        log.info(\"checking for active scans in projectId '{}'\", cxgoProjectId);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 168,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 868,
    "annotation": "\n    @And(\"bugTracker will be updated with tickets for filtered findings by {}\")",
    "glue_code": "    @And(\"bugTracker will be updated with tickets for filtered findings by {}\")\n    public void validateBugTrackerTickets(String filters){\n        waitForOperationToComplete(this::scanFinished, MAX_TIME_FOR_SCAN_COMPLETED_IN_SEC);\n        waitForOperationToComplete(this::bugTrackerUpdateWithTickets, MAX_TIME_FOR_BUG_TRACKER_UPDATE_IN_SEC);\n\n        log.info(\"pulling all issues from bug tracker\");\n        Map<Filter.Severity, Integer> actualJira = jiraUtils.getIssuesPerSeverity(jiraProperties.getProject());\n\n        validateIssuesArePresent(actualJira, Filter.Severity.HIGH);\n        validateIssuesArePresent(actualJira, Filter.Severity.MEDIUM);\n        validateIssuesArePresent(actualJira, Filter.Severity.LOW);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 177,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 869,
    "annotation": "\n    @And(\"Pull request comments updated in repo and status is {}\")",
    "glue_code": "    @And(\"Pull request comments updated in repo and status is {}\")\n    public void validatePullRequestComment(String pullRequestStatus) {\n        waitForOperationToComplete(this::scanFinished, MAX_TIME_FOR_SCAN_COMPLETED_IN_SEC);\n        waitForOperationToComplete(this::pullRequestHas2CxFlowComments, MAX_TIME_FOR_PULL_REQUEST_UPDATE_IN_SEC);\n        waitForOperationToComplete(this::pullRequestNotPending, MAX_TIME_FOR_PULL_REQUEST_NOT_PENDING_IN_SEC);\n\n        String status = repoServiceMocker.getPullRequestStatus();\n\n        Assert.assertEquals(pullRequestStatus, status);\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 190,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo/CxGoRemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/cxgo",
      "filename": "CxGoRemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 852,
    "annotation": "\n    @And(\"CxFlow is running as a service\")",
    "glue_code": "    @And(\"CxFlow is running as a service\")\n    public void runAsService() {\n        log.info(\"running cx-flow as a service (active profile: {})\", engine);\n        appContext = TestUtils.runCxFlowAsServiceWithAdditionalProfiles(engine);\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 56,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 853,
    "annotation": "\n    @And(\"repository is {word}\")",
    "glue_code": "    @And(\"repository is {word}\")\n    public void setRepository(String repositoryName) {\n        this.repository = Repository.setTo(repositoryName, this);\n        readEnvironmentProperties();\n        repository.init(this);\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 62,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 854,
    "annotation": "\n    @And(\"bug-tracker is {word}\")",
    "glue_code": "    @And(\"bug-tracker is {word}\")\n    public void setBugTracker(String bugTracker) {\n        this.bugTracker = BugTracker.setTo(bugTracker, this);\n        FlowProperties flowProperties = (FlowProperties)appContext.getBean(\"flowProperties\");\n        flowProperties.setBugTracker(bugTracker);\n        log.info(\"Active scanners are: {}\", flowProperties.getEnabledVulnerabilityScanners().toString());\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 112,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 855,
    "annotation": "\n    @Given(\"Scan engine is {word}\")",
    "glue_code": "    @Given(\"Scan engine is {word}\")\n    public void setScanEngine(String engine) {\n        this.engine = engine;\n        log.info(\"setting scan engine to {}\" , engine);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 120,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 856,
    "annotation": "\n    @And(\"webhook is configured for push event\")",
    "glue_code": "    @And(\"webhook is configured for push event\")\n    public void generatePushWebHook() {\n        repository.setActiveBranch(BRANCH_MASTER);\n        repository.generateConfigAsCode(this);\n        repository.generateWebHook(HookType.PUSH);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 126,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 857,
    "annotation": "\n    @And(\"webhook is configured for pull-request\")",
    "glue_code": "    @And(\"webhook is configured for pull-request\")\n    public void generatePRWebHook() {\n        repository.setActiveBranch(BRANCH_DEVELOP);\n        repository.generateConfigAsCode(this);\n        pushChange();\n        repository.generateWebHook(HookType.PULL_REQUEST);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 133,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 858,
    "annotation": "\n    @When(\"pushing a change\")",
    "glue_code": "    @When(\"pushing a change\")\n    public void pushChange() {\n        String base64content = null;\n        String fileTextContent = null;\n        try {\n            base64content = readFileInBase64();\n            fileTextContent = readFile();\n        } catch (IOException e) {\n            fail(\"can not read source file\");\n        }\n        repository.pushFile(base64content, fileTextContent);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 141,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 859,
    "annotation": "\n    @When(\"creating pull-request\")",
    "glue_code": "    @When(\"creating pull-request\")\n    public void createPR() {\n        repository.createPR();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 154,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 860,
    "annotation": "\n    @Then(\"bug-tracker issues are updated\")",
    "glue_code": "    @Then(\"bug-tracker issues are updated\")\n    public void validateIssueOnBugTracker() {\n        String severities = \"(\" + flowProperties.getFilterSeverity().stream().collect(Collectors.joining(\",\")) + \")\";\n        bugTracker.verifyIssueCreated(severities, engine);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 159,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 861,
    "annotation": "\n    @Then(\"pull-request is updated\")",
    "glue_code": "    @Then(\"pull-request is updated\")\n    public void checkPRUpdate() {\n        repository.verifyPRUpdated(engine);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 165,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend/GenericEndToEndSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/end2end/genericendtoend",
      "filename": "GenericEndToEndSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 870,
    "annotation": "\n    @And(\"for a given issue, with a given vulnerabilities\")",
    "glue_code": "    @And(\"for a given issue, with a given vulnerabilities\")\n    public void setIssueVulnerabilities() throws IOException, ExitThrowable {\n        scanRequest = getBasicScanRequest();\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + INPUT_VUL));\n        List<Issue> openIssuesList = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n\n        Assert.assertFalse(\"Expected to find open issues, but found none\", openIssuesList.isEmpty());\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 43,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubCloseIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubCloseIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 871,
    "annotation": "\n    @When(\"resolving all vulnerabilities for an issue\")",
    "glue_code": "    @When(\"resolving all vulnerabilities for an issue\")\n    public void resolveIssueVulnerabilities() throws IOException, ExitThrowable {\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + INPUT_VUL_RESOLVED));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 52,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubCloseIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubCloseIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 872,
    "annotation": "\n    @Then(\"the issues should be mark as closed\")",
    "glue_code": "    @Then(\"the issues should be mark as closed\")\n    public void validateIssueIsClosed() {\n        List<Issue> openIssuesList = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n\n        Assert.assertTrue(\"Expected not to find open issues\", openIssuesList.isEmpty());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 57,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubCloseIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubCloseIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 877,
    "annotation": "\n    @Given(\"bug tracker is GitHub\")",
    "glue_code": "    @Given(\"bug tracker is GitHub\")\n    public void setTagetToGitHub() {\n        flowProperties.setBugTracker(\"GitHub\");\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 44,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesBySeverityFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesBySeverityFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 878,
    "annotation": "\n    @And(\"setting filter severity as {string}\")",
    "glue_code": "    @And(\"setting filter severity as {string}\")\n    public void setSeverityFilter(String severityFilter) {\n        severityFilters = createFiltersListFromString(severityFilter);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 49,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesBySeverityFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesBySeverityFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 879,
    "annotation": "\n    @When(\"publishing {string}\")",
    "glue_code": "    @When(\"publishing {string}\")\n    public void publishResults(String input) throws IOException, ExitThrowable {\n        scanRequest = getBasicScanRequest();\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + input));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 54,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesBySeverityFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesBySeverityFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 880,
    "annotation": "\n    @Then(\"{int} new issues should be opened according filters severity\")",
    "glue_code": "    @Then(\"{int} new issues should be opened according filters severity\")\n    public void validateOpenIssues(int expectedNumberOfIssues) {\n        List<Issue> actualOpenIssues = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n\n        Assert.assertEquals(\"Open issues in GitHub as defined by filter severity are not as expected.\",\n                expectedNumberOfIssues, actualOpenIssues.size());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 60,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesBySeverityFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesBySeverityFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 873,
    "annotation": "\n    @When(\"publishing results from {string}\")",
    "glue_code": "    @When(\"publishing results from {string}\")\n    public void publishResults(String input) throws IOException, ExitThrowable {\n        scanRequest = getBasicScanRequest();\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + input));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 40,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesFromDifferentFilesSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesFromDifferentFilesSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 874,
    "annotation": "\n    @Then(\"{int} new issues should be opened\")",
    "glue_code": "    @Then(\"{int} new issues should be opened\")\n    public void validateOpenIssues(int expectedNumberOfIssues) {\n        List<Issue> actualOpenIssues = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n\n        Assert.assertEquals(\"Open issues in GitHub as set with different files are not as expected.\",\n                expectedNumberOfIssues, actualOpenIssues.size());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 46,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubOpenIssuesFromDifferentFilesSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubOpenIssuesFromDifferentFilesSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 875,
    "annotation": "\n    @And(\"for a given type, there is an opened issue with multiple vulnerabilities\")",
    "glue_code": "    @And(\"for a given type, there is an opened issue with multiple vulnerabilities\")\n    public void setOpenIssueWithVulnerabilities() throws IOException, ExitThrowable {\n        scanRequest = getBasicScanRequest();\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + INPUT_VUL_BEFORE_FIX));\n\n        List<Issue> openIssues = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n        int issueLinesCount = gitHubTestUtils.getIssueLinesCount(openIssues.get(0));\n\n        Assert.assertEquals(\"Expected issue's code lines before fix aren't as expected\",\n                2, issueLinesCount);\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 44,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubResolveIssueVulnerabilitiesSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubResolveIssueVulnerabilitiesSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 876,
    "annotation": "\n    @When(\"resolving a vulnerability\")",
    "glue_code": "    @When(\"resolving a vulnerability\")\n    public void resolveIssue() throws IOException, ExitThrowable {\n        sastScanner.cxParseResults(scanRequest, getFileFromResourcePath(INPUT_BASE_PATH + INPUT_VUL_AFTER_FIX));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 56,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/github/GitHubResolveIssueVulnerabilitiesSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/github",
      "filename": "GitHubResolveIssueVulnerabilitiesSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 883,
    "annotation": "\n    @Given(\"bug tracker is Jira\")",
    "glue_code": "    @Given(\"bug tracker is Jira\")\n    public void setTargetToJira() {\n        bugTracker = getBasicBugTrackerToJira();\n        flowProperties.setBugTracker(bugTracker.getType().name());\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 43,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics/JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics",
      "filename": "JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 884,
    "annotation": "\n    @When(\"opening a new Jira issue via the command line\")",
    "glue_code": "    @When(\"opening a new Jira issue via the command line\")\n    public void openNewIssueViaCommandLine() throws IOException, ExitThrowable {\n        sastScanner.cxParseResults(getBasicScanRequest(), getFileFromResourcePath(FINDING_PATH));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 49,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics/JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics",
      "filename": "JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 885,
    "annotation": "\n    @Then(\"a matching ticket creation data should be recorded in the analytics json file\")",
    "glue_code": "    @Then(\"a matching ticket creation data should be recorded in the analytics json file\")\n    public void validateAnalyticsJsonFile() throws CheckmarxException {\n        List<String> currentNewIssuesList = jiraService.getCurrentNewIssuesList();\n        JiraTicketsReport jiraTicketsReport = (JiraTicketsReport) jsonLoggerTestUtils.getReportNode(JiraTicketsReport.OPERATION, JiraTicketsReport.class);\n        HashMap<String, List<String>> jiraTickets = jiraTicketsReport.getJiraTickets();\n\n        int totalNewTickets = jiraTickets.get(JIRA_NEW_STATE).size();\n        Assert.assertEquals(\"Expected to find 1 new JIRA opened ticket record on analytics logs , but found different count: \" + totalNewTickets, 1, totalNewTickets);\n        Assert.assertEquals(\"Actual JIRA new ticket's project key on analytics logs is different from expected\",\n                jiraService.getCurrentNewIssuesList(), jiraTickets.get(JIRA_NEW_STATE));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 54,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics/JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics",
      "filename": "JiraAnalyticsOpenIssueViaCommandLineSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 881,
    "annotation": "\n    @When(\"updating a new Jira issue via the command line\")",
    "glue_code": "    @When(\"updating a new Jira issue via the command line\")\n    public void closeNewIssueViaCommandLine() throws IOException, ExitThrowable {\n        sastScanner.cxParseResults(getBasicScanRequest(), getFileFromResourcePath(CLOSE_FINDING_PATH));\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 42,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics/JiraAnalyticsUpdateIssueViaCommandLineSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics",
      "filename": "JiraAnalyticsUpdateIssueViaCommandLineSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 882,
    "annotation": "\n    @Then(\"a matching ticket updating data should be recorded in the analytics json file\")",
    "glue_code": "    @Then(\"a matching ticket updating data should be recorded in the analytics json file\")\n    public void validateAnalyticsJsonFile() throws CheckmarxException {\n        JiraTicketsReport jiraTicketsReport = (JiraTicketsReport) jsonLoggerTestUtils.getReportNode(JiraTicketsReport.OPERATION, JiraTicketsReport.class);\n        HashMap<String, List<String>> jiraTickets = jiraTicketsReport.getJiraTickets();\n\n        int totalUpdatedTickets = jiraTickets.get(JIRA_UPDATED_STATE).size();\n        int totalClosedTickets = jiraTickets.get(JIRA_CLOSED_STATE).size();\n\n        Assert.assertEquals(\"Expected to find 1 new JIRA updated ticket record on analytics logs , but found different count: \" + totalUpdatedTickets, 1, totalUpdatedTickets);\n        Assert.assertEquals(\"Actual JIRA updated ticket's project key on analytics logs is different from expected\",\n                jiraService.getCurrentUpdatedIssuesList(), jiraTickets.get(JIRA_UPDATED_STATE));\n\n        Assert.assertEquals(\"Expected to find 1 new JIRA closed ticket record on analytics logs , but found different count: \" + totalClosedTickets, 1, totalClosedTickets);\n        Assert.assertEquals(\"Actual JIRA closed ticket's project key on analytics logs is different from expected\",\n                jiraService.getCurrentClosedIssuesList(), jiraTickets.get(JIRA_CLOSED_STATE));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 47,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics/JiraAnalyticsUpdateIssueViaCommandLineSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/analytics",
      "filename": "JiraAnalyticsUpdateIssueViaCommandLineSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 886,
    "annotation": "\n    @Then(\"we should have open and closed statuses in jira properties bean\")",
    "glue_code": "    @Then(\"we should have open and closed statuses in jira properties bean\")\n    public void verifyJiraClosedAndOpenStatus() {\n        List<String> closedStatus = jiraProperties.getClosedStatus();\n        Assert.assertNotNull(closedStatus);\n        Assert.assertFalse(closedStatus.isEmpty());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 21,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/autoconfig/JiraAutoConfigTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/autoconfig",
      "filename": "JiraAutoConfigTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 892,
    "annotation": "\n\n    @Given(\"SAST results with that should result in {int} JIRS issues\")",
    "glue_code": "\n    @Given(\"SAST results with that should result in {int} JIRS issues\")",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 67,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load/JiraLoadTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load",
      "filename": "JiraLoadTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 893,
    "annotation": "\n    @When(\"results are parsed and published {int} times, and time is recorded for each sample\")",
    "glue_code": "    @When(\"results are parsed and published {int} times, and time is recorded for each sample\")\n    public void publishResults(int numOfSamples) throws ExitThrowable, IOException {\n        for (int i = 0; i < numOfSamples; i++) {\n            internalPublishResults();\n            verifyNumberOfIssues();\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 74,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load/JiraLoadTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load",
      "filename": "JiraLoadTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 894,
    "annotation": "\n    @Then(\"{int} percents of publish request should take less than {int} seconds\")",
    "glue_code": "    @Then(\"{int} percents of publish request should take less than {int} seconds\")\n    public void validateDurations(int percentsThreshold, int durationThresholdSeconds) {\n        // translate to millis\n        log.info(\"Durations: \");\n        durations.stream().forEach(l -> log.info(l + \", \"));\n        validateDuration(durations, percentsThreshold, durationThresholdSeconds, \"Primary validation failed.\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 82,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load/JiraLoadTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load",
      "filename": "JiraLoadTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 895,
    "annotation": "\n    @Then(\"the other tests should take less than {int} seconds\")",
    "glue_code": "    @Then(\"the other tests should take less than {int} seconds\")\n    public void validateSecondaryDurations(int durationThresholdSeconds) {\n        List<Long> failedDurations = durations.stream().filter(l -> l > (durationThresholdSeconds * 1000)).collect(Collectors.toList());\n        Assert.assertTrue(\"Secondary duration validation failed.\", failedDurations.size() == 0);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 90,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load/JiraLoadTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/load",
      "filename": "JiraLoadTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 887,
    "annotation": "\n\n    @Given(\"There are values for jira closed and open statuses in yml\")",
    "glue_code": "\n    @Given(\"There are values for jira closed and open statuses in yml\")\n    public void dummy() {\n\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 19,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/manualconfig/JiraManualConfigTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/manualconfig",
      "filename": "JiraManualConfigTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 888,
    "annotation": "\n    @Then(\"we should use te values from yml\")",
    "glue_code": "    @Then(\"we should use te values from yml\")\n    public void verifyOpenAndClosedStatuses() {\n        Assert.assertNotNull(\"Did not load closed statuses from YML (null)\",jiraProperties.getClosedStatus());\n        Assert.assertNotNull(\"Did not load open statuses from YML\",jiraProperties.getOpenStatus());\n        Assert.assertTrue(\"Did not load closed statuses from YML (empty list)\",jiraProperties.getClosedStatus().size() > 0);\n        Assert.assertTrue(\"Did not load open statuses from YML (empty list)\",jiraProperties.getOpenStatus().size() > 0);\n        for (String status: jiraProperties.getOpenStatus()) {\n            Assert.assertTrue(status.contains(\"TEST-OPEN\"));\n        }\n        for (String status: jiraProperties.getClosedStatus()) {\n            Assert.assertTrue(status.contains(\"TEST-CLOSED\"));\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 25,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/manualconfig/JiraManualConfigTestSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/jira/manualconfig",
      "filename": "JiraManualConfigTestSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 896,
    "annotation": "\n    @Given(\"bug tracker is GitHub\")",
    "glue_code": "    @Given(\"bug tracker is GitHub\")\n    public void setBugTracker() {\n        bugTracker = getBasicBugTrackerToJira();\n        flowProperties.setBugTracker(bugTracker.getType().name());\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 66,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances/PublishTicketsWithOptionalScmConfSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances",
      "filename": "PublishTicketsWithOptionalScmConfSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 897,
    "annotation": "\n    @And(\"GitHub optional instance configuration is defined\")",
    "glue_code": "    @And(\"GitHub optional instance configuration is defined\")\n    public void defineOptionalScmInstance() {\n        setGitHubProperties();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 72,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances/PublishTicketsWithOptionalScmConfSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances",
      "filename": "PublishTicketsWithOptionalScmConfSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 898,
    "annotation": "\n    @When(\"processing the results\")",
    "glue_code": "    @When(\"processing the results\")\n    public void resultsProcessing() throws IOException, MachinaException {\n        scanRequest = getBasicScanRequest();\n        ScanResults scanResults = JsonUtils.json2Object(TestUtils.getFileFromRelativeResourcePath(INPUT_BASE_PATH + INPUT_FILE), ScanResults.class);\n        resultsService.processResults(scanRequest, scanResults, null);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 77,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances/PublishTicketsWithOptionalScmConfSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances",
      "filename": "PublishTicketsWithOptionalScmConfSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 899,
    "annotation": "\n    @Then(\"new GitHub Issues should be open respectively\")",
    "glue_code": "    @Then(\"new GitHub Issues should be open respectively\")\n    public void validateGitHubIssues() {\n        List<Issue> actualOpenIssues = gitHubTestUtils.filterIssuesByState(gitHubTestUtils.getIssues(scanRequest), \"open\");\n\n        Assert.assertEquals(\"Expected GitHub issues for optional SCM instance are not as expected\",\n                3, actualOpenIssues.size());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 84,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances/PublishTicketsWithOptionalScmConfSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/multiScmInstances",
      "filename": "PublishTicketsWithOptionalScmConfSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 889,
    "annotation": "\n\n    @And(\"Cx-Flow is configured with invalid project key\")",
    "glue_code": "\n    @And(\"Cx-Flow is configured with invalid project key\")\n    public void setInvalidProjectKey() {\n        jiraProperties.setUrl(JIRA_URL);\n        jiraService.init();\n\n        bugTracker = getBasicBugTrackerToJira();\n        flowProperties.setBugTracker(bugTracker.getType().name());\n        bugTracker.setProjectKey(INVALID_PROJECT_KEY);\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 56,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraPublishInvalidResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraPublishInvalidResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 890,
    "annotation": "\n    @When(\"preparing results to deliver\")",
    "glue_code": "    @When(\"preparing results to deliver\")\n    public void prepareResultsToDeliver() {\n        basicScanRequest = getBasicScanRequest();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 67,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraPublishInvalidResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraPublishInvalidResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 891,
    "annotation": "\n    @Then(\"the call execution should throw a JiraClientRunTimeException since an error occurred when published new tickets\")",
    "glue_code": "    @Then(\"the call execution should throw a JiraClientRunTimeException since an error occurred when published new tickets\")\n    public void verifyExceptionWhenPublishInvalidResults() {\n        Assertions.assertThrows(JiraClientRunTimeException.class,\n                () -> sastScanner.cxParseResults(basicScanRequest, getFileFromResourcePath()),\n                \"Expected to get Jira un-published tickets exception error\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 72,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraPublishInvalidResultsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraPublishInvalidResultsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 900,
    "annotation": "\n    @Given(\"target is JIRA\")",
    "glue_code": "    @Given(\"target is JIRA\")\n    public void setTargetToJira() {\n        bugTracker = getBasicBugTrackerToJira();\n        flowProperties.setBugTracker(bugTracker.getType().name());\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 56,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraUnreachableSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraUnreachableSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 901,
    "annotation": "\n    @And(\"JIRA is configured with invalid URL\")",
    "glue_code": "    @And(\"JIRA is configured with invalid URL\")\n    public void setUrlToInvalid() {\n        jiraProperties.setUrl(INVALID_URL);\n        jiraProperties.setDeployType(\"Cloud\");\n        jiraProperties.setVersion(\"10.00.01\");\n        jiraService.init();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 62,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraUnreachableSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraUnreachableSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 902,
    "annotation": "\n    @When(\"preparing a getIssues call to deliver\")",
    "glue_code": "    @When(\"preparing a getIssues call to deliver\")\n    public void preparingScanRequest() {\n        basicScanRequest = getBasicScanRequest();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 70,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraUnreachableSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraUnreachableSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 903,
    "annotation": "\n    @Then(\"the call execution should throw a JiraClientRunTimeException since JIRA is un-accessible\")",
    "glue_code": "    @Then(\"the call execution should throw a JiraClientRunTimeException since JIRA is un-accessible\")\n    public void verifyExceptionWhenJiraIsUnreachable() {\n        Assertions.assertThrows(JiraClientRunTimeException.class,\n                () -> sastScanner.cxParseResults(basicScanRequest, getFileFromResourcePath()),\n                \"Expected to get Jira un-accessible exception error\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 75,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests/JiraUnreachableSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/negative_tests",
      "filename": "JiraUnreachableSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 904,
    "annotation": "\n    @Given(\"target is JIRA\")",
    "glue_code": "    @Given(\"target is JIRA\")\n    public void setTargetTypeToJira() {\n        bugTracker = BugTracker.Type.JIRA;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 102,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 905,
    "annotation": "\n    @Given(\"there are {int} findings from which {int} results match the filter\")",
    "glue_code": "    @Given(\"there are {int} findings from which {int} results match the filter\")\n    public void setResultsAndFilters(int totalResults, int matchingResults) {\n        findingsType = FindingsType.DIFFERENT_SEVERITIES;\n        numOfFindings = matchingResults;\n        this.totalResults = totalResults;\n        needFilter = true;\n        Filter filter = Filter.builder().type(Filter.Type.SEVERITY).value(\"High\").build();\n        filters = Collections.singletonList(filter);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 107,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 906,
    "annotation": "\n    @Given(\"filter-severity is {}\")",
    "glue_code": "    @Given(\"filter-severity is {}\")\n    public void setSeverityFilterTypes(String types) {\n        filters = createFiltersFromString(types, Filter.Type.SEVERITY);\n        needFilter = true;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 117,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 907,
    "annotation": "\n    @Given(\"using sanity findings\")",
    "glue_code": "    @Given(\"using sanity findings\")\n    public void setUseSanityFindingsFile() {\n        useSanityFindingsFile = true;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 123,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 908,
    "annotation": "\n    @Given(\"there is an existing issue\")",
    "glue_code": "    @Given(\"there is an existing issue\")\n    public void createExistingIssueForUpdate() throws IOException, ExitThrowable, InterruptedException {\n        ScanRequest request = getScanRequestWithDefaults();\n        File file = getFileFromResourcePath(\"cucumber/data/sample-sast-results/1-finding-create-for-update.xml\");\n        innerPublishRequest(request, file);\n        updateTime = jiraUtils.getIssueUpdatedTime(jiraProperties.getProject());\n        issueId = jiraUtils.getFirstIssueId(jiraProperties.getProject());\n        issueUpdateVulnerabilityType = jiraUtils.getIssueVulnerability(jiraProperties.getProject());\n        issueUpdateFilename = jiraUtils.getIssueFilename(jiraProperties.getProject());\n        Assert.assertTrue(\"Issue priority before update is incorrect\",assertIssuePriority(ISSUE_PRIORITY_BEFORE_UPDATE));\n        TimeUnit.SECONDS.sleep(2);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 128,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 909,
    "annotation": "\n    @Given(\"SAST results contain 1 finding, with the same vulnerability type and filename\")",
    "glue_code": "    @Given(\"SAST results contain 1 finding, with the same vulnerability type and filename\")\n    public void setFilenameForUpdate() {\n        updating = true;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 141,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 910,
    "annotation": "\n    @When(\"publishing same issue with different parameters\")",
    "glue_code": "    @When(\"publishing same issue with different parameters\")\n    public void publishIssueForUpdate() throws IOException, ExitThrowable, InterruptedException {\n        TimeUnit.SECONDS.sleep(2);\n        ScanRequest request = getScanRequestWithDefaults();\n        File file = getFileFromResourcePath(\"cucumber/data/sample-sast-results/1-finding-updated.xml\");\n        innerPublishRequest(request, file);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 146,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 911,
    "annotation": "\n\n    @When(\"publishing results to JIRA\")",
    "glue_code": "\n    @When(\"publishing results to JIRA\")\n    public void publishResults() throws ExitThrowable, IOException {\n        ScanRequest request = getScanRequestWithDefaults();\n        if (needFilter) {\n            request.setFilter(FilterConfiguration.fromSimpleFilters(filters));\n        }\n        File file = getFileForPublish();\n        innerPublishRequest(request, file);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 164,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 912,
    "annotation": "\n    @When(\"results contain {} findings each having a different vulnerability type in one source file\")",
    "glue_code": "    @When(\"results contain {} findings each having a different vulnerability type in one source file\")\n    public void setNumberOfFindingsForTest(int numOfFindings) {\n        this.numOfFindings = numOfFindings;\n        findingsType = FindingsType.DIFFERENT_TYPE;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 179,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 913,
    "annotation": "\n    @When(\"results contains {int} findings with the same type in one source file\")",
    "glue_code": "    @When(\"results contains {int} findings with the same type in one source file\")\n    public void getFindingsFileWithSameTypeVulnerabilities(int findings) {\n        numOfFindings = findings;\n        findingsType = FindingsType.SAME_TYPE;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 185,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 914,
    "annotation": "\n\n    @When(\"there are two existing issues\")",
    "glue_code": "\n    @When(\"there are two existing issues\")\n    public void publishTwoIssues() throws IOException, ExitThrowable {\n        ScanRequest request = getScanRequestWithDefaults();\n        File findingsFile = getFileFromResourcePath(\"cucumber/data/sample-sast-results/2-findings-different-vuln-type-different-files.xml\");\n        innerPublishRequest(request, findingsFile);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 198,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 915,
    "annotation": "\n    @When(\"SAST result contains only one of the findings\")",
    "glue_code": "    @When(\"SAST result contains only one of the findings\")\n    public void setFileToOneFindingForClose() {\n        useOneFindingForUpdateClose= true;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 206,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 916,
    "annotation": "\n    @Then(\"issue has the same vulnerability type and filename\")",
    "glue_code": "    @Then(\"issue has the same vulnerability type and filename\")\n    public void assertVulnerabilityAndFilename() {\n        assertSameFilename();\n        assertSameVulnerability();\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 211,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 917,
    "annotation": "\n    @Then(\"JIRA still contains 1 issue\")",
    "glue_code": "    @Then(\"JIRA still contains 1 issue\")\n    public void validateJirahasOneIssue() {\n        Assert.assertEquals(\"JIRA should contain exactly one issue\", 1, jiraUtils.getNumberOfIssuesInProject(jiraProperties.getProject()));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 227,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 918,
    "annotation": "\n    @And(\"there is status change in the issue\")",
    "glue_code": "    @And(\"there is status change in the issue\")\n    public void statusChange(){}",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 243,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 919,
    "annotation": "    \n    @And(\"the updated issue has the new status field in the body\")",
    "glue_code": "    @And(\"the updated issue has the new status field in the body\")\n    public void validateUpdatedIssueVulnerabilityStatus(){\n        String vulStatus = jiraUtils.getIssueVulnerabilityStatus(jiraProperties.getProject());\n        \n        Assert.assertTrue( vulStatus.contains(\"URGENT\"));\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 246,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 920,
    "annotation": "\n    @And(\"the updated issue has a recommended fix link\")",
    "glue_code": "    @And(\"the updated issue has a recommended fix link\")\n    public void validateIssueContainsRecommendedFixLink() {\n        String issueRecommendedFixLink = jiraUtils.getIssueRecommendedFixLink(jiraProperties.getProject());\n\n        Assert.assertTrue(issueRecommendedFixLink.contains(\"Recommended Fix\"));\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 253,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 921,
    "annotation": "\n    @Then(\"the issue should be closed\")",
    "glue_code": "    @Then(\"the issue should be closed\")\n    public void assertIssueIsClosed() {\n        Assert.assertTrue(\"Issue is not in closed status\", jiraProperties.getClosedStatus().contains(jiraUtils.getIssueStatus(jiraProperties.getProject())));\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 260,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 922,
    "annotation": "\n    @Then(\"verify results contains {int}, {int}, {int}, {int} for severities {}\")",
    "glue_code": "    @Then(\"verify results contains {int}, {int}, {int}, {int} for severities {}\")\n    public void verifyNumOfIssuesForSeverities(int high, int medium, int low, int info, String severities) {\n        List<Filter> filters = createFiltersFromString(severities, Filter.Type.SEVERITY);\n        Map<Filter.Severity, Integer> actualJira = jiraUtils.getIssuesPerSeverity(jiraProperties.getProject());\n        for (Filter filter: filters) {\n            Filter.Severity severity = Filter.Severity.valueOf(filter.getValue().toUpperCase());\n            switch (severity) {\n                case HIGH:\n                    Assert.assertEquals(\"HIGH issues does not match\", (int) actualJira.get(Filter.Severity.HIGH), high);\n                    break;\n                case MEDIUM:\n                    Assert.assertEquals(\"Medium issues does not match\", (int) actualJira.get(Filter.Severity.MEDIUM), medium);\n                    break;\n                case LOW:\n                    Assert.assertEquals(\"Medium issues does not match\", (int) actualJira.get(Filter.Severity.LOW), low);\n                    break;\n                case INFO:\n                    Assert.assertEquals(\"Medium issues does not match\", (int) actualJira.get(Filter.Severity.INFO), info);\n                    break;\n            }\n        }\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 271,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 923,
    "annotation": "\n\n    @Then(\"there should be one closed and one open issue\")",
    "glue_code": "\n    @Then(\"there should be one closed and one open issue\")\n    public void assertOneClosedAndOneOpenIssue() {\n        Map<String, Integer> issuesPerStatus = jiraUtils.getIssuesByStatus(jiraProperties.getProject());\n        int closed = getClosedIssues(issuesPerStatus);\n        int open  = getOpenIssues(issuesPerStatus);\n        Assert.assertEquals(\"Closed issues number is incorrect\", 1, closed);\n        Assert.assertEquals(\"Open issues number is incorrect\", 1, open);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 294,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 924,
    "annotation": "\n\n    @Then(\"verify {int} new issues got created\")",
    "glue_code": "\n    @Then(\"verify {int} new issues got created\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 323,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 925,
    "annotation": "\n\n    @Then(\"verify {int} findings in body\")",
    "glue_code": "\n    @Then(\"verify {int} findings in body\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 330,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 926,
    "annotation": "\n    @And(\"issue status will be present in the body\")",
    "glue_code": "    @And(\"issue status will be present in the body\")\n    public void verifyIssueStatus() {\n\n        int actualFindings = jiraUtils.getFirstIssueNumOfFindings(jiraProperties.getProject());\n        if(actualFindings > 0) {\n            String vulStatus = jiraUtils.getIssueVulnerabilityStatus(jiraProperties.getProject());\n            Assert.assertNotEquals(null, vulStatus);\n            Assert.assertTrue(vulStatus.contains(\"TO VERIFY\"));\n        }\n        \n     }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 337,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess/RunPublishProcessSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/publishprocess",
      "filename": "RunPublishProcessSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 927,
    "annotation": "\n    @Given(\"different filters configuration is set\")",
    "glue_code": "    @Given(\"different filters configuration is set\")\n    public void setConfigAsCodeFilters() {\n        /*\n        This is required to test 'comment updated' flow\n        However mockito mockers are initialized in the beginning of the test, including the answerer and all the fields and properties inside for example (sastFile, filterConfiguration)\n        Using ScanResultsAnswerer::switchFilterConfiguration to change filter configuration in the between steps in same test scenario\n         */\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 175,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 928,
    "annotation": "\n    @And(\"no comments on pull request\")",
    "glue_code": "    @And(\"no comments on pull request\")\n    public void deletePRComments() throws IOException {\n        if (sourceControl.equals(SourceControlType.GITHUB)) {\n            deleteGitHubComments();\n        } else if (sourceControl.equals(SourceControlType.ADO)) {\n            deleteADOComments();\n        }  else if (sourceControl.equals(SourceControlType.GITLAB)) {\n            deleteGitLabComments();\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 184,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 929,
    "annotation": "\n    @Given(\"scanner is set to {string}\")",
    "glue_code": "    @Given(\"scanner is set to {string}\")\n    public void setScanner(String scanner) {\n        if (\"sast\".equals(scanner)) {\n            scannerType = ScannerType.SAST;\n            flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(\"sast\"));\n        } else if (\"sca\".equals(scanner)) {\n            scannerType = ScannerType.SCA;\n            flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(\"sca\"));\n        } else if (\"both\".equals(scanner)) {\n            scannerType = ScannerType.BOTH;\n            flowProperties.setEnabledVulnerabilityScanners(Arrays.asList(\"sca\", \"sast\"));\n        }\n        else {\n            throw new IllegalArgumentException(\"Wrong scanner type: \" + scanner);\n        }\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 215,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 930,
    "annotation": "\n    @Given(\"source control is GitHub\")",
    "glue_code": "    @Given(\"source control is GitHub\")\n    public void scGitHub() {\n        sourceControl = SourceControlType.GITHUB;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 232,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 931,
    "annotation": "\n    @Given(\"source control is ADO\")",
    "glue_code": "    @Given(\"source control is ADO\")\n    public void scAdo() {\n        sourceControl = SourceControlType.ADO;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 237,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 932,
    "annotation": "\n    @Given(\"source control is Gitlab\")",
    "glue_code": "    @Given(\"source control is Gitlab\")\n    public void sourceControlIsGitlab() {\n        sourceControl = SourceControlType.GITLAB;\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 242,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 933,
    "annotation": "\n    @When(\"pull request arrives to CxFlow\")",
    "glue_code": "    @When(\"pull request arrives to CxFlow\")\n    public void sendPullRequest() {\n        if (sourceControl.equals(SourceControlType.GITHUB)) {\n            buildGitHubPullRequest();\n        } else if (sourceControl.equals(SourceControlType.ADO)) {\n            buildADOPullRequestEvent();\n        } else if (sourceControl.equals(SourceControlType.GITLAB)) {\n            buildGitlabPullRequestEvent();\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 280,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 934,
    "annotation": "\n    @Then(\"Wait for comments\")",
    "glue_code": "    @Then(\"Wait for comments\")\n    public void waitForNewComments() {\n        log.info(\"waiting for new comments. scanner type {}\", scannerType);\n        int minutesToWait = scannerType == ScannerType.BOTH ? 10 : 8;\n        Awaitility.await()\n                .atMost(Duration.ofMinutes(minutesToWait))\n                .pollInterval(Duration.ofSeconds(COMMENTS_POLL_INTERVAL))\n                .until(this::areThereCommentsAtAll);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 291,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 935,
    "annotation": "\n    @Then(\"verify new comments\")",
    "glue_code": "    @Then(\"verify new comments\")\n    public void verifyNewComments() throws IOException {\n        log.info(\"verifying comments. scanner type: {} source control type: {}\", scannerType, sourceControl);\n\n        int expectedNumOfComments = getExpectedNumOfNewComments();\n        List<RepoComment> comments = getRepoComments();\n        Assert.assertEquals(\"Wrong number of comments\", expectedNumOfComments, comments.size());\n        comments.forEach(c -> Assert.assertTrue(\"Comment is not new (probably updated)\", isCommentNew(c)));\n\n        log.info(\"Found the correct comments in pull request !!\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 301,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 936,
    "annotation": "\n    @Then(\"Wait for updated comment\")",
    "glue_code": "    @Then(\"Wait for updated comment\")\n    public void waitForUpdatedComment() {\n        Awaitility.await()\n                .pollInterval(Duration.ofSeconds(COMMENTS_POLL_INTERVAL))\n                .atMost(Duration.ofSeconds(125))\n                .until(this::isThereUpdatedComment);\n\n        log.info(\"Found the correct comments in pull request !!\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 323,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments/UpdatePullRequestCommentsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/pullrequest/updatecomments",
      "filename": "UpdatePullRequestCommentsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 937,
    "annotation": "\n    @Given(\"{string} project exists in SAST\")",
    "glue_code": "    @Given(\"{string} project exists in SAST\")\n    public void projectExistsInSAST(String projectName) throws CheckmarxException {\n        this.projectId = ensureProjectExists(projectName);\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 86,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 938,
    "annotation": "\n    @And(\"all of {string}, {string}, {string}, {string} exist in SAST\")",
    "glue_code": "    @And(\"all of {string}, {string}, {string}, {string} exist in SAST\")\n    public void allOfExistInSAST(String initialPreset, String initialConfig, String globalPreset, String globalConfig) throws CheckmarxException {\n        Integer initialPresetId = cxClientSpy.getPresetId(initialPreset);\n        Integer globalPresetId = cxClientSpy.getPresetId(globalPreset);\n        Integer initialConfigId = cxClientSpy.getScanConfiguration(initialConfig);\n        Integer globalConfigId = cxClientSpy.getScanConfiguration(globalConfig);\n\n        List<Integer> ids = Arrays.asList(initialPresetId, globalPresetId, initialConfigId, globalConfigId);\n        boolean allEntitiesExist = ids.stream().allMatch(id -> id > 0);\n\n        assertTrue(allEntitiesExist, () -> String.format(\"Some of the entities don't exist in SAST: %s.\", ids));\n\n        presetMapping.put(initialPreset, initialPresetId);\n        presetMapping.put(globalPreset, globalPresetId);\n\n        configMapping.put(initialConfig, initialConfigId);\n        configMapping.put(globalConfig, globalConfigId);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 91,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 939,
    "annotation": "\n    @And(\"project has the {string} preset and the {string} scan configuration\")",
    "glue_code": "    @And(\"project has the {string} preset and the {string} scan configuration\")\n    public void projectPresetIs(String preset, String config) {\n        cxClientSpy.createScanSetting(projectId, presetMapping.get(preset), configMapping.get(config), 0);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 110,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 940,
    "annotation": "\n    @And(\"CxFlow config has the {string} preset and the {string} scan configuration\")",
    "glue_code": "    @And(\"CxFlow config has the {string} preset and the {string} scan configuration\")\n    public void sastConfigurationIsSetToInCxFlowConfig(String globalPreset, String globalConfig) {\n        cxProperties.setScanPreset(globalPreset);\n        cxProperties.setConfiguration(globalConfig);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 115,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 941,
    "annotation": "\n    @And(\"GitHub repository does not contain a config-as-code file\")",
    "glue_code": "    @And(\"GitHub repository does not contain a config-as-code file\")\n    public void githubRepositoryDoesNotContainAConfigAsCodeFile() {\n        gitHubProperties.setConfigAsCode(null);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 121,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 942,
    "annotation": "\n    @When(\"GitHub notifies CxFlow about a pull request for the {string} project\")",
    "glue_code": "    @When(\"GitHub notifies CxFlow about a pull request for the {string} project\")\n    public void githubNotifiesCxFlowAboutAPullRequest(String projectName) {\n\n        GitHubController gitHubController = new GitHubController(gitHubProperties, flowProperties,\n                null, flowService, helperService, gitHubService,gitHubAppAuthService, filterFactory, configOverrider,\n                scmConfigOverrider, gitAuthUrlGenerator);\n\n        gitHubTestUtils.callController(gitHubController, GitHubTestUtils.EventType.PULL_REQUEST, projectName);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 126,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 943,
    "annotation": "\n    @And(\"CxFlow starts a SAST scan\")",
    "glue_code": "    @And(\"CxFlow starts a SAST scan\")\n    public void cxflowStartsASASTScan() {\n        log.info(\"Waiting until scan is created.\");\n        Awaitility.await()\n                .atMost(SCAN_CREATION_TIMEOUT)\n                .until(() -> interceptedScanId != null);\n        log.info(\"Scan is created, ID: {}.\", interceptedScanId);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 136,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 944,
    "annotation": "\n    @Then(\"project preset is still {string} and scan configuration is {string}\")",
    "glue_code": "    @Then(\"project preset is still {string} and scan configuration is {string}\")\n    public void projectPresetIsStill(String expectedPreset, String expectedConfig) throws JsonProcessingException {\n        String configJson = cxClientSpy.getScanSetting(projectId);\n        JsonNode config = jsonMapper.readTree(configJson);\n\n        int currentPresetId = config.at(\"/preset/id\").asInt();\n        assertEquals(presetMapping.get(expectedPreset), currentPresetId,\n                \"Preset ID has changed after starting the scan.\");\n\n        int currentConfigId = config.at(\"/engineConfiguration/id\").asInt();\n        assertEquals(configMapping.get(expectedConfig), currentConfigId,\n                \"Configuration ID has changed after starting the scan.\");\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 145,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config/OverwritingProjectConfigSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/config",
      "filename": "OverwritingProjectConfigSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 945,
    "annotation": "    @And(\"The request sent to SAST will contain exclude-folder {string} and exclude files {string}\")",
    "glue_code": "    public void setExcludeFolders(String excludeFolders, String excludeFiles) {\n        if (!excludeFiles.equals(\"\")) {\n            cxProperties.setExcludeFiles(excludeFiles);\n            excludeFilesList = Arrays.asList(cxProperties.getExcludeFiles().split(\",\"));\n        }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 36,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 946,
    "annotation": "\n    @And(\"scanned lines of code will be {string}\")",
    "glue_code": "    @And(\"scanned lines of code will be {string}\")\n    public void checkLinesOfCode(String loc) {\n        assertEquals(results.getLoc(), loc);\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 47,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 947,
    "annotation": "\n    @And(\"filter-severity is {string} and filter-category is {string} and filter-cwe {string} and filter-status {string}\")",
    "glue_code": "    @And(\"filter-severity is {string} and filter-category is {string} and filter-cwe {string} and filter-status {string}\")\n    public void setFilters(String severity, String category, String cwe, String status) {\n        if (severity.equals(\"\") && category.equals(\"\") && cwe.equals(\"\") && status.equals(\"\")) {\n            return;\n        }\n        LinkedList filterList;\n        if (!severity.equals(\"\")) {\n            filterList = prepareFilterList(severity, Filter.Type.SEVERITY);\n            flowProperties.setFilterStatus(filterList);\n        }\n        if (!category.equals(\"\")) {\n            filterList = prepareFilterList(category, Filter.Type.TYPE);\n            flowProperties.setFilterCategory(filterList);\n        }\n        if (!cwe.equals(\"\")) {\n            filterList = prepareFilterList(cwe, Filter.Type.CWE);\n            flowProperties.setFilterCwe(filterList);\n\n        }\n        if (!status.equals(\"\")) {\n            filterList = prepareFilterList(status, Filter.Type.STATUS);\n            flowProperties.setFilterStatus(filterList);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "And",
    "line_in_the_file": 52,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 948,
    "annotation": "\n    @Then(\"output file will contain vulnerabilities {int}\")",
    "glue_code": "    @Then(\"output file will contain vulnerabilities {int}\")\n    public void verifyOutput(int number) {\n\n        ScanDTO scanDTO = callSast();\n        clearAfterTest(scanDTO);\n\n        List<ScanResults.XIssue> issues = results.getXIssues();\n        int countResults = 0;\n\n        for (ScanResults.XIssue issue : issues) {\n            countResults += issue.getDetails().size();\n        }\n\n        assertEquals(countResults, number);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 93,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 949,
    "annotation": "\n    @Given(\"there is a SAST environment configured and running\")",
    "glue_code": "    @Given(\"there is a SAST environment configured and running\")\n    public void runningSASTEnv() {\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 109,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 950,
    "annotation": "\n    @When(\"running a scan for repository {string}\")",
    "glue_code": "    @When(\"running a scan for repository {string}\")\n    public void setGithubRepo(String repoUrl) {\n        this.repoUrl = repoUrl;\n        this.gitHubProperties.setUrl(repoUrl);\n        this.gitHubProperties.setApiUrl(repoUrl + \"repos/\");\n        this.branch = \"master\";\n        String[] repoUrlSegments = repoUrl.split(\"/\");\n        this.application = repoUrlSegments[repoUrlSegments.length - 1].replaceAll(\".git\", \"\");\n        setGithubAuthURL();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 113,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 951,
    "annotation": "\n\n    @Then(\"SAST output will contain high severity number {int} and medium severity number {int} and low severity number {int} and  SAST team name will be {string}\")",
    "glue_code": "\n    @Then(\"SAST output will contain high severity number {int} and medium severity number {int} and low severity number {int} and  SAST team name will be {string}\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 124,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 952,
    "annotation": "\n    @Then(\"SAST output will contain high severity number {int} and medium severity number {int} and low severity number {int}\")",
    "glue_code": "    @Then(\"SAST output will contain high severity number {int} and medium severity number {int} and low severity number {int}\")\n    public void verifyOutputSeverityI(Integer high, Integer medium, Integer low) {\n        ScanDTO scanDTO = callSast();\n        clearAfterTest(scanDTO);\n\n        assertEquals(high, results.getScanSummary().getHighSeverity());\n        assertEquals(medium, results.getScanSummary().getMediumSeverity());\n        assertEquals(low, results.getScanSummary().getLowSeverity());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 144,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 953,
    "annotation": "\n    @And(\"parameter path is populated in application.xml and scanType is {string} and branch {string}\")",
    "glue_code": "    @And(\"parameter path is populated in application.xml and scanType is {string} and branch {string}\")\n    public void setScanTypeAndBranch(String scanType, String branch) {\n\n        if (scanType.equals(\"Inc\")) {\n            cxProperties.setIncremental(true);\n        }\n\n        this.branch = branch;\n\n        setDeafultTeam();\n\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 154,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 954,
    "annotation": "\n\n    @And(\"parameter path is populated in application.xml and scanType is {string} and team is {string}\")",
    "glue_code": "\n    @And(\"parameter path is populated in application.xml and scanType is {string} and team is {string}\")",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 167,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 955,
    "annotation": "\n\n    @And(\"output json logger will have Scan request {string}\")",
    "glue_code": "\n    @And(\"output json logger will have Scan request {string}\")",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 183,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 956,
    "annotation": "\n    @And(\"output json logger will have Scan request {string} and scan status will be {string}\")",
    "glue_code": "    @And(\"output json logger will have Scan request {string} and scan status will be {string}\")\n    public void verifyJsonLoggerAndScanStatus(String repoUrl, String scanStatus) {\n\n        JsonLoggerTestUtils testUtils = new JsonLoggerTestUtils();\n        JsonNode node;\n        try {\n\n            //AnalyticsReport report = testUtils.getReportNode(ScanReport.OPERATION, ScanReport.class);\n            node = testUtils.getReportNode(ScanReport.OPERATION);\n            \n            if (this.repoType.equals(ScanRequest.Repository.GITHUB)) {\n                assertEquals((ScanRequest.Repository.GITHUB.toString()), node.get(\"repoType\").textValue());\n                assertEquals(this.branch, node.get(\"branch\").textValue());\n                assertEquals(repoUrl, AesEncryptionUtils.decrypt(node.get(\"repoUrl\").textValue().trim()));\n            } else {\n                assertEquals(\"NA\", node.get(\"repoType\").textValue());\n                if (!errorExpected) {\n                    assertEquals(fileRepo.getPath(), AesEncryptionUtils.decrypt(node.get(\"repoUrl\").textValue().trim()));\n                }\n            }\n\n            assertTrue(node.get(\"scanStatus\").get(\"message\").textValue().startsWith(scanStatus));\n            assertEquals(cxProperties.getIncremental() ? \"Inc\" : \"Full\", node.get(\"scanType\").textValue());\n            if(!errorExpected) {\n                assertNotEquals(\"NA\", node.get(\"scanId\").textValue());\n            }\n\n        } catch (IOException | CheckmarxException e) {\n            fail(e.getMessage());\n        } finally {\n            try {\n                testUtils.clearLogContents();\n                errorExpected = false;\n            } catch (Exception e) {\n                fail(e.getMessage());\n            }\n        }\n\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 189,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 957,
    "annotation": "\n    @And(\"running a scan for a specified folder\")",
    "glue_code": "    @And(\"running a scan for a specified folder\")\n    public void setFileReporitory() {\n        try {\n\n            super.fileRepo = ResourceUtils.getFile(\"classpath:\\\\cucumber\\\\data\\\\input-files-toscan\\\\VB_3845\\\\encode.zip\");\n            this.application = \"VB_3845\";\n            repoType = ScanRequest.Repository.NA;\n\n        } catch (FileNotFoundException e) {\n            fail(e.getMessage());\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Then",
    "line_in_the_file": 229,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 958,
    "annotation": "\n    @Given(\"github repository which contains project CodeInjection\")",
    "glue_code": "    @Given(\"github repository which contains project CodeInjection\")\n    public void setGitHubRepository() {\n        setGithubAuthURL();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 242,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 959,
    "annotation": "\n    @And(\"team in application.yml is {string}\")",
    "glue_code": "    @And(\"team in application.yml is {string}\")\n    public void setTeam(String team) {\n        this.teamName = team;\n        cxProperties.setTeam(team);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 247,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 960,
    "annotation": "    \n    @And(\"team in application.yml is \\\\CxServer\\\\SP\")",
    "glue_code": "    @And(\"team in application.yml is \\\\CxServer\\\\SP\")\n    public void setTeam() {\n        setDeafultTeam();\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 253,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 961,
    "annotation": "\n    @When(\"project is: {string} and branch={string}\")",
    "glue_code": "    @When(\"project is: {string} and branch={string}\")\n    public void setProjectAndBranch(String projectName, String branchName) {\n        this.projectName = projectName;\n        this.branch = branchName;\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 258,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 962,
    "annotation": "\n    @And(\"multi-tenant=true\")",
    "glue_code": "    @And(\"multi-tenant=true\")\n    public void setMultiTenantTrue() {\n        cxProperties.setMultiTenant(Boolean.TRUE);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 264,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 963,
    "annotation": "\n\n    @And(\"multi-tenant=false\")",
    "glue_code": "\n    @And(\"multi-tenant=false\")\n    public void setMultiTenantFalse() {\n        cxProperties.setMultiTenant(Boolean.FALSE);\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 269,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 964,
    "annotation": "\n    @And(\"namespace is: {string} and application is {string}\")",
    "glue_code": "    @And(\"namespace is: {string} and application is {string}\")\n    public void setNameSpaceApplication(String namespace, String application) {\n        this.namespace = namespace;\n        this.application = application;\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 275,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 965,
    "annotation": "\n\n    @And(\"repo-name is {string} and --repo-url is supplied and --github flag is supplied\")",
    "glue_code": "\n    @And(\"repo-name is {string} and --repo-url is supplied and --github flag is supplied\")",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 281,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 966,
    "annotation": "\n\n    @Then(\"The request sent to SAST reporitory will contain scan result with project name={string} and team {string}\")",
    "glue_code": "\n    @Then(\"The request sent to SAST reporitory will contain scan result with project name={string} and team {string}\")",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 288,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan/ScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sast/scan",
      "filename": "ScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 967,
    "annotation": "\n    @Given(\"scan initiator is SCA\")",
    "glue_code": "    @Given(\"scan initiator is SCA\")\n    public void setScanInitiator() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 58,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado/ScaIssuesCreationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado",
      "filename": "ScaIssuesCreationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 968,
    "annotation": "\n    @And(\"bug tracker is Azure\")",
    "glue_code": "    @And(\"bug tracker is Azure\")\n    public void setBugTracker() {\n        flowProperties.setBugTracker(AZURE);\n        flowProperties.setBugTrackerImpl(Collections.singletonList(AZURE));\n        adoProperties.setUrl(\"https://dev.azure.com/\");\n        adoProperties.setProjectName(PROJECT_NAME);\n        adoProperties.setNamespace(NAMESPACE);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 63,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado/ScaIssuesCreationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado",
      "filename": "ScaIssuesCreationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 969,
    "annotation": "\n    @When(\"publishing new known unfiltered SCA results with 8 findings including 2 high and 6 medium vulnerabilities\")",
    "glue_code": "    @When(\"publishing new known unfiltered SCA results with 8 findings including 2 high and 6 medium vulnerabilities\")\n    public void publishNewScaResults() throws IOException, MachinaException {\n        ScanResults scanResults = JsonUtils.json2Object(TestUtils.getFileFromRelativeResourcePath(INPUT_BASE_PATH + INPUT_FILE), ScanResults.class);\n        resultsService.processResults(getBasicScanRequest(), scanResults, null);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 72,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado/ScaIssuesCreationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado",
      "filename": "ScaIssuesCreationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 970,
    "annotation": "\n    @Then(\"new 8 tickets should be created\")",
    "glue_code": "    @Then(\"new 8 tickets should be created\")\n    public void ticketsCreationValidation() throws IOException {\n        Assert.assertEquals(\"Azure new SCA results tickets number is not as expected\",\n                8, azureDevopsClient.getIssueCount());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 78,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado/ScaIssuesCreationSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/ado",
      "filename": "ScaIssuesCreationSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 971,
    "annotation": "\n    @Given(\"scanner is SCA\")",
    "glue_code": "    @Given(\"scanner is SCA\")\n    public void setScanner() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 58,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github/ScaResolveIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github",
      "filename": "ScaResolveIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 972,
    "annotation": "\n    @And(\"bug tracker is Jira\")",
    "glue_code": "    @And(\"bug tracker is Jira\")\n    public void setBugTracker() {\n        flowProperties.setBugTracker(\"JIRA\");\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 63,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github/ScaResolveIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github",
      "filename": "ScaResolveIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 973,
    "annotation": "\n    @And(\"bug tracker contains open vulnerabilities\")",
    "glue_code": "    @And(\"bug tracker contains open vulnerabilities\")\n    public void createBugTrackerOpenVulnerabilities() throws IOException, MachinaException {\n        processResultsByInput(INPUT_FILE);\n\n        Map<String, Integer> issuesByStatus = jiraUtils.getIssuesByStatus(PROJECT_KEY);\n        openIssuesBeforeResolving = getOpenIssues(issuesByStatus);\n        closedIssuesBeforeResolving = getClosedIssues(issuesByStatus);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 68,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github/ScaResolveIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github",
      "filename": "ScaResolveIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 974,
    "annotation": "\n    @When(\"resolving on of the vulnerabilities\")",
    "glue_code": "    @When(\"resolving on of the vulnerabilities\")\n    public void resolveVulnerability() throws IOException, MachinaException {\n        processResultsByInput(RESOLVER_INPUT_FILE);\n\n        Map<String, Integer> issuesByStatus = jiraUtils.getIssuesByStatus(PROJECT_KEY);\n        openIssuesAfterResolving = getOpenIssues(issuesByStatus);\n        closedIssuesAfterResolving = getClosedIssues(issuesByStatus);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 77,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github/ScaResolveIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github",
      "filename": "ScaResolveIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 975,
    "annotation": "\n    @Then(\"resolved vulnerability status should getting update to closed\")",
    "glue_code": "    @Then(\"resolved vulnerability status should getting update to closed\")\n    public void validateResolveVulnerabilityStatus() {\n        String errorMessage = \"Total open issues before the fix: \" + openIssuesBeforeResolving + \". Total open issues after the fix: \" + openIssuesAfterResolving;\n        Assert.assertTrue(\"Expected number of open issues left after vulnerabilities resolving will be reduced. \" + errorMessage,\n                openIssuesAfterResolving < openIssuesBeforeResolving);\n        errorMessage = \"Total closed issues before the fix: \" + closedIssuesBeforeResolving + \". Total closed issues after the fix: \" + closedIssuesAfterResolving;\n        Assert.assertTrue(\"Expected number of closed issues after vulnerabilities resolving will be increased. \" + errorMessage,\n                closedIssuesBeforeResolving < closedIssuesAfterResolving);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 86,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github/ScaResolveIssueSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/bugtrackers/github",
      "filename": "ScaResolveIssueSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 976,
    "annotation": "\n    @Given(\"cx-flow has a scan request\")",
    "glue_code": "    @Given(\"cx-flow has a scan request\")\n    public void getScanRequest() {\n        scanRequest = initCxConfigScanRequest();\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 42,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code/ScaConfigAsCodeSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code",
      "filename": "ScaConfigAsCodeSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 977,
    "annotation": "\n    @When(\"target repo contains a configuration file\")",
    "glue_code": "    @When(\"target repo contains a configuration file\")\n    public void getRepoCxConfig() {\n        CxConfig cxConfigOverride = gitHubService.getCxConfigOverride(scanRequest);\n        configOverrider.overrideScanRequestProperties(cxConfigOverride, scanRequest);\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 47,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code/ScaConfigAsCodeSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code",
      "filename": "ScaConfigAsCodeSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 978,
    "annotation": "\n    @Then(\"cx-flow configurations properties are getting overridden with the following parameters:\")",
    "glue_code": "    @Then(\"cx-flow configurations properties are getting overridden with the following parameters:\")\n    public void validatePropertiesAreOverridden(List<String> listOfParameters) {\n        listOfParameters.forEach(currentParameter -> {\n            String failMsg;\n            Object expected;\n            Object actual;\n\n            switch (currentParameter) {\n                case \"vulnerabilityScanners\":\n                    failMsg = \"vulnerability scanners from configuration as code are not as expected\";\n                    Assert.assertTrue(failMsg, scanRequest.getVulnerabilityScanners().toString().contains(\"SCAScanner\"));\n                    break;\n                case \"thresholdsSeverity\":\n                    failMsg = \"SCA thresholds severity from configuration as code is not as expected\";\n                    expected = \"{HIGH=10, MEDIUM=6, LOW=3}\";\n                    actual = StringUtils.join(scanRequest.getScaConfig().getThresholdsSeverity());\n                    Assert.assertEquals(failMsg , expected , actual);\n                    break;\n                case \"thresholdsScore\":\n                    failMsg = \"SCA thresholds score from configuration as code is not as expected\";\n                    expected = 8.5;\n                    actual = scanRequest.getScaConfig().getThresholdsScore();\n                    Assert.assertEquals(failMsg , expected , actual);\n                    break;\n                case \"filterSeverity\":\n                    failMsg = \"SCA filter severity from configuration as code is not as expected\";\n                    Set<String> actualSeverities = getFilterValues(Filter.Type.SEVERITY)\n                            .collect(Collectors.toSet());\n\n                    Assert.assertTrue(failMsg, actualSeverities.containsAll(Arrays.asList(\"high\", \"medium\", \"low\")));\n                    break;\n                case \"filterScore\":\n                    failMsg = \"SCA filter score from configuration as code is not as expected\";\n                    expected = \"7.5\";\n                    String actualScore = getFilterValues(Filter.Type.SCORE)\n                            .findFirst()\n                            .orElse(null);\n                    Assert.assertEquals(failMsg, expected, actualScore);\n                    break;\n                default:\n                    throw new PendingException(\"The support for this parameter is not yet implemented: \" + currentParameter);\n            }\n        });\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 53,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code/ScaConfigAsCodeSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/config_as_code",
      "filename": "ScaConfigAsCodeSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 979,
    "annotation": "\n    @Given(\"scan initiator is SCA\")",
    "glue_code": "    @Given(\"scan initiator is SCA\")\n    public void setScanInitiator() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 47,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters/ScaFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters",
      "filename": "ScaFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 980,
    "annotation": "\n    @And(\"SCA filter severity is enabled with {string} filter\")",
    "glue_code": "    @And(\"SCA filter severity is enabled with {string} filter\")\n    public void setScaSeverityFilter(String severityFilterList) {\n        if (severityFilterList.equals(\"\")) {\n            scaProperties.setFilterSeverity(null);\n        } else {\n            List<String> filterSeverity = createFiltersListFromString(severityFilterList);\n            scaProperties.setFilterSeverity(filterSeverity);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 52,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters/ScaFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters",
      "filename": "ScaFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 981,
    "annotation": "\n    @And(\"Sca filter score is enabled with {double} filter\")",
    "glue_code": "    @And(\"Sca filter score is enabled with {double} filter\")\n    public void setScaScoreFilter(double scoreFilter) {\n        scaProperties.setFilterScore(scoreFilter);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 62,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters/ScaFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters",
      "filename": "ScaFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 982,
    "annotation": "\n    @When(\"SCA runs a new scan on Filters-Tests-Repo which contains 8 vulnerabilities results\")",
    "glue_code": "    @When(\"SCA runs a new scan on Filters-Tests-Repo which contains 8 vulnerabilities results\")\n    public void scanResults() {\n        // scanRequest must be created after all the changes in scaProperties are done.\n        ScanRequest scanRequest = getBasicScanRequest(PROJECT_NAME, GIT_REPO_URL);\n\n        ScanResults scanResults = scaScanner.scan(scanRequest);\n        scaResults = Objects.requireNonNull(scanResults).getScaResults();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 67,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters/ScaFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters",
      "filename": "ScaFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 983,
    "annotation": "\n    @Then(\"the expected number of sanitized vulnerabilities are {int}\")",
    "glue_code": "    @Then(\"the expected number of sanitized vulnerabilities are {int}\")\n    public void validateFilteredResults(int expectedResults) {\n        Assert.assertEquals(expectedResults, scaResults.getFindings().size());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 76,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters/ScaFiltersSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/filters",
      "filename": "ScaFiltersSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 984,
    "annotation": "\n    @Given(\"scanner is SCA\")",
    "glue_code": "    @Given(\"scanner is SCA\")\n    public void setScanner() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 69,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management/ScaPolicyManagementSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management",
      "filename": "ScaPolicyManagementSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 985,
    "annotation": "\n    @And(\"a violated policy is assigned to an existing project\")",
    "glue_code": "    @And(\"a violated policy is assigned to an existing project\")\n    public void assignPolicyToProject() throws IOException {\n        projectId = scaClientHelper.createRiskManagementProject(PROJECT_NAME);\n\n        PolicyAction policyAction = PolicyAction.builder()\n                .breakBuild(true)\n                .build();\n\n        Conditions ruleCondition = Conditions.builder()\n                .operator(\"Equal\")\n                .parameterValue(Collections.singletonList(\"High\"))\n                .parameter(\"VulnerabilitySeverity\")\n                .build();\n\n        PolicyRule policyRule = PolicyRule.builder()\n                .name(\"No High Severity Rule\")\n                .conditions(Collections.singletonList(ruleCondition))\n                .build();\n\n        Policy policy = Policy.builder()\n                .name(\"No-High-Severity-Policy-Test-SCA\")\n                .rules(Collections.singletonList(policyRule))\n                .projectIds(Collections.singletonList(projectId))\n                .actions(policyAction)\n                .build();\n\n        policyId = scaClientHelper.createNewPolicy(policy);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 74,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management/ScaPolicyManagementSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management",
      "filename": "ScaPolicyManagementSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 986,
    "annotation": "\n    @When(\"initiating a new scan\")",
    "glue_code": "    @When(\"initiating a new scan\")\n    public void initNewScan() {\n        ScanRequest scanRequest = getBasicScanRequest(PROJECT_NAME, GIT_REPO_URL);\n\n        ScanResults scanResults = scaScanner.scan(scanRequest);\n        scaResults = Objects.requireNonNull(scanResults).getScaResults();\n        log.info(\"scaResults is policy violated : {}\", scaResults.isPolicyViolated());\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 103,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management/ScaPolicyManagementSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management",
      "filename": "ScaPolicyManagementSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 987,
    "annotation": "\n    @Then(\"isPolicyViolated flag in SCA results should be positive\")",
    "glue_code": "    @Then(\"isPolicyViolated flag in SCA results should be positive\")\n    public void validateIsPolicyViolatedFlag() {\n        Assert.assertTrue(\"Expected policy to be marked as violated\",\n                scaResults.isPolicyViolated());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 112,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management/ScaPolicyManagementSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/policy_management",
      "filename": "ScaPolicyManagementSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 988,
    "annotation": "\n    @Given(\"scan initiator is SCA\")",
    "glue_code": "    @Given(\"scan initiator is SCA\")\n    public void setScanInitiator() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 63,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 989,
    "annotation": "\n    @And(\"scan is configured as a {string} GIT remote repository source\")",
    "glue_code": "    @And(\"scan is configured as a {string} GIT remote repository source\")\n    public void setScanSourceAsPublicRemoteRepo(String repoVisibilityType) {\n        if (repoVisibilityType.equals(\"public\")) {\n            scanRequest = getBasicScanRequest(PUBLIC_PROJECT_NAME, PUBLIC_REPO);\n        } else if (repoVisibilityType.equals(\"private\")){\n            String token = gitHubProperties.getToken();\n            String remoteRepoWithAuth = String.format(PRIVATE_REPO, token);\n            scanRequest = getBasicScanRequest(PRIVATE_PROJECT_NAME, remoteRepoWithAuth);\n        }\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 68,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 990,
    "annotation": "\n    @And(\"scan is configured using invalid GIT remote repository source {string}\")",
    "glue_code": "    @And(\"scan is configured using invalid GIT remote repository source {string}\")\n    public void invalidRepo(String invalidRepoUrl){\n        scanRequest = getBasicScanRequest(PUBLIC_PROJECT_NAME, invalidRepoUrl);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 79,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 991,
    "annotation": "    @Then(\"the returned results are not null\")",
    "glue_code": "    public void validateResults() {\n        assertNotNull(\"SCA results are null.\", scaResults);\n        assertTrue(\"Scan ID is empty.\", StringUtils.isNotEmpty(scaResults.getScanId()));\n        assertNotNull(\"Summary is null.\", scaResults.getSummary());\n        assertNotNull(\"Finding counts are null.\", scaResults.getSummary().getFindingCounts());\n        assertNotNull(\"Expected report link of remote repo scan not to return null\", scaResults.getWebReportLink());\n\n        assertNotNull(\"Finding list is null.\", scaResults.getFindings());\n        assertFalse(\"Finding list is empty.\", scaResults.getFindings().isEmpty());\n\n        assertNotNull(\"Package list is null.\", scaResults.getPackages());\n        assertFalse(\"Package list is empty.\", scaResults.getPackages().isEmpty());\n    }\n\n    @When(\"scan is finished\")\n    public void startScan() {",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 84,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 992,
    "annotation": "\n    @When(\"scan is finished\")",
    "glue_code": "    @When(\"scan is finished\")\n    public void startScan() {\n        scaResults = Objects.requireNonNull(scaScanner.scan(scanRequest)).getScaResults();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 98,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 993,
    "annotation": "\n    @And(\"SCA scan report entry is created in Json Logger with corresponding error message\")",
    "glue_code": "    @And(\"SCA scan report entry is created in Json Logger with corresponding error message\")\n    public void validateLoggerError() {\n        \n        try {\n\n            scaScanner.scan(scanRequest);\n        } \n        //exception is expected\n        catch (Exception e1) {\n            \n            try{\n                ScanReport report = getReportObject();\n                assertEquals(AnalyticsReport.SCA, report.getScanInitiator());\n                assertEquals(OperationStatus.FAILURE, report.getScanResult().getStatus());\n                return;\n            } catch (CheckmarxException | JsonProcessingException e) {\n                fail(e.getMessage());\n            }\n        }\n        fail(\"no exception is thrown when invalid GIT url is supplied\");\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 103,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 994,
    "annotation": "\n    @And(\"SCA scan report entry is created in Json Logger\")",
    "glue_code": "    @And(\"SCA scan report entry is created in Json Logger\")\n    public void validateLogger() {\n\n\n        try {\n\n            ScanReport report = getReportObject();\n            assertEquals(AnalyticsReport.SCA, report.getScanInitiator());\n            assertEquals(scaResults.getScanId(), report.getScanId());\n            assertEquals(OperationStatus.SUCCESS, report.getScanResult().getStatus());\n\n        } catch (CheckmarxException | JsonProcessingException e) {\n            fail(e.getMessage());\n        }\n    }",
    "original_keyword": "And",
    "keyword": "When",
    "line_in_the_file": 125,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans/SCARemoteRepoScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/scans",
      "filename": "SCARemoteRepoScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 995,
    "annotation": "\n    @Given(\"scanner is SCA\")",
    "glue_code": "    @Given(\"scanner is SCA\")\n    public void setScanner() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 59,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams/SCATeamsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams",
      "filename": "SCATeamsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 996,
    "annotation": "\n    @When(\"creating a new project with associated {string} value\")",
    "glue_code": "    @When(\"creating a new project with associated {string} value\")\n    public void createNewProjectTeam(String team) throws IOException {\n        if (team.equals(\"null\")) {\n            team = null;\n        }\n        scaProperties.setTeam(team);\n        try {\n            projectId = scaClientHelper.createRiskManagementProject(PROJECT_NAME);\n        } catch (CxHTTPClientException e) {\n            errorStatusCode = e.getStatusCode();\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 64,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams/SCATeamsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams",
      "filename": "SCATeamsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 997,
    "annotation": "\n    @Then(\"project assignedTeams returned value is {string}\")",
    "glue_code": "    @Then(\"project assignedTeams returned value is {string}\")\n    public void validateAssignedTeam(String expectedAssignedTeam) throws IOException {\n        String actualTeam;\n        Project projectDetails = scaClientHelper.getProjectDetailsByProjectId(projectId);\n        List<String> assignedTeams = projectDetails.getAssignedTeams();\n\n        if (assignedTeams.isEmpty()) {\n            actualTeam = \"\";\n        } else {\n            actualTeam = assignedTeams.get(0);\n        }\n\n        Assert.assertEquals(expectedAssignedTeam, actualTeam);\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 77,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams/SCATeamsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/teams",
      "filename": "SCATeamsSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 998,
    "annotation": "\n    @Given(\"scanner is SCA\")",
    "glue_code": "    @Given(\"scanner is SCA\")\n    public void setScanner() {\n        flowProperties.setEnabledVulnerabilityScanners(Collections.singletonList(ScaProperties.CONFIG_PREFIX));\n    }",
    "original_keyword": "Given",
    "keyword": "Given",
    "line_in_the_file": 44,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan/ScaZipScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan",
      "filename": "ScaZipScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 999,
    "annotation": "\n    @And(\"enabledZipScan property is set with true\")",
    "glue_code": "    @And(\"enabledZipScan property is set with true\")\n    public void setEnabledZipScanProperty() {\n        scaProperties.setEnabledZipScan(true);\n    }",
    "original_keyword": "And",
    "keyword": "Given",
    "line_in_the_file": 49,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan/ScaZipScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan",
      "filename": "ScaZipScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 1000,
    "annotation": "\n    @When(\"initiating a new scan\")",
    "glue_code": "    @When(\"initiating a new scan\")\n    public void initScan() {\n        ScanRequest scanRequest = getBasicScanRequest(PROJECT_NAME, GIT_REPO_URL);\n\n        ScanResults scanResults = scaScanner.scan(scanRequest);\n        scaResults = Objects.requireNonNull(scanResults).getScaResults();\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 54,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan/ScaZipScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan",
      "filename": "ScaZipScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 1001,
    "annotation": "\n    @Then(\"returned scan high and medium results are bigger than zero\")",
    "glue_code": "    @Then(\"returned scan high and medium results are bigger than zero\")\n    public void validateResults() {\n        validateFindingCount(scaResults, Severity.HIGH.name());\n        validateFindingCount(scaResults, Severity.MEDIUM.name());\n    }",
    "original_keyword": "Then",
    "keyword": "Then",
    "line_in_the_file": 62,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan/ScaZipScanSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/sca_scanner/zip_scan",
      "filename": "ScaZipScanSteps.java",
      "extension": ".java"
    }
  },
  {
    "step_definition_id": 1002,
    "annotation": "\n\n    @When(\"Creating zip File at a time\")",
    "glue_code": "\n    @When(\"Creating zip File at a time\")\n   public void testZipFileSuccess() throws IOException {\n        // Creating Zip File\n        ZipUtils zipService = new ZipUtils();\n        File zippedFile = zipService.zipToTempFile(\".\",\"\",\"\");\n\n        // Checking presence of zip file\n        assertTrue(zippedFile.exists());\n        assertTrue(zippedFile.length() >= 1); // Adjust based on size of your file\n\n        // Deleting zip file\n        boolean deleted = zippedFile.delete();\n\n        if (deleted) {\n            log.info(\"File successfully deleted!\");\n        } else {\n            log.info(\"Error deleting file.\");\n        }\n    }",
    "original_keyword": "When",
    "keyword": "When",
    "line_in_the_file": 16,
    "file_info": {
      "path": "src/test/java/com/checkmarx/flow/cucumber/integration/ziputils/zipUtilsSteps.java",
      "directory": "src/test/java/com/checkmarx/flow/cucumber/integration/ziputils",
      "filename": "zipUtilsSteps.java",
      "extension": ".java"
    }
  }
]