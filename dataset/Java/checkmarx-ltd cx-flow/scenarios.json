[
  {
    "feature": "Test analytics for get results operation",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "do get results operation for a known project, and validate the analytics created for the operation.",
        "examples": [
          {
            "high": "10",
            "medium": "10",
            "low": "10",
            "info": "10"
          },
          {
            "high": "10",
            "medium": "0",
            "low": "0",
            "info": "0"
          },
          {
            "high": "0",
            "medium": "0",
            "low": "10",
            "info": "0"
          }
        ],
        "steps": [
          {
            "step": "When doing get results operation on SAST scan with <high> <medium> <low> <info> results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 621
          },
          {
            "step": "Then we should see the expected number of tickets in analytics for SAST",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 624
          }
        ]
      },
      {
        "scenario_name": "do get results operation for a known project, and validate the analytics created for the operation.",
        "examples": [
          {
            "high": "10",
            "medium": "0",
            "low": "0"
          },
          {
            "high": "10",
            "medium": "5",
            "low": "0"
          },
          {
            "high": "0",
            "medium": "0",
            "low": "10"
          }
        ],
        "steps": [
          {
            "step": "When doing get results operation on SCA scan with <high> <medium> <low> results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 622
          },
          {
            "step": "Then we should see the expected number of tickets in analytics for SCA",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 625
          }
        ]
      },
      {
        "scenario_name": "do get results operation for a known project with filters, and validate the analytics created for the operation.",
        "examples": [
          {
            "high": "10",
            "medium": "11",
            "low": "12",
            "info": "13",
            "filter": "HIGH"
          },
          {
            "high": "10",
            "medium": "11",
            "low": "12",
            "info": "13",
            "filter": "MEDIUM"
          },
          {
            "high": "10",
            "medium": "11",
            "low": "12",
            "info": "13",
            "filter": "HIGH"
          }
        ],
        "steps": [
          {
            "step": "When doing get results operation on SAST scan with <high> <medium> <low> <info> results and filter is \"<filter>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 623
          },
          {
            "step": "Then we should see the expected number of tickets in analytics for SAST",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 624
          }
        ]
      }
    ]
  },
  {
    "feature": "Test analytics for get results operation",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "do get results operation for a known project, and validate the analytics created for the operation.",
        "examples": [
          {
            "repo": "github",
            "scanner": "AST",
            "high": "10",
            "medium": "10",
            "low": "10",
            "info": "10"
          },
          {
            "repo": "github",
            "scanner": "AST",
            "high": "10",
            "medium": "0",
            "low": "0",
            "info": "0"
          },
          {
            "repo": "github",
            "scanner": "AST",
            "high": "0",
            "medium": "0",
            "low": "10",
            "info": "0"
          },
          {
            "repo": "github",
            "scanner": "AST",
            "high": "0",
            "medium": "0",
            "low": "0",
            "info": "0"
          },
          {
            "repo": "github",
            "scanner": "AST,SCA",
            "high": "0",
            "medium": "0",
            "low": "10",
            "info": "0"
          }
        ],
        "steps": [
          {
            "step": "When repository is \"<repo>\" and scanner is \"<scanner>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 626
          },
          {
            "step": "And doing get results operation on scan with <high> <medium> <low> <info> results",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 627
          },
          {
            "step": "Then we should see the expected number of results in comments",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 628
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Component tests - retrieve scans of existing project",
    "background": [
      {
        "step": "Given Mocked SAST environment with project CodeInjection1 and team CxServer",
        "original_keyword": "Given",
        "keyword": "Given",
        "template": "Mocked SAST environment with project CodeInjection1 and team CxServer",
        "simple_template": "Mocked SAST environment with project CodeInjection1 and team CxServer",
        "regex_to_link_to_step": "^Mocked\\ SAST\\ environment\\ with\\ project\\ CodeInjection1\\ and\\ team\\ CxServer$",
        "step_definition_id": -1
      }
    ],
    "scenarios": [
      {
        "scenario_name": "Basic sanity positive and negative tests - get results successfully and invalid output file path",
        "examples": [
          {
            "project_name": "CodeInjection1",
            "team_name": "CxServer",
            "path": "someValidPath",
            "number": "3"
          },
          {
            "project_name": "CodeInjection1",
            "team_name": "CxServer",
            "path": "someUnexistingFolder",
            "number": "exception"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team_name>\" and project is: \"<project_name>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created in path: \"<path>\" and output will contain  \"<project_name>\" and \"<team_name>\" and vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "test command line when missing basic command line args: --batch,--scan, --parse,--project",
        "examples": [
          {
            "exception": "--scan | --parse | --batch | --project option must be specified"
          }
        ],
        "steps": [
          {
            "step": "Given running command line with file repository source",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "Then exception \"<exception>\" will be thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 743
          }
        ]
      }
    ]
  },
  {
    "feature": "Using Groovy script to configure Jira project key on bug tracker",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Configuring Jira project key using a script result",
        "examples": [
          {
            "project key script": "jira-standard-project-key",
            "project key": "standard project key"
          },
          {
            "project key script": "invalid-return-type-project-key-script",
            "project key": "Default Project Key"
          },
          {
            "project key script": "invalid-syntax-project-key-script",
            "project key": "Default Project Key"
          },
          {
            "project key script": "script-not-exist",
            "project key": "Default Project Key"
          },
          {
            "project key script": "empty",
            "project key": "Default Project Key"
          }
        ],
        "steps": [
          {
            "step": "Given given 'jira-project-key' script name is '<project key script>'",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When Determine JIRA project key",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 700
          },
          {
            "step": "Then JIRA project key is equal to '<project key>'",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 701
          }
        ]
      },
      {
        "scenario_name": "Configuring JIRA project key using a script based on request data",
        "examples": [],
        "steps": [
          {
            "step": "Given given 'jira-project-key' script name is 'parse-jira-project-key'",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When Scan request contain feature repo name 'Test-feature-repo'",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 702
          },
          {
            "step": "And Determine JIRA project key",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 700
          },
          {
            "step": "Then JIRA project key is equal to 'script-prefix-Test-feature-repo'",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 701
          }
        ]
      }
    ]
  },
  {
    "feature": "Using Groovy script to configure SAST comment on scan request",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Configuring SAST comment using a script result",
        "examples": [
          {
            "comment script": "sast-standard-comment",
            "comment": "standard comment"
          },
          {
            "comment script": "special-characters-comment-script",
            "comment": "comment_with-special/characters*$@!66 ^*"
          },
          {
            "comment script": "invalid-return-type-comment-script",
            "comment": "CxFlow Automated Scan"
          },
          {
            "comment script": "script-not-exist",
            "comment": "CxFlow Automated Scan"
          },
          {
            "comment script": "invalid-syntax-script-comment",
            "comment": "CxFlow Automated Scan"
          },
          {
            "comment script": "empty",
            "comment": "CxFlow Automated Scan"
          }
        ],
        "steps": [
          {
            "step": "Given given 'sast-comment' script name is '<comment script>'",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When CxFlow triggers SAST scan",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 649
          },
          {
            "step": "Then CxFlow scan comment is equal to '<comment>'",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 650
          }
        ]
      },
      {
        "scenario_name": "Configuring SAST comment using a script based on request data",
        "examples": [],
        "steps": [
          {
            "step": "Given given 'sast-comment' script name is 'parse-branch-name-comment'",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When Scan request contains feature branch name 'Test-feature-branch'",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 648
          },
          {
            "step": "And CxFlow triggers SAST scan",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 649
          },
          {
            "step": "Then CxFlow scan comment is equal to 'script-prefix-Test-feature-branch'",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 650
          }
        ]
      }
    ]
  },
  {
    "feature": "Csv issue tracker flow",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Csv issue tracker",
        "examples": [
          {
            "findings": "2 findings with the same vulnerability type and in the same file",
            "number of issues": "1"
          },
          {
            "findings": "2 findings with the same vulnerability type and in different files",
            "number of issues": "2"
          },
          {
            "findings": "2 findings with different vulnerability types and in the same file",
            "number of issues": "2"
          },
          {
            "findings": "2 findings with different vulnerability types and in different files",
            "number of issues": "2"
          }
        ],
        "steps": [
          {
            "step": "Given Sast results having the following findings: <findings>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 633
          },
          {
            "step": "When publish findings using Csv issue tracker",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 634
          },
          {
            "step": "Then Csv result generated with <number of issues> issue(s)",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow components tests integration with Cx-integrations",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Cx-Go configuration is getting override when read-multi-tenant-configuration flag in cx-integrations configuration section set to true",
        "examples": [],
        "steps": [
          {
            "step": "Given read-multi-tenant-configuration flag is set to true",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 651
          },
          {
            "step": "When cx-flow getting a new event",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 652
          },
          {
            "step": "Then scanRequest is getting populated with cx-go new configuration",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 653
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should delete SAST project when corresponding GitHub branch is deleted",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow deletes SAST project when a non-protected GitHub branch is deleted",
        "examples": [
          {
            "exists": "true",
            "protected": "true",
            "call": "false"
          },
          {
            "exists": "true",
            "protected": "false",
            "call": "true"
          },
          {
            "exists": "false",
            "protected": "true",
            "call": "false"
          },
          {
            "exists": "false",
            "protected": "false",
            "call": "false"
          }
        ],
        "steps": [
          {
            "step": "Given GitHub repo name is \"VB_3845\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 656
          },
          {
            "step": "And GitHub branch is \"test1\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 659
          },
          {
            "step": "And the \"test1\" branch is <protected> as determined by application.yml",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 661
          },
          {
            "step": "And a project \"VB_3845-test1\" \"<exists>\" in SAST",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 660
          },
          {
            "step": "When GitHub notifies cxFlow that a \"test1\" branch was deleted",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow will <call> the SAST delete API for the \"VB_3845-test1\" project",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 666
          },
          {
            "step": "And no exception will be thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 657
          }
        ]
      },
      {
        "scenario_name": "Github triggers delete event both when branch and tag are deleted,",
        "examples": [
          {
            "trigger": "branch",
            "call": "true"
          },
          {
            "trigger": "tag",
            "call": "false"
          }
        ],
        "steps": [
          {
            "step": "Given GitHub repo name is \"VB_3845\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 656
          },
          {
            "step": "And GitHub trigger is \"<trigger>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 658
          },
          {
            "step": "And the \"test2\" branch is \"not protected\" as determined by application.yml",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 661
          },
          {
            "step": "And a project \"VB_3845-test2\" \"exists\" in SAST",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 660
          },
          {
            "step": "When GitHub notifies cxFlow that a \"test2\" ref was deleted",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow will <call> the SAST delete API for the \"VB_3845-test2\" project",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 666
          },
          {
            "step": "And no exception will be thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 657
          }
        ]
      },
      {
        "scenario_name": "CxFlow deletes SAST project when a non-protected Azure branch is deleted",
        "examples": [
          {
            "protected": "false",
            "setToDelete": "true",
            "configAsCodeProject": "none",
            "call": "true",
            "projectName": "Delete-Branch-Repo-Test"
          },
          {
            "protected": "false",
            "setToDelete": "true",
            "configAsCodeProject": "project-to-delete",
            "call": "true",
            "projectName": "project-to-delete"
          },
          {
            "protected": "false",
            "setToDelete": "true",
            "configAsCodeProject": "foo-${branch}",
            "call": "true",
            "projectName": "foo-Test"
          },
          {
            "protected": "True",
            "setToDelete": "true",
            "configAsCodeProject": "some-project",
            "call": "false",
            "projectName": "none"
          },
          {
            "protected": "false",
            "setToDelete": "false",
            "configAsCodeProject": "some-project",
            "call": "false",
            "projectName": "none"
          }
        ],
        "steps": [
          {
            "step": "Given Azure repo name is \"Delete-Branch-Repo\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 654
          },
          {
            "step": "And Azure branch is \"Test\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 655
          },
          {
            "step": "And the \"Test\" branch is <protected> as determined by application.yml",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 661
          },
          {
            "step": "And the Azure properties is <setToDelete> by application.yml",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 662
          },
          {
            "step": "And config-as-code in azure default branch include Cx-project <configAsCodeProject>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 663
          },
          {
            "step": "When Azure notifies cxFlow that a \"Test\" branch was deleted",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 665
          },
          {
            "step": "Then CxFlow will <call> the SAST delete API for the \"<projectName>\" project",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 666
          },
          {
            "step": "And no exception will be thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 657
          }
        ]
      }
    ]
  },
  {
    "feature": "Using Groovy script to filter SAST findings",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Filtering SAST findings using a script",
        "examples": [
          {
            "filter script": "<not specified>",
            "findings": "1,2,3"
          },
          {
            "filter script": "true",
            "findings": "1,2,3"
          },
          {
            "filter script": "false",
            "findings": "<none>"
          },
          {
            "filter script": "finding.severity == 'HIGH' || (finding.severity == 'MEDIUM' && finding.state == 'URGENT')",
            "findings": "1,2"
          },
          {
            "filter script": "finding.severity == 'HIGH' || (finding.severity == 'MEDIUM' && finding.status == 'NEW')",
            "findings": "1,2"
          },
          {
            "filter script": "finding.state != 'TO VERIFY'",
            "findings": "2"
          },
          {
            "filter script": "finding.status == 'NEW'",
            "findings": "2,3"
          },
          {
            "filter script": "finding.status == 'REOCCURED'",
            "findings": "1"
          }
        ],
        "steps": [
          {
            "step": "Given SAST report containing 3 findings, each in a different file and with a different vulnerability type",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 676
          },
          {
            "step": "And finding #1 has \"High\" severity, \"ReOccured\" status and \"To Verify\" state",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And finding #2 has \"Medium\" severity, \"New\" status and \"Urgent\" state",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And finding #3 has \"Low\" severity, \"New\" status and \"To verify\" state",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And no simple filters are defined",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 678
          },
          {
            "step": "And filter script is \"<filter script>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 679
          },
          {
            "step": "When CxFlow generates issues from findings",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 680
          },
          {
            "step": "Then CxFlow report is generated with issues corresponding to these findings: \"<findings>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 681
          }
        ]
      },
      {
        "scenario_name": "Both scripted filter and simple filters are specified in config",
        "examples": [],
        "steps": [
          {
            "step": "Given SAST report containing 3 findings, each in a different file and with a different vulnerability type",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 676
          },
          {
            "step": "And status filter is set to \"New\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 682
          },
          {
            "step": "And filter script is \"finding.severity == 'MEDIUM'\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 679
          },
          {
            "step": "When CxFlow generates issues from findings",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 680
          },
          {
            "step": "Then CheckmarxRuntimeException is thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 683
          },
          {
            "step": "And the exception message contains the text: \"Simple filters and scripted filter cannot be used together\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 684
          }
        ]
      },
      {
        "scenario_name": "Invalid script syntax",
        "examples": [
          {
            "invalid script": "(finding.severity"
          },
          {
            "invalid script": "12q3C = Z'"
          }
        ],
        "steps": [
          {
            "step": "Given SAST report containing 3 findings, each in a different file and with a different vulnerability type",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 676
          },
          {
            "step": "And no simple filters are defined",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 678
          },
          {
            "step": "And filter script is \"<invalid script>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 679
          },
          {
            "step": "When CxFlow generates issues from findings",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 680
          },
          {
            "step": "Then CheckmarxRuntimeException is thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 683
          },
          {
            "step": "And the exception message contains the text: \"make sure the script syntax is correct\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 684
          }
        ]
      },
      {
        "scenario_name": "Script runtime error",
        "examples": [
          {
            "invalid script": "finding.creativity == 'HIGH'"
          },
          {
            "invalid script": "nonExistingVar > 23"
          },
          {
            "invalid script": "Bonnie Prince Charlie"
          }
        ],
        "steps": [
          {
            "step": "Given SAST report containing 3 findings, each in a different file and with a different vulnerability type",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 676
          },
          {
            "step": "And no simple filters are defined",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 678
          },
          {
            "step": "And filter script is \"<invalid script>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 679
          },
          {
            "step": "When CxFlow generates issues from findings",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 680
          },
          {
            "step": "Then CheckmarxRuntimeException is thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 683
          },
          {
            "step": "And the exception message contains the text: \"runtime error has occurred while executing the filter script\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 684
          }
        ]
      },
      {
        "scenario_name": "Script returns a non-boolean value",
        "examples": [],
        "steps": [
          {
            "step": "Given SAST report containing 3 findings, each in a different file and with a different vulnerability type",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 676
          },
          {
            "step": "And no simple filters are defined",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 678
          },
          {
            "step": "And filter script is \"return 302\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 679
          },
          {
            "step": "When CxFlow generates issues from findings",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 680
          },
          {
            "step": "Then CheckmarxRuntimeException is thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 683
          },
          {
            "step": "And the exception message contains the text: \"Filtering script must return a boolean value\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 684
          }
        ]
      }
    ]
  },
  {
    "feature": "Parsing SAST results",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Parsing SAST scan results with no findings",
        "examples": [],
        "steps": [
          {
            "step": "Given input with no findings",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 667
          },
          {
            "step": "When parsing the input",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 685
          },
          {
            "step": "Then the generated CxFlow report contains no issues and the summary is empty",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 690
          }
        ]
      },
      {
        "scenario_name": "Parsing SAST findings with a variety of vulnerability types and filenames",
        "examples": [
          {
            "findings": "2 findings with the same vulnerability type and in the same file",
            "number of issues": "1",
            "number of details": "2"
          },
          {
            "findings": "2 findings with the same vulnerability type and in different files",
            "number of issues": "2",
            "number of details": "1"
          },
          {
            "findings": "2 findings with different vulnerability types and in the same file",
            "number of issues": "2",
            "number of details": "1"
          },
          {
            "findings": "2 findings with different vulnerability types and in different files",
            "number of issues": "2",
            "number of details": "1"
          }
        ],
        "steps": [
          {
            "step": "Given input having the following findings: \"<findings>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 668
          },
          {
            "step": "When parsing the input",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 685
          },
          {
            "step": "Then CxFlow report is generated with <number of issues> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And each issue contains <number of details> results and the same number of details",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 692
          }
        ]
      },
      {
        "scenario_name": "Parsing SAST scan results with a variety of severities",
        "examples": [],
        "steps": [
          {
            "step": "Given input has 4 findings with \"Low\" severity",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And input has 3 findings with \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And input has 2 findings with \"High\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And each finding has a unique combination of vulnerability type + filename",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 671
          },
          {
            "step": "When parsing the input with severity filter: Low, Medium, High",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow report summary contains a \"Low\" field with the value 4",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And CxFlow report summary contains a \"Medium\" field with the value 3",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And CxFlow report summary contains a \"High\" field with the value 2",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And CxFlow report summary contains only these 3 fields",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Parsing execution paths in SAST scan results",
        "examples": [
          {
            "number of findings": "1"
          },
          {
            "number of findings": "3"
          }
        ],
        "steps": [
          {
            "step": "Given input with <number of findings> finding(s)",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And the execution path of each finding contains 5 nodes",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And each of the findings has a different filename",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 674
          },
          {
            "step": "When parsing the input",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 685
          },
          {
            "step": "Then CxFlow report is generated with <number of findings> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And each issue contains 1 result",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And \"source\" object in each CxFlow result corresponds to the \"first\" execution path node in input",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 695
          },
          {
            "step": "And \"sink\" object in each CxFlow result corresponds to the \"last\" execution path node in input",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 695
          }
        ]
      },
      {
        "scenario_name": "Filtering findings from SAST scan results using simple filters",
        "examples": [],
        "steps": [
          {
            "step": "Given input containing 3 findings with different severities: Medium, High, Critical",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 669
          },
          {
            "step": "When parsing the input with severity filter: HIGH, Critical",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow report is generated with 2 issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And issue severities are: HIGH, CRITICAL",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Parsing SAST findings with customized severity",
        "examples": [],
        "steps": [
          {
            "step": "Given input has one vulnerability type with \"Low\" severity",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And input has one finding with this vulnerability type",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And user has overridden the severity of this specific finding with the \"High\" value",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When parsing the input with severity filter: HIGH",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow report is generated with 1 issue",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And the issue severity is HIGH",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Verify that generated reports match corresponding reference reports",
        "examples": [],
        "steps": [
          {
            "step": "Given reference CxFlow reports are available for specific inputs",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 675
          },
          {
            "step": "When parsing each of these inputs",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 687
          },
          {
            "step": "Then the generated CxFlow report matches a corresponding reference report",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 697
          }
        ]
      },
      {
        "scenario_name": "Trying to run parsing with an invalid command line",
        "examples": [
          {
            "command line": "--parse --offline --blocksysexit --app=MyApp",
            "exit code": "10"
          },
          {
            "command line": "--parse --offline --blocksysexit --app=MyApp --f=m:\nonexistent\\file-0192019593560",
            "exit code": "2"
          },
          {
            "command line": "--parse --offline --blocksysexit --f=c:\\dontCareIfFileExists",
            "exit code": "1"
          }
        ],
        "steps": [
          {
            "step": "When running CxFlow with command line: \"<command line>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 688
          },
          {
            "step": "Then CxFlow exits with exit code <exit code>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 689
          }
        ]
      }
    ]
  },
  {
    "feature": "Scanner project name generation",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Project name generation with different values of preserve-project-Name",
        "examples": [
          {
            "preserve": "false",
            "repo-name": "ch-eck^ marx@*",
            "project-name": "ch-eck-marx--master"
          },
          {
            "preserve": "true",
            "repo-name": "ch-eck^ marx@*",
            "project-name": "ch-eck^ marx@*-master"
          }
        ],
        "steps": [
          {
            "step": "Given preserve-project-name is <preserve> and multi-tenant is true",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 703
          },
          {
            "step": "When scan request arrives with repo-name <repo-name> and branch is 'master'",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 704
          },
          {
            "step": "Then project name used by scanner is <project-name>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 705
          }
        ]
      },
      {
        "scenario_name": "Project name generation with different params",
        "examples": [
          {
            "namespace": "checkmarx-ltd",
            "repo-name": "cx-flow",
            "branch": "",
            "application": "N/A",
            "multi-tenant": "true",
            "project-name": "cx-flow"
          },
          {
            "namespace": "checkmarx-ltd",
            "repo-name": "cx-flow",
            "branch": "master",
            "application": "N/A",
            "multi-tenant": "true",
            "project-name": "cx-flow-master"
          },
          {
            "namespace": "checkmarx-ltd",
            "repo-name": "cx-flow",
            "branch": "master",
            "application": "N/A",
            "multi-tenant": "false",
            "project-name": "checkmarx-ltd-cx-flow-master"
          },
          {
            "namespace": "",
            "repo-name": "",
            "branch": "",
            "application": "checkmarx-application",
            "multi-tenant": "false",
            "project-name": "checkmarx-application"
          }
        ],
        "steps": [
          {
            "step": "Given multi-tenant is <multi-tenant>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 703
          },
          {
            "step": "When scan request arrives with namespace <namespace>, repo-name <repo-name>, branch <branch> and application <application>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 707
          },
          {
            "step": "Then project name used by scanner is <project-name>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 705
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Component tests publish functionality",
    "background": [
      {
        "step": "Given Mocked SAST or OSA results Object",
        "original_keyword": "Given",
        "keyword": "Given",
        "template": "Mocked SAST or OSA results Object",
        "simple_template": "Mocked SAST or OSA results Object",
        "regex_to_link_to_step": "^Mocked\\ SAST\\ or\\ OSA\\ results\\ Object$",
        "step_definition_id": -1
      }
    ],
    "scenarios": [
      {
        "scenario_name": "retrieve OSA results from input results object and publish to an appropriate bug tracker object",
        "examples": [
          {
            "projectName": "OSAVulsLibs",
            "channel": "Jira",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "GitHub",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "Gitlab",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "BitBucketServer",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "BitBucketCloud",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "XML",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "Azure",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "CSV",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "email",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "WEB",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsLibs",
            "channel": "PullMergeMarkdown",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "Jira",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "GitHub",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "Gitlab",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "BitBucketServer",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "BitBucketCloud",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "XML",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "Azure",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "CSV",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "email",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "WEB",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSAVulsOnly",
            "channel": "PullMergeMarkdown",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "Jira",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "GitHub",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "Gitlab",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "BitBucketServer",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "BitBucketCloud",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "XML",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "Azure",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "CSV",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "email",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "WEB",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "projectName": "OSALibsOnly",
            "channel": "PullMergeMarkdown",
            "OSALibrariesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesFile": "C:\\CxReports\\cxflow",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          }
        ],
        "steps": [
          {
            "step": "Given OSA projectName is <projectName>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When OSALibraries path is is: \"<OSALibrariesFile>\" and OSAVulnerailibies path is: \"<OSAVulnerailibiesFile>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then obejct file is created in channel: \"<channel>\" and will contain the OSALibraries number <OSALibrariesNum> and OSAVulnerailibies number <OSAVulnerailibiesNum>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve SAST results from input results object and publish to an appropriate bug tracker object",
        "examples": [
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "Jira",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "GitHub",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "Gitlab",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "BitBucketServer",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "BitBucketCloud",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "XML",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "Azure",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "CSV",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "email",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "WEB",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "channel": "PullMergeMarkdown",
            "number": "3"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Json",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Jira",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "GitHub",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Gitlab",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "BitBucketServer",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "BitBucketCloud",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "XML",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Azure",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "CSV",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "email",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "WEB",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "PullMergeMarkdown",
            "number": "0"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team>\" and project is: \"<project>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Output Object will be created for the appropriate bug tracker channel <channel> with with vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve Big SAST results to a bug tracker",
        "examples": [
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "Json",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "Jira",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "GitHub",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "Gitlab",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "BitBucketServer",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "BitBucketCloud",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "XML",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "Azure",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "CSV",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "email",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "WEB",
            "number": "?"
          },
          {
            "project": "ProjWitManyVulnerabilities",
            "team": "CxServer",
            "channel": "PullMergeMarkdown",
            "number": "?"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team>\" and project is: \"<project>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Output Object will be created for the appropriate bug tracker channel <channel> with with vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "Analytics report should be logged correctly when CxFlow approves or fails a pull request",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Analytics logging with regards to thresholds",
        "examples": [
          {
            "scan ID": "3452124",
            "thr_high": "2",
            "thr_medium": "5",
            "thr_low": "10",
            "f_high": "4",
            "f_medium": "2",
            "f_low": "12",
            "status": "FAILURE",
            "repo url": "https://github.com/example-org/test-repo"
          },
          {
            "scan ID": "937582",
            "thr_high": "2",
            "thr_medium": "5",
            "thr_low": "10",
            "f_high": "1",
            "f_medium": "3",
            "f_low": "8",
            "status": "SUCCESS",
            "repo url": "https://github.com/example-org/test-repo"
          }
        ],
        "steps": [
          {
            "step": "Given thresholds are configured as HIGH: <thr_high>, MEDIUM: <thr_medium>, LOW: <thr_low>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 636
          },
          {
            "step": "And filters are disabled",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 638
          },
          {
            "step": "When pull request is created for a repo with URL: \"<repo url>\" in GitHub",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 639
          },
          {
            "step": "And SAST returns scan ID: <scan ID> and finding count per severity: HIGH: <f_high>, MEDIUM: <f_medium>, LOW: <f_low>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 640
          },
          {
            "step": "Then in analytics report, the operation is \"Pull Request\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 642
          },
          {
            "step": "And pullRequestStatus is \"<status>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 643
          },
          {
            "step": "And repoUrl contains encrypted \"<repo url>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 644
          },
          {
            "step": "And scanInitiator is \"SAST\", scanId is \"<scan ID>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 645
          },
          {
            "step": "And findingsMap is HIGH: <f_high>, MEDIUM: <f_medium>, LOW: <f_low>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 646
          },
          {
            "step": "And thresholds are HIGH: <thr_high>, MEDIUM: <thr_medium>, LOW: <thr_low>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 647
          }
        ]
      },
      {
        "scenario_name": "Analytics logging with regards to thresholds",
        "examples": [
          {
            "scan ID": "3452124",
            "f_high": "4",
            "f_medium": "2",
            "f_low": "12",
            "status": "SUCCESS",
            "repo url": "https://github.com/example-org/test-repo"
          },
          {
            "scan ID": "937582",
            "f_high": "1",
            "f_medium": "3",
            "f_low": "8",
            "status": "SUCCESS",
            "repo url": "https://github.com/example-org/test-repo"
          }
        ],
        "steps": [
          {
            "step": "Given SCA Scan in configured in application.yml",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 637
          },
          {
            "step": "When pull request is created for a repo with URL: \"<repo url>\" in GitHub",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 639
          },
          {
            "step": "And SCA returns scan ID: <scan ID> and finding count per severity: HIGH: <f_high>, MEDIUM: <f_medium>, LOW: <f_low>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 641
          },
          {
            "step": "Then in analytics report, the operation is \"Pull Request\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 642
          },
          {
            "step": "And pullRequestStatus is \"<status>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 643
          },
          {
            "step": "And repoUrl contains encrypted \"<repo url>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 644
          },
          {
            "step": "And scanInitiator is \"SCA\", scanId is \"<scan ID>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 645
          },
          {
            "step": "And findingsMap is HIGH: <f_high>, MEDIUM: <f_medium>, LOW: <f_low>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 646
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should fail builds and pull requests if scan exeeds threshold",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow should fail pull request if threshold-severity is exceeded",
        "examples": [
          {
            "threshold-to-use": "normal",
            "scan-findings": "exact",
            "pass-or-fail": "pass"
          },
          {
            "threshold-to-use": "normal",
            "scan-findings": "high-over",
            "pass-or-fail": "fail"
          },
          {
            "threshold-to-use": "normal",
            "scan-findings": "medium-over",
            "pass-or-fail": "fail"
          },
          {
            "threshold-to-use": "normal",
            "scan-findings": "low-over",
            "pass-or-fail": "fail"
          },
          {
            "threshold-to-use": "normal",
            "scan-findings": "no-findings",
            "pass-or-fail": "pass"
          },
          {
            "threshold-to-use": "strict",
            "scan-findings": "only-low",
            "pass-or-fail": "fail"
          },
          {
            "threshold-to-use": "N/A",
            "scan-findings": "only-low",
            "pass-or-fail": "fail"
          },
          {
            "threshold-to-use": "N/A",
            "scan-findings": "no-findings",
            "pass-or-fail": "pass"
          },
          {
            "threshold-to-use": "partial",
            "scan-findings": "high-over",
            "pass-or-fail": "pass"
          }
        ],
        "steps": [
          {
            "step": "Given the following thresholds-severities:\n| threshold-name | threshold-for-high | threshold-for-medium | threshold-for-low |\n| N/A | <omitted> | <omitted> | <omitted> |\n| strict | 0 | 0 | 0 |\n| normal | 5 | 10 | 15 |\n| partial | <omitted> | 10 | <omitted> |",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 725
          },
          {
            "step": "And the following scan findings:\n| name | high | medium | low |\n| exact | 5 | 10 | 15 |\n| high-over | more-than-5 | less-than-10 | less-than-15 |\n| medium-over | less-than-5 | more-than-10 | less-than-15 |\n| low-over | less-than-5 | less-than-10 | more-than-15 |\n| only-low | 0 | 0 | more-than-0 |\n| no-findings | 0 | 0 | 0 |",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 726
          },
          {
            "step": "When threshold-severity is configured to <threshold-to-use>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 731
          },
          {
            "step": "And scan finding is <scan-findings>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 733
          },
          {
            "step": "Then pull request should <pass-or-fail>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 734
          }
        ]
      },
      {
        "scenario_name": "CxFlow should fail pull request if exceeded threshold-score",
        "examples": [
          {
            "over-or-under": "over",
            "pass-or-fail": "fail"
          },
          {
            "over-or-under": "under",
            "pass-or-fail": "pass"
          },
          {
            "over-or-under": "exact",
            "pass-or-fail": "pass"
          }
        ],
        "steps": [
          {
            "step": "When max findings score is <over-or-under> threshold-score",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 735
          },
          {
            "step": "Then pull request should <pass-or-fail>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 734
          }
        ]
      },
      {
        "scenario_name": "CxFlow should fail if a threshold is exceeded",
        "examples": [
          {
            "type": "score",
            "pass-or-fail": "fail"
          },
          {
            "type": "count",
            "pass-or-fail": "fail"
          },
          {
            "type": "both",
            "pass-or-fail": "fail"
          },
          {
            "type": "none",
            "pass-or-fail": "pass"
          }
        ],
        "steps": [
          {
            "step": "When the following thresholds fails on <type>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 736
          },
          {
            "step": "Then pull request should <pass-or-fail>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 734
          }
        ]
      },
      {
        "scenario_name": "CxFlow should approve or fail cli build operation, depending on whether threshold is exceeded",
        "examples": [
          {
            "exist": "true",
            "exceeded": "true",
            "break": "true",
            "exit code": "11"
          },
          {
            "exist": "false",
            "exceeded": "false",
            "break": "false",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "false",
            "break": "true",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "false",
            "break": "true",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "true",
            "break": "false",
            "exit code": "11"
          }
        ],
        "steps": [
          {
            "step": "Given SCA thresholds section <exist> in cxflow configuration",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 727
          },
          {
            "step": "And SCA thresholds <exceeded> by scan findings",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 728
          },
          {
            "step": "And cx-flow.break-build property is set to <break>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 729
          },
          {
            "step": "When cxflow called with get-latest-sca-project-results cli command",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 730
          },
          {
            "step": "Then cxflow SCA should exit with the correct <exit code>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 732
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Component tests command line functionality - scan. Parameter set example:",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "test scan with unsupported repositories: bitbucket and Azure DevOps",
        "examples": [
          {
            "repository": "--bitbucket",
            "exception": "Bitbucket git clone scan not implemented"
          },
          {
            "repository": "--ado",
            "exception": "Azure DevOps git clone scan not implemented"
          }
        ],
        "steps": [
          {
            "step": "Given running scan flow",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When unsupported repository Mock <repository> which contains project CodeInjection and SAST mock",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then exception \"<exception>\" will be thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 743
          }
        ]
      },
      {
        "scenario_name": "test team name for different scan parameters: cx-project,branch,repo-name,namespace,app,multi-tenant. Using github or gitlab as a respoiroty.",
        "examples": [
          {
            "repository": "--gitlab",
            "cx-project": "CodeInjection",
            "branch": "master",
            "repo-name": "",
            "namespace": "",
            "app": "MyApp",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "CxServer"
          },
          {
            "repository": "--gitlab",
            "cx-project": "",
            "branch": "master",
            "repo-name": "",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\MyNamespace"
          },
          {
            "repository": "--gitlab",
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "",
            "app": "",
            "multi-tenant": "true",
            "OutProjectName": "MyRepoName-master",
            "teamOut": "\\CxServer"
          },
          {
            "repository": "--gitlab",
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "MyNamespace",
            "app": "",
            "multi-tenant": "false",
            "OutProjectName": "MyNamespace-MyRepoName-master",
            "teamOut": "\\CxServer"
          },
          {
            "repository": "--github",
            "cx-project": "",
            "branch": "master",
            "repo-name": "",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\MyNamespace"
          },
          {
            "repository": "--github",
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "",
            "app": "MyApp",
            "multi-tenant": "true",
            "OutProjectName": "MyRepoName-master",
            "teamOut": "\\CxServer\\MyNamespace"
          }
        ],
        "steps": [
          {
            "step": "Given repository Mock <repository> which contains project CodeInjection and SAST mock",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When project is: \"<cx-project>\" and branch=\"<branch>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 961
          },
          {
            "step": "And namespace is: \"<namespace>\" and application is \"<app>\" and multi-tenant=\"<multi-tenant>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And repo-name is \"<repo-name>\" and --repo-url is supplied",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 965
          },
          {
            "step": "Then The request sent to SAST reporitory will contain scan result with project name=\"<OutProjectName>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 966
          },
          {
            "step": "And and team \"<teamOut>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 954
          }
        ]
      },
      {
        "scenario_name": "test how excluding folders and files will change scan result",
        "examples": [
          {
            "repository": "--gitlab",
            "exclude-folders": "",
            "exclude-files": ""
          },
          {
            "repository": "--github",
            "exclude-folders": "",
            "exclude-files": ""
          }
        ],
        "steps": [
          {
            "step": "Given SAST env Mock",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When repository Mock \"<repository>\" which contains project Bookstore",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And exclude-folders is: \"<exclude-folders>\" and exclude-files is \"<exclude-files>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then The request sent to SAST will contain exclude-folder \"<exclude-folders>\" and exclude files \"<exclude-files>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 945
          }
        ]
      },
      {
        "scenario_name": "Input Validation for parameters cx-project,branch,repo-name,namespace,app",
        "examples": [
          {
            "cx-project": "CodeInjection",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "repo-type": "",
            "branch": "master",
            "repo-name": "MyReponame",
            "multi-tenant": "true",
            "exception": "No valid option was provided for driving scan"
          },
          {
            "cx-project": "",
            "namespace": "",
            "app": "MyApp",
            "repo-type": "--gitlab",
            "branch": "master",
            "repo-name": "",
            "multi-tenant": "true",
            "exception": "Namespace / RepoName / Branch are required"
          },
          {
            "cx-project": "",
            "namespace": "",
            "app": "MyApp",
            "repo-type": "--github",
            "branch": "master",
            "repo-name": "",
            "multi-tenant": "true",
            "exception": "Namespace / RepoName / Branch are required"
          }
        ],
        "steps": [
          {
            "step": "Given github repository Mock and SAST env Mock",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When project is: \"<cx-project>\" and branch=\"<branch>\" and multi-tenant \"<multi-tenant>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And namespace is: \"<namespace>\" and application is \"<app>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 964
          },
          {
            "step": "And repo-name is \"<repo-name>\" and --repo-url is supplied and source repository type <repo-type>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then exception \"<exception>\" will be thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 743
          }
        ]
      },
      {
        "scenario_name": "test incremental scan flow",
        "examples": [
          {
            "repository": "--github",
            "incrementalIn": "incremental",
            "incrementalOut": "inc"
          },
          {
            "repository": "--gitlab",
            "incrementalIn": "incremental",
            "incrementalOut": "inc"
          },
          {
            "repository": "--github",
            "incrementalIn": "",
            "incrementalOut": ""
          },
          {
            "repository": "--gitlab",
            "incrementalIn": "",
            "incrementalOut": ""
          }
        ],
        "steps": [
          {
            "step": "Given SAST env Mock",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When repository \"<repository>\" which contains project \"<cx-project>\" CodeInjectionIncremental",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And running with incremental flag \"<incrementalIn>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then The request sent to SAST will contain parameter incremental \"<incrementalOut>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "generate SAST scan for a preset which is supplied or calculated",
        "examples": [
          {
            "preset": "Checkmarx Default",
            "PresetToSAST": "Checkmarx Default"
          },
          {
            "preset": "XSS and SQLi only",
            "PresetToSAST": "XSS and SQLi only"
          },
          {
            "preset": "Empty preset",
            "PresetToSAST": "Empty preset"
          },
          {
            "preset": "",
            "PresetToSAST": "someCalculatedPreset"
          }
        ],
        "steps": [
          {
            "step": "Given SAST env Mock",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When preset is \"<preset>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 944
          },
          {
            "step": "Then SAST request object will contain \"<PresetToSAST>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should fail builds and pull requests if the number of findings with certain severity is above threshold",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow should approve or fail GitHub pull request, depending on whether threshold is exceeded",
        "examples": [
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "2",
            "medium count": "10",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "2",
            "medium count": "6",
            "low count": "20",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "3",
            "medium count": "8",
            "low count": "15",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "high threshold": "0",
            "medium threshold": "0",
            "low threshold": "0",
            "high count": "0",
            "medium count": "0",
            "low count": "1",
            "approves or fails": "fails"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "20",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "<omitted>",
            "low threshold": "15",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "<omitted>",
            "high count": "2",
            "medium count": "6",
            "low count": "10",
            "approves or fails": "approves"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "<omitted>",
            "low threshold": "<omitted>",
            "high count": "0",
            "medium count": "6",
            "low count": "10",
            "approves or fails": "fails"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "<omitted>",
            "low threshold": "<omitted>",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          }
        ],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"<high threshold>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"<medium threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"<low threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And no severity filter is specified",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 720
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on GitHub",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 722
          }
        ]
      },
      {
        "scenario_name": "CxFlow should approve or fail Azure Devops pull request, depending on whether threshold is exceeded",
        "examples": [
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "2",
            "medium count": "10",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "2",
            "medium count": "6",
            "low count": "20",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "3",
            "medium count": "8",
            "low count": "15",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "high threshold": "0",
            "medium threshold": "0",
            "low threshold": "0",
            "high count": "0",
            "medium count": "0",
            "low count": "1",
            "approves or fails": "fails"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "20",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "<omitted>",
            "low threshold": "15",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "<omitted>",
            "high count": "2",
            "medium count": "6",
            "low count": "10",
            "approves or fails": "approves"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "<omitted>",
            "low threshold": "<omitted>",
            "high count": "0",
            "medium count": "6",
            "low count": "10",
            "approves or fails": "fails"
          },
          {
            "high threshold": "<omitted>",
            "medium threshold": "<omitted>",
            "low threshold": "<omitted>",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          }
        ],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"<high threshold>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"<medium threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"<low threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And no severity filter is specified",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 720
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 724
          }
        ]
      },
      {
        "scenario_name": "If blockMerge or errorMerge is not set thresholds will be ignored",
        "examples": [
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "true",
            "errorMerge": "true",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "false",
            "errorMerge": "true",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "true",
            "errorMerge": "false",
            "approves or fails": "approves"
          }
        ],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"<high threshold>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"<medium threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"<low threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And blockMerge is \"<blockMerge>\" and errorMerge is \"<errorMerge>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 723
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 724
          }
        ]
      },
      {
        "scenario_name": "If blockMerge or errorMerge is not set thresholds will be ignored",
        "examples": [
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "true",
            "errorMerge": "true",
            "approves or fails": "fails"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "false",
            "errorMerge": "true",
            "approves or fails": "approves"
          },
          {
            "high threshold": "3",
            "medium threshold": "8",
            "low threshold": "15",
            "high count": "5",
            "blockMerge": "true",
            "errorMerge": "false",
            "approves or fails": "approves"
          }
        ],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"<high threshold>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"<medium threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"<low threshold>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And blockMerge is \"<blockMerge>\" and errorMerge is \"<errorMerge>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 723
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on GitHub",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 722
          }
        ]
      },
      {
        "scenario_name": "Thresholds section is omitted",
        "examples": [
          {
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "high count": "2",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "fails"
          },
          {
            "high count": "0",
            "medium count": "4",
            "low count": "0",
            "approves or fails": "fails"
          },
          {
            "high count": "0",
            "medium count": "0",
            "low count": "1",
            "approves or fails": "fails"
          },
          {
            "high count": "2",
            "medium count": "4",
            "low count": "7",
            "approves or fails": "fails"
          }
        ],
        "steps": [
          {
            "step": "Given the whole 'thresholds' section is omitted from config",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And no severity filter is specified",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 720
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on GitHub",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 722
          }
        ]
      },
      {
        "scenario_name": "Thresholds section is omitted",
        "examples": [
          {
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "high count": "2",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "fails"
          },
          {
            "high count": "0",
            "medium count": "4",
            "low count": "0",
            "approves or fails": "fails"
          },
          {
            "high count": "0",
            "medium count": "0",
            "low count": "1",
            "approves or fails": "fails"
          },
          {
            "high count": "2",
            "medium count": "4",
            "low count": "7",
            "approves or fails": "fails"
          }
        ],
        "steps": [
          {
            "step": "Given the whole 'thresholds' section is omitted from config",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And no severity filter is specified",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 720
          },
          {
            "step": "When SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request on Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 724
          }
        ]
      },
      {
        "scenario_name": "Combining filters with threshold checks",
        "examples": [],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"3\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"5\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"10\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And severity filter is set to \"High\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 717
          },
          {
            "step": "When SAST detects 2 findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And 14 findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And 23 findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow \"approves\" the pull request on GitHub",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 722
          }
        ]
      },
      {
        "scenario_name": "Combining filters with threshold checks",
        "examples": [],
        "steps": [
          {
            "step": "Given threshold for findings of \"High\" severity is \"3\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Medium\" severity is \"5\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And threshold for findings of \"Low\" severity is \"10\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And severity filter is set to \"High\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 717
          },
          {
            "step": "When SAST detects 2 findings of \"High\" severity",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And 14 findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And 23 findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow \"approves\" the pull request on Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 724
          }
        ]
      },
      {
        "scenario_name": "CxFlow should approve or fail cli build operation, depending on whether threshold is exceeded",
        "examples": [
          {
            "exist": "true",
            "exceeded": "true",
            "findings present": "true",
            "break": "true",
            "exit code": "11"
          },
          {
            "exist": "false",
            "exceeded": "false",
            "findings present": "true",
            "break": "true",
            "exit code": "11"
          },
          {
            "exist": "false",
            "exceeded": "false",
            "findings present": "true",
            "break": "false",
            "exit code": "0"
          },
          {
            "exist": "false",
            "exceeded": "false",
            "findings present": "false",
            "break": "true",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "false",
            "findings present": "false",
            "break": "true",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "false",
            "findings present": "true",
            "break": "true",
            "exit code": "0"
          },
          {
            "exist": "true",
            "exceeded": "true",
            "findings present": "true",
            "break": "false",
            "exit code": "11"
          }
        ],
        "steps": [
          {
            "step": "Given thresholds section <exist> in cxflow configuration",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 712
          },
          {
            "step": "And thresholds <exceeded> by scan findings",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 713
          },
          {
            "step": "And scan findings are <findings present> after filter",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 718
          },
          {
            "step": "And break-build property is set to <break>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 719
          },
          {
            "step": "When cxflow called with scan cli command",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 715
          },
          {
            "step": "Then cxflow should exit with the correct <exit code>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 716
          }
        ]
      }
    ]
  },
  {
    "feature": "Processing WebHook requests from version control providers",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "High load on CxFlow due to frequent WebHook requests from GitHub",
        "examples": [],
        "steps": [
          {
            "step": "Given CxFlow is running as a service",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 737
          },
          {
            "step": "When GitHub sends WebHook requests to CxFlow 2 times per second",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then each of the requests is answered in at most 500 ms",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Component tests WinService functionality",
    "background": [],
    "scenarios": []
  },
  {
    "feature": "Cxflow generic end-2-end tests",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Check cxflow end-2-end <scan-engine> flow between <repository> webhook and <bug-tracker>",
        "examples": [
          {
            "scan-engine": "sast",
            "repository": "GitHub",
            "bug-tracker": "JIRA"
          },
          {
            "scan-engine": "sast",
            "repository": "ADO",
            "bug-tracker": "JIRA"
          },
          {
            "scan-engine": "sca",
            "repository": "GitHub",
            "bug-tracker": "JIRA"
          },
          {
            "scan-engine": "sast",
            "repository": "GitLab",
            "bug-tracker": "GitLab"
          }
        ],
        "steps": [
          {
            "step": "Given Scan engine is <scan-engine>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 855
          },
          {
            "step": "And CxFlow is running as a service",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 737
          },
          {
            "step": "And repository is <repository>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 626
          },
          {
            "step": "And bug-tracker is <bug-tracker>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 854
          },
          {
            "step": "And webhook is configured for push event",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 856
          },
          {
            "step": "When pushing a change",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 858
          },
          {
            "step": "Then bug-tracker issues are updated",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 860
          }
        ]
      },
      {
        "scenario_name": "Check cxflow pull-request end-2-end <scan-engine> of <repository>",
        "examples": [
          {
            "repository": "GitHub",
            "scan-engine": "sca"
          },
          {
            "repository": "GitHub",
            "scan-engine": "sast"
          }
        ],
        "steps": [
          {
            "step": "Given Scan engine is <scan-engine>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 855
          },
          {
            "step": "And CxFlow is running as a service",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 737
          },
          {
            "step": "And repository is <repository>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 626
          },
          {
            "step": "And webhook is configured for pull-request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 857
          },
          {
            "step": "When creating pull-request",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 859
          },
          {
            "step": "Then pull-request is updated",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 861
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow AST Integration permutation tests",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "using multiple vulnerability scanners",
        "examples": [
          {
            "scanners": "SCA",
            "sca_findings": "> 0",
            "ast_findings": "0",
            "isPublic": "true"
          },
          {
            "scanners": "SCA",
            "sca_findings": "> 0",
            "ast_findings": "0",
            "isPublic": "false"
          },
          {
            "scanners": "AST",
            "sca_findings": "0",
            "ast_findings": "> 0",
            "isPublic": "true"
          },
          {
            "scanners": "AST",
            "sca_findings": "0",
            "ast_findings": "> 0",
            "isPublic": "false"
          },
          {
            "scanners": "AST,SCA",
            "sca_findings": "> 0",
            "ast_findings": "> 0",
            "isPublic": "true"
          },
          {
            "scanners": "AST,SCA",
            "sca_findings": "> 0",
            "ast_findings": "> 0",
            "isPublic": "false"
          }
        ],
        "steps": [
          {
            "step": "Given enabled vulnerability scanners are \"<scanners>\" and repo \"<isPublic>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 748
          },
          {
            "step": "Then scan results contain populated results for all scanners",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 749
          },
          {
            "step": "And sca finding count will be \"<sca_findings>\" and ast findings count \"<ast_findings>\" will be accordingly",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 750
          }
        ]
      },
      {
        "scenario_name": "validate AST additional fields",
        "examples": [],
        "steps": [
          {
            "step": "Given enabled vulnerability scanner is AST",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 745
          },
          {
            "step": "Then scan results contain populated results for all scanners",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 749
          },
          {
            "step": "And each finding will contain AST populated description field",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 746
          },
          {
            "step": "And finding with the same queryId will have the same description and there will be a unique finding description for each queryId",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 747
          }
        ]
      },
      {
        "scenario_name": "Trying to scan with invalid credentials",
        "examples": [
          {
            "client id": "<valid-client-id>",
            "client secret": "my-wrong-secret",
            "message": "unauthorized"
          },
          {
            "client id": "my-wrong-client-id",
            "client secret": "<valid-secret>",
            "message": "unauthorized"
          },
          {
            "client id": "<valid-client-id>",
            "client secret": "<empty>",
            "message": "AST client secret wasn't provided"
          },
          {
            "client id": "<empty>",
            "client secret": "<valid-secret>",
            "message": "AST client ID wasn't provided"
          }
        ],
        "steps": [
          {
            "step": "When CxFlow tries to start AST scan with the \"<client id>\" and \"<client secret>\" credentials",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 740
          },
          {
            "step": "Then an error will be thrown with the message containing \"<message>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 742
          }
        ]
      },
      {
        "scenario_name": "AST is not accessible",
        "examples": [
          {
            "url": "not a url!"
          },
          {
            "url": "<sast url>"
          },
          {
            "url": "https://example.com"
          },
          {
            "url": "<ast url>/nonexistent/path"
          },
          {
            "url": "http://192.168.199.200"
          }
        ],
        "steps": [
          {
            "step": "When AST scan is initiated with API url: \"<url>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 741
          },
          {
            "step": "Then an exception of type \"MachinaRuntimeException\" will be thrown with the message containing \"ast scan failed\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 743
          }
        ]
      },
      {
        "scenario_name": "Publish AST results and check JIRA tickets are getting created",
        "examples": [],
        "steps": [
          {
            "step": "Given scan initiator is AST",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 751
          },
          {
            "step": "And bug tracker is JIRA",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 752
          },
          {
            "step": "When publishing new known unfiltered AST results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 753
          },
          {
            "step": "Then new JIRA tickets should be open respectively",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 754
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should read configuration from cx.config file in the root of repository",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow will mimic CX-SAST results and create tickets in the appropriate project in Azure",
        "examples": [
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "CxTest1",
            "inputNamespace": "CxNamespace",
            "outputProject": "CxTest1",
            "outputNamespace": "CxNamespace"
          },
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "CxTest2",
            "inputNamespace": "",
            "outputProject": "CxTest2",
            "outputNamespace": "cxflowtestuser"
          },
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "testsAdo",
            "inputNamespace": "",
            "outputProject": "testsAdo",
            "outputNamespace": "cxflowtestuser"
          }
        ],
        "steps": [
          {
            "step": "Given application.yml contains the Azure project \"<inputProject>\" and Asure namespace \"<inputNamespace>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 755
          },
          {
            "step": "And Scanner is SAST",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 762
          },
          {
            "step": "And commit or merge pull request is performed in github repo \"<repo>\" and branch \"<branch>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 756
          },
          {
            "step": "And project \"<outputProject>\" exists in Azure under namespace \"<outputNamespace>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 760
          },
          {
            "step": "And SAST scan produces high and medium results",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 757
          },
          {
            "step": "Then CxFlow will create appropriate tickets in project \"<outputProject>\" in namespace \"<outputNamespace>\" in Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 758
          }
        ]
      },
      {
        "scenario_name": "CxFlow will mimic AST results and create tickets in the appropriate project in Azure",
        "examples": [
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "CxTest1",
            "inputNamespace": "CxNamespace",
            "outputProject": "CxTest1",
            "outputNamespace": "CxNamespace"
          },
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "CxTest2",
            "inputNamespace": "",
            "outputProject": "CxTest2",
            "outputNamespace": "cxflowtestuser"
          },
          {
            "repo": "testsAdo",
            "branch": "master",
            "inputProject": "testsAdo",
            "inputNamespace": "",
            "outputProject": "testsAdo",
            "outputNamespace": "cxflowtestuser"
          }
        ],
        "steps": [
          {
            "step": "Given application.yml contains the Azure project \"<inputProject>\" and Asure namespace \"<inputNamespace>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 755
          },
          {
            "step": "And Scanner is AST",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 761
          },
          {
            "step": "And commit or merge pull request is performed in github repo \"<repo>\" and branch \"<branch>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 756
          },
          {
            "step": "And project \"<outputProject>\" exists in Azure under namespace \"<outputNamespace>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 760
          },
          {
            "step": "And SAST scan produces high and medium results",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 757
          },
          {
            "step": "Then CxFlow will create appropriate tickets in project \"<outputProject>\" in namespace \"<outputNamespace>\" in Azure",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 758
          },
          {
            "step": "And Additional fields are populated",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 759
          }
        ]
      }
    ]
  },
  {
    "feature": "GitHub webhook requests should support publishing issues to Azure DevOps [ADO]",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Publishing caused by GitHub webhook request",
        "examples": [
          {
            "webhook event": "pull request",
            "issue count": "0"
          },
          {
            "webhook event": "push",
            "issue count": "1"
          }
        ],
        "steps": [
          {
            "step": "Given issue tracker is ADO",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 763
          },
          {
            "step": "And ADO doesn't contain any issues",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And CxFlow filters are disabled",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 764
          },
          {
            "step": "When GitHub notifies CxFlow about a \"<webhook event>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 765
          },
          {
            "step": "And SAST scan returns a report with 1 finding",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 766
          },
          {
            "step": "And CxFlow publishes the report",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 767
          },
          {
            "step": "Then ADO contains <issue count> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 768
          }
        ]
      }
    ]
  },
  {
    "feature": "Parsing SAST report and publishing items to Azure DevOps",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Creating a single issue after merging several findings",
        "examples": [
          {
            "finding count": "0",
            "issue count": "0"
          },
          {
            "finding count": "1",
            "issue count": "1"
          },
          {
            "finding count": "2",
            "issue count": "1"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps doesn't contain any issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains <finding count> findings with the same vulnerability type and in the same file, and not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 784
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains <issue count> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 780
          }
        ]
      },
      {
        "scenario_name": "Creating separate issues from several findings",
        "examples": [],
        "steps": [
          {
            "step": "Given Azure DevOps doesn't contain any issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 2 findings, each with a different vulnerability type and filename, and not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 785
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 2 issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Don't create a new issue if all findings are false positive",
        "examples": [],
        "steps": [
          {
            "step": "Given Azure DevOps doesn't contain any issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 3 findings, all marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 786
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps doesn't contain any issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Updating an existing issue",
        "examples": [
          {
            "title": "CX Reflected_XSS_All_Clients @ DOS_Login.java [master]",
            "vulnerability": "Reflected_XSS_All_Clients",
            "filename": "DOS_Login.java",
            "link1": "http://initial.url",
            "link2": "http://CX-FLOW-CLEAN/CxWebClient/ViewerMain.aspx?scanid=1000026&projectid=6"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps initially contains 1 open issue with title: \"<title>\" and description containing link: \"<link1>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 1 finding with vulnerability type \"<vulnerability>\", filename \"<filename>\", link \"<link2>\", and not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 788
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 1 open issue with title: \"<title>\" and description containing link: \"<link2>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Reopening closed issues",
        "examples": [
          {
            "title": "CX Reflected_XSS_All_Clients @ DOS_Login.java [master]",
            "vulnerability": "Reflected_XSS_All_Clients",
            "filename": "DOS_Login.java"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps initially contains 1 \"closed\" issue with title: \"<title>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 1 finding with vulnerability type \"<vulnerability>\" and filename \"<filename>\", not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 787
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 1 issue with the title \"<title>\" and \"Active\" state",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Closing an existing issue if its finding no longer exists in SAST report",
        "examples": [
          {
            "title": "CX Mega_Vulnerability @ Gotcha.java [master]"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps initially contains 1 \"open\" issue with title: \"<title>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 1 finding with vulnerability type \"Reflected_XSS_All_Clients\" and filename \"DOS_Login.java\", not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 787
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 2 issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And an issue with the title \"<title>\" is in \"Closed\" state",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 791
          }
        ]
      },
      {
        "scenario_name": "Closing an existing issue if all its findings are false positive",
        "examples": [
          {
            "title": "CX SQL_Injection @ TestFile.java [master]",
            "vulnerability": "SQL_Injection",
            "filename": "DOS_Login.java"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps initially contains 1 \"open\" issue with title: \"<title>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And SAST report contains 2 findings with vulnerability type \"<vulnerability>\", filename \"<filename>\" and marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 789
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 1 issue with the title \"<title>\" and \"Closed\" state",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Closing only relevant issues",
        "examples": [
          {
            "title1": "CX Reflected_XSS_All_Clients @ DOS_Login.java [master]",
            "title2": "CX SQL_Injection @ TestFile.java [master]",
            "vulnerability1": "Reflected_XSS_All_Clients",
            "filename1": "DOS_Login.java"
          }
        ],
        "steps": [
          {
            "step": "Given Azure DevOps initially contains 2 open issues with titles \"<title1>\" and \"<title2>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 779
          },
          {
            "step": "And SAST report contains 1 finding with vulnerability type \"<vulnerability1>\" and filename \"<filename1>\", not marked as false positive",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 787
          },
          {
            "step": "When publishing the report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Azure DevOps contains 2 issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And one of the issues has the title: \"<title1>\" and is in \"Active\" state",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And the other issue has the title: \"<title2>\" and is in \"Closed\" state",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Azure DevOps is unreachable",
        "examples": [],
        "steps": [
          {
            "step": "Given invalid Azure DevOps URL is provided in configuration",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 792
          },
          {
            "step": "When publishing a SAST report",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then CxFlow should throw \"org.springframework.web.client.ResourceAccessException\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 793
          }
        ]
      }
    ]
  },
  {
    "feature": "AST support in CxFlow command-line",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "AST CLI scan of a local directory",
        "examples": [
          {
            "scanner": "AST",
            "issueNumber": "38",
            "projectName": "ast-cli-test"
          },
          {
            "scanner": "AST,SCA",
            "issueNumber": "43",
            "projectName": "ast-cli-with-sca"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is <scanner>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 626
          },
          {
            "step": "And source directory contains vulnerable files",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 770
          },
          {
            "step": "When running CxFlow with `scan local sources` option and <projectName>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 775
          },
          {
            "step": "Then bug tracker contains <issueNumber> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 774
          },
          {
            "step": "And no exception is thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 776
          }
        ]
      },
      {
        "scenario_name": "Running a AST scan with break-build enabled and command line arguments",
        "examples": [
          {
            "issue-type": "missing-mandatory-parameter",
            "exit-code-number": "1"
          },
          {
            "issue-type": "missing-project",
            "exit-code-number": "2"
          }
        ],
        "steps": [
          {
            "step": "When running a AST scan with break-build on <issue-type>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 771
          },
          {
            "step": "Then run should exit with exit code <exit-code-number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 772
          }
        ]
      },
      {
        "scenario_name": "AST CLI scan of github repo",
        "examples": [
          {
            "scanner": "AST",
            "number of issue": "12"
          },
          {
            "scanner": "AST,SCA",
            "number of issue": "24"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is <scanner>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 626
          },
          {
            "step": "And repository is github",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 773
          },
          {
            "step": "Then bug tracker contains <number of issue> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 774
          }
        ]
      }
    ]
  },
  {
    "feature": "Check integration with iast - stop scan and create jira issue by CLI/Jenikns",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "test cli runner",
        "examples": [
          {
            "scanTag": "cx-scan-1",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": ""
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": ""
          },
          {
            "scanTag": "cx-scan-3",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "1",
            "params": ""
          },
          {
            "scanTag": "cx-scan-4",
            "bug tracker": "jira",
            "filter-severity": "HIGH",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "0",
            "params": ""
          },
          {
            "scanTag": "cx-scan-5",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": ""
          },
          {
            "scanTag": "cx-scan-6",
            "bug tracker": "jira",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "1",
            "params": ""
          },
          {
            "scanTag": "cx-scan-7",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": ""
          },
          {
            "scanTag": "cx-scan-8",
            "bug tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": ""
          },
          {
            "scanTag": "cx-scan-9",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-10",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-11",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "1",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-12",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "0",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-13",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-14",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "1",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-15",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-16",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--github"
          },
          {
            "scanTag": "cx-scan-17",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-18",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-19",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "1",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-20",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "0",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-21",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-22",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "1",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-22",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-23",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--gitlab"
          },
          {
            "scanTag": "cx-scan-1",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "1",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH",
            "thresholds severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "exit code": "0",
            "create issue": "0",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "exit code": "10",
            "create issue": "1",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "exit code": "10",
            "create issue": "2",
            "params": "--ado"
          },
          {
            "scanTag": "cx-scan-2",
            "bug tracker": "CUSTOM",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds severity": "HIGH=-1,INFO=-1",
            "exit code": "0",
            "create issue": "2",
            "params": "--ado"
          }
        ],
        "steps": [
          {
            "step": "Given mock services \"<scanTag>\" \"<filter-severity>\" \"<thresholds severity>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 799
          },
          {
            "step": "Given mock CLI runner \"<scanTag>\" \"<bug tracker>\" \"<params>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 794
          },
          {
            "step": "When running cli \"<exit code>\" \"<scanTag>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 795
          },
          {
            "step": "Then check how many create issue \"<create issue>\" \"<bug tracker>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 810
          }
        ]
      },
      {
        "scenario_name": "test web runner",
        "examples": [
          {
            "scan-tag": "cx-scan-1",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "INVALID",
            "status-code": "403",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "btProject",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-1",
            "bug-tracker": "\" \"",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "400",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "btProject",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-1",
            "bug-tracker": "INVALID",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "400",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "btProject",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "\" \"",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "400",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "btProject",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-1",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-2",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-3",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-4",
            "bug-tracker": "jira",
            "filter-severity": "HIGH",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-5",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-6",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-7",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-8",
            "bug-tracker": "jira",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-9",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-10",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-11",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-12",
            "bug-tracker": "github",
            "filter-severity": "HIGH",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-13",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-14",
            "bug-tracker": "github",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-15",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-16",
            "bug-tracker": "github",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": "reponame"
          },
          {
            "scan-tag": "cx-scan-17",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-18",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-19",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-20",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH",
            "thresholds-severity": "HIGH=-1,MEDIUM=-1,LOW=-1,INFO=-1",
            "create-issue": "0",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-21",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-22",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=-1,INFO=-1",
            "create-issue": "1",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-22",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,MEDIUM=1,LOW=1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "500",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          },
          {
            "scan-tag": "cx-scan-23",
            "bug-tracker": "gitlab",
            "filter-severity": "HIGH,MEDIUM,LOW,INFO",
            "thresholds-severity": "HIGH=-1,INFO=-1",
            "create-issue": "2",
            "request-token": "xxxx",
            "status-code": "200",
            "project-id": "1234",
            "namespace": "ns",
            "assignee": "email@server.com",
            "bug-tracker-project": "",
            "repo-name": ""
          }
        ],
        "steps": [
          {
            "step": "Given mock services \"<scan-tag>\" \"<filter-severity>\" \"<thresholds-severity>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 799
          },
          {
            "step": "When I am using these parameters <project-id> <namespace> <assignee> <bug-tracker-project> <repo-name>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 796
          },
          {
            "step": "And I do a request to bug tracker <bug-tracker> using this scan tag <scan-tag> and this request token <request-token>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 797
          },
          {
            "step": "Then the status code should be equals to <status-code>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 798
          },
          {
            "step": "And check how many create issue <create-issue> <bug-tracker>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 810
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow CLI SAST Integration tests",
    "background": [
      {
        "step": "Given repository is github-sast",
        "original_keyword": "Given",
        "keyword": "Given",
        "template": "repository is github-sast",
        "simple_template": "repository is github-sast",
        "regex_to_link_to_step": "^repository\\ is\\ github\\-sast$",
        "step_definition_id": 800
      }
    ],
    "scenarios": [
      {
        "scenario_name": "Testing cli filter functionality",
        "examples": [
          {
            "filter": "no-filter",
            "number of issue": "x+y+z",
            "return code": "11"
          },
          {
            "filter": "no-filter",
            "number of issue": "x+y+z",
            "return code": "11"
          },
          {
            "filter": "filter-High-and-Medium",
            "number of issue": "x+y",
            "return code": "11"
          },
          {
            "filter": "filter-High-and-Medium",
            "number of issue": "x+y",
            "return code": "11"
          },
          {
            "filter": "filter-only-Medium",
            "number of issue": "y",
            "return code": "11"
          },
          {
            "filter": "filter-invalid-cwe",
            "number of issue": "0",
            "return code": "0"
          }
        ],
        "steps": [
          {
            "step": "Given code has x High, y Medium and z low issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 805
          },
          {
            "step": "When running sast scan <filter>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 806
          },
          {
            "step": "Then bugTracker contains <number of issue> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 807
          },
          {
            "step": "And cxflow should exit with exit code: <return code>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 804
          }
        ]
      },
      {
        "scenario_name": "Testing break-build functionality",
        "examples": [
          {
            "issue-type": "success",
            "exit-code-number": "0"
          },
          {
            "issue-type": "missing-mandatory-parameter",
            "exit-code-number": "1"
          },
          {
            "issue-type": "error-processing-request",
            "exit-code-number": "10"
          }
        ],
        "steps": [
          {
            "step": "When running with break-build on <issue-type>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 801
          },
          {
            "step": "Then cxflow should exit with exit code: <exit-code-number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 804
          }
        ]
      },
      {
        "scenario_name": "Testing SAST scans with bugTracker None",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is set to 'None'",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When running cxflow to execute SAST scan",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 802
          },
          {
            "step": "Then cxflow should not wait for scan results",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 803
          },
          {
            "step": "And cxflow should exit with exit code: 0",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Testing cli filter functionality",
        "examples": [
          {
            "filter": "no-filter",
            "number of issue": "x+y+z",
            "return code": "11",
            "enabledZipScan": "not set"
          },
          {
            "filter": "no-filter",
            "number of issue": "x+y+z",
            "return code": "11",
            "enabledZipScan": "false"
          },
          {
            "filter": "no-filter",
            "number of issue": "x+y+z",
            "return code": "11",
            "enabledZipScan": "true"
          }
        ],
        "steps": [
          {
            "step": "Given code has x High, y Medium and z low issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 805
          },
          {
            "step": "When running sast scan <filter>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 806
          },
          {
            "step": "Then bugTracker contains <number of issue> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 807
          },
          {
            "step": "And cxflow should exit with exit code: <return code>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 804
          },
          {
            "step": "And and enabledZipScan is set to \"<enabledZipScan>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 808
          }
        ]
      }
    ]
  },
  {
    "feature": "SCA support in CxFlow command-line",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "SCA CLI scan of a local directory",
        "examples": [],
        "steps": [
          {
            "step": "Given source directory contains vulnerable files",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 770
          },
          {
            "step": "When running CxFlow with `scan local sources` options",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 822
          },
          {
            "step": "Then bug tracker contains some issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And no exception is thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 776
          }
        ]
      },
      {
        "scenario_name": "Testing break-build functionality",
        "examples": [
          {
            "expected-scenario": "success",
            "exit-code-number": "0"
          },
          {
            "expected-scenario": "break-build",
            "exit-code-number": "11"
          },
          {
            "expected-scenario": "missing-mandatory-parameter",
            "exit-code-number": "1"
          },
          {
            "expected-scenario": "missing-project",
            "exit-code-number": "2"
          },
          {
            "expected-scenario": "error-processing-request",
            "exit-code-number": "10"
          }
        ],
        "steps": [
          {
            "step": "When running a SCA scan with <expected-scenario> input",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 813
          },
          {
            "step": "Then run should exit with exit code <exit-code-number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 772
          }
        ]
      },
      {
        "scenario_name": "Testing cli filter functionality",
        "examples": [
          {
            "filter": "none",
            "number of issue": "19"
          },
          {
            "filter": "High",
            "number of issue": "7"
          },
          {
            "filter": "Medium,Low",
            "number of issue": "12"
          },
          {
            "filter": "Low",
            "number of issue": "2"
          }
        ],
        "steps": [
          {
            "step": "Given code has 6 High, 11 Medium and 1 low issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 812
          },
          {
            "step": "When running sca scan <filter>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 816
          },
          {
            "step": "Then bug tracker contains <number of issue> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 774
          }
        ]
      },
      {
        "scenario_name": "Publishing latest scan results",
        "examples": [
          {
            "latest count": "0"
          },
          {
            "latest count": "5"
          },
          {
            "latest count": "12"
          }
        ],
        "steps": [
          {
            "step": "Given previous scan for a SCA project contains 2 findings",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And last scan for the project contains <latest count> findings",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 818
          },
          {
            "step": "When running CxFlow with `publish latest scan results` options",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 820
          },
          {
            "step": "Then bug tracker contains <latest count> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 774
          }
        ]
      },
      {
        "scenario_name": "Trying to publish latest scan results for a non-existent project",
        "examples": [],
        "steps": [
          {
            "step": "Given the \"ci-non-existent-project-test\" project doesn't exist in SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When running CxFlow with `publish latest scan results` options",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 820
          },
          {
            "step": "Then bug tracker contains no issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And no exception is thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 776
          }
        ]
      },
      {
        "scenario_name": "Trying to publish latest scan results for a project with no scans",
        "examples": [],
        "steps": [
          {
            "step": "Given the \"ci-project-no-scans-test\" project exists in SCA but doesn't have any scans",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When running CxFlow with `publish latest scan results` options",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 820
          },
          {
            "step": "Then bug tracker contains no issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And no exception is thrown",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 776
          }
        ]
      },
      {
        "scenario_name": "While publishing latest scan results, CxFlow must respect SCA filters",
        "examples": [
          {
            "filters": "Medium",
            "expected issue count": "3"
          },
          {
            "filters": "Medium,Low",
            "expected issue count": "3"
          },
          {
            "filters": "none",
            "expected issue count": "55"
          }
        ],
        "steps": [
          {
            "step": "Given last scan for a project \"ci-sca-cli-integration-tests\" contains 50 High, 3 Medium and 1 Low-severity findings",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 815
          },
          {
            "step": "When run CxFlow with `publish latest scan results` options and <filters>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 821
          },
          {
            "step": "Then bug tracker contains <expected issue count> issues",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 774
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow integration with CodeBashing APIs",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Testing CxFlow add the correct lesson path per CWE",
        "examples": [
          {
            "CodeBashing Configuration Exist": "true",
            "bugTracker type": "JIRA",
            "type": "SQL_Injection",
            "CWE": "89",
            "lesson path": "courses/java/lessons/sql_injection"
          },
          {
            "CodeBashing Configuration Exist": "true",
            "bugTracker type": "JIRA",
            "type": "Reflected_XSS",
            "CWE": "79",
            "lesson path": "courses/java/lessons/reflected_xss"
          },
          {
            "CodeBashing Configuration Exist": "false",
            "bugTracker type": "JIRA",
            "type": "SQL_Injection",
            "CWE": "89",
            "lesson path": "default"
          },
          {
            "CodeBashing Configuration Exist": "true",
            "bugTracker type": "GitLab",
            "type": "SQL_Injection",
            "CWE": "89",
            "lesson path": "courses/java/lessons/sql_injection"
          },
          {
            "CodeBashing Configuration Exist": "true",
            "bugTracker type": "GitLab",
            "type": "Reflected_XSS",
            "CWE": "79",
            "lesson path": "courses/java/lessons/reflected_xss"
          },
          {
            "CodeBashing Configuration Exist": "false",
            "bugTracker type": "GitLab",
            "type": "SQL_Injection",
            "CWE": "89",
            "lesson path": "default"
          }
        ],
        "steps": [
          {
            "step": "Given CxFlow uses Bug-Tracker type <bugTracker type>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 826
          },
          {
            "step": "And CodeBashing tenant base url <CodeBashing Configuration Exist>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 825
          },
          {
            "step": "When CxFlow parsing SAST results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 824
          },
          {
            "step": "And CxFlow finds a ticket with specific <type> and <CWE>",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 827
          },
          {
            "step": "Then CxFlow should add the correct <lesson path> to the ticket",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 828
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should read configuration from a remote repo",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow should read vulnerability scanner configuration from a remote repo and initialize the scanner's config with the right values",
        "examples": [
          {
            "scanner": "ast"
          },
          {
            "scanner": "sca"
          }
        ],
        "steps": [
          {
            "step": "Given github repo contains a Checkmarx configuration",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 829
          },
          {
            "step": "When initializing config provider",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 830
          },
          {
            "step": "And getting \"<scanner>\" config provider configuration",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 831
          },
          {
            "step": "Then \"<scanner>\" configuration on Cx-Flow side should match the remote repo configuration data",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 832
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow can get a different bug tracker implementation from config-as-code configuration file.",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Cx Flow receives a pull request webhook, and in the config-as-code configuration file, GitHub is defined as bug tracker. bug tracker should be GITHUBPULL",
        "examples": [],
        "steps": [
          {
            "step": "Given github branch is udi-tests",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 847
          },
          {
            "step": "When pull request webhook arrives",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 848
          },
          {
            "step": "Then scan request should have GITHUBPULL bug tracker",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 851
          }
        ]
      },
      {
        "scenario_name": "CxFlow receives a push event and in the config-as-code configuration file, GitHub is defined as bug tracker, bug tracker should be GitHub",
        "examples": [],
        "steps": [
          {
            "step": "Given github branch is udi-tests",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 847
          },
          {
            "step": "When push event arrives",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 849
          },
          {
            "step": "Then scan request should have GitHub bug tracker",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 850
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should read configuration from cx.config file in the root of repository",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow should approve or fail GitHub pull request, depending on whether threshold is exceeded in cx.config",
        "examples": [
          {
            "branch": "test1",
            "high count": "5",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test1",
            "high count": "2",
            "medium count": "10",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test1",
            "high count": "2",
            "medium count": "6",
            "low count": "20",
            "approves or fails": "fails"
          },
          {
            "branch": "test1",
            "high count": "3",
            "medium count": "8",
            "low count": "15",
            "approves or fails": "approves"
          },
          {
            "branch": "test1",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "branch": "test2",
            "high count": "20",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "branch": "test3",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "branch": "test4",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test4",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          },
          {
            "branch": "test5",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test5",
            "high count": "0",
            "medium count": "0",
            "low count": "0",
            "approves or fails": "approves"
          }
        ],
        "steps": [
          {
            "step": "Given github branch is \"<branch>\" and thresholds section is not set application.yml",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 837
          },
          {
            "step": "And SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 722
          }
        ]
      },
      {
        "scenario_name": "CxFlow should approve or fail GitHub pull request, depending on whether threshold is exceeded in cx.config",
        "examples": [
          {
            "branch": "test1",
            "app_high": "6",
            "app_medium": "7",
            "app_low": "10",
            "high count": "5",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test1",
            "app_high": "2",
            "app_medium": "2",
            "app_low": "2",
            "high count": "3",
            "medium count": "8",
            "low count": "15",
            "approves or fails": "approves"
          },
          {
            "branch": "test2",
            "app_high": "5",
            "app_medium": "",
            "app_low": "",
            "high count": "20",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "branch": "test3",
            "app_high": "",
            "app_medium": "5",
            "app_low": "",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "approves"
          },
          {
            "branch": "test4",
            "app_high": "2",
            "app_medium": "5",
            "app_low": "10",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          },
          {
            "branch": "test5",
            "app_high": "2",
            "app_medium": "5",
            "app_low": "10",
            "high count": "2",
            "medium count": "6",
            "low count": "8",
            "approves or fails": "fails"
          }
        ],
        "steps": [
          {
            "step": "Given application.xml contains high thresholds \"<app_high>\" medium thresholds \"<app_medium>\" and low thresholds \"<app_low>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 840
          },
          {
            "step": "And github branch is \"<branch>\" with cx.config",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 838
          },
          {
            "step": "And SAST detects <high count> findings of \"High\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 721
          },
          {
            "step": "And <medium count> findings of \"Medium\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "And <low count> findings of \"Low\" severity",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 714
          },
          {
            "step": "Then CxFlow \"<approves or fails>\" the pull request and cx.config truncates the data in application.yml",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 846
          }
        ]
      },
      {
        "scenario_name": "CxFlow will show results as per filters section cx.config",
        "examples": [
          {
            "branch": "test7",
            "app_filter": "severity,category"
          },
          {
            "branch": "test8",
            "app_filter": ""
          },
          {
            "branch": "test9",
            "app_filter": ""
          },
          {
            "branch": "test7",
            "app_filter": "severity,cwe"
          },
          {
            "branch": "test8",
            "app_filter": "severity,category"
          },
          {
            "branch": "test10",
            "app_filter": ""
          },
          {
            "branch": "test11",
            "app_filter": "severity,category,cwe"
          }
        ],
        "steps": [
          {
            "step": "Given application.xml contains filters section with filter type \"<app_filter>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 841
          },
          {
            "step": "And github branch is \"<branch>\" with cx.config",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 838
          },
          {
            "step": "Then CxFlow will return results as per the filter in cx.config",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 844
          }
        ]
      },
      {
        "scenario_name": "CxFlow will fail when cx.config format is invalid",
        "examples": [
          {
            "branch": "test12"
          }
        ],
        "steps": [
          {
            "step": "Given github branch is \"<branch>\" with invalid cx.config",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 839
          },
          {
            "step": "Then CxFlow will ignore the cxconfig and take all the values from application.yml",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 845
          }
        ]
      },
      {
        "scenario_name": "Cx-Flow will set sca configuration sections according to the cx.config file",
        "examples": [],
        "steps": [
          {
            "step": "Given cx-flow has a scan request",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 976
          },
          {
            "step": "When target repo contains a configuration file",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 977
          },
          {
            "step": "Then cx-flow configurations properties are getting overridden with the following parameters:\n| vulnerabilityScanners |\n| thresholdsSeverity |\n| thresholdsScore |\n| filterSeverity |\n| filterScore |",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 978
          }
        ]
      },
      {
        "scenario_name": "CxFlow should use config-as-code from a correct branch",
        "examples": [
          {
            "use default": "true",
            "branch": "master"
          },
          {
            "use default": "false",
            "branch": "test1"
          }
        ],
        "steps": [
          {
            "step": "Given use-config-as-code-from-default-branch property in application.yml is set to \"<use default>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 833
          },
          {
            "step": "And GitHub repo default branch is \"master\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 834
          },
          {
            "step": "When GitHub notifies CxFlow that a pull request was created for the \"test1\" branch",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 835
          },
          {
            "step": "Then CxFlow should get config-as-code from the \"<branch>\" branch",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 836
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow CxGo Integration tests",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Test CxFlow pull request scan flow with CxGo",
        "examples": [
          {
            "scm": "Github",
            "exceeded": "false",
            "pull request status": "success"
          },
          {
            "scm": "Github",
            "exceeded": "true",
            "pull request status": "failure"
          }
        ],
        "steps": [
          {
            "step": "Given SCM type is <scm>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 862
          },
          {
            "step": "And Pull Request is opened in repo",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 865
          },
          {
            "step": "And Thresholds set to <exceeded>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 863
          },
          {
            "step": "Then CxFlow initiate scan in CxGo",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 867
          },
          {
            "step": "And Pull request comments updated in repo and status is <pull request status>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 869
          }
        ]
      },
      {
        "scenario_name": "Test CxFlow push event scan flow with CxGo",
        "examples": [
          {
            "scm": "Github",
            "filters": "filters"
          },
          {
            "scm": "Gitlab",
            "filters": "filters"
          }
        ],
        "steps": [
          {
            "step": "Given SCM type is <scm>",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 862
          },
          {
            "step": "And Push event is sent to cxflow",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 866
          },
          {
            "step": "And Filters set to <filters>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 864
          },
          {
            "step": "Then CxFlow initiate scan in CxGo",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 867
          },
          {
            "step": "And bugTracker will be updated with tickets for filtered findings by <filters>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 868
          }
        ]
      }
    ]
  },
  {
    "feature": "parse and then publish processing given SAST XML results, findings should be open or update an issue in GitHub",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "publish results with severity filters and verify GitHub issues are getting opened",
        "examples": [
          {
            "input": "5-findings-different-vuln-same-file.xml",
            "filter-severity": "High",
            "number-of-issues": "1"
          },
          {
            "input": "5-findings-different-vuln-same-file.xml",
            "filter-severity": "High,Medium",
            "number-of-issues": "3"
          },
          {
            "input": "5-findings-different-vuln-same-file.xml",
            "filter-severity": "Low",
            "number-of-issues": "0"
          }
        ],
        "steps": [
          {
            "step": "Given bug tracker is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 877
          },
          {
            "step": "And setting filter severity as \"<filter-severity>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 878
          },
          {
            "step": "When publishing \"<input>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 753
          },
          {
            "step": "Then <number-of-issues> new issues should be opened according filters severity",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 880
          }
        ]
      },
      {
        "scenario_name": "publish results from different files and check GitHub issues are getting opened",
        "examples": [
          {
            "input": "many-findings-different-vuln-different-files.xml",
            "number-of-issues": "4"
          },
          {
            "input": "1-finding-same-file.xml",
            "number-of-issues": "1"
          }
        ],
        "steps": [
          {
            "step": "Given bug tracker is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 877
          },
          {
            "step": "When publishing results from \"<input>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 873
          },
          {
            "step": "Then <number-of-issues> new issues should be opened",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 880
          }
        ]
      },
      {
        "scenario_name": "publish results and check GitHub issue is getting updated",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 877
          },
          {
            "step": "And for a given type, there is an opened issue with multiple vulnerabilities",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 875
          },
          {
            "step": "When resolving a vulnerability",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 876
          },
          {
            "step": "Then the issue's code lines should be update",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "publish results and check GitHub issue is getting closed",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 877
          },
          {
            "step": "And for a given issue, with a given vulnerabilities",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 870
          },
          {
            "step": "When resolving all vulnerabilities for an issue",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 871
          },
          {
            "step": "Then the issues should be mark as closed",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 872
          }
        ]
      }
    ]
  },
  {
    "feature": "When there are no closed or open statuses for Jira in YML, CxFlow should auto config it from Jira",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "There are no Jira closed and open statuses defined in yml. CxFlow Should get those definitions from Jira.",
        "examples": [],
        "steps": [
          {
            "step": "Then we should have open and closed statuses in jira properties bean",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 886
          }
        ]
      }
    ]
  },
  {
    "feature": "Load testing for JIRA",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "publish SAST results that should create many issues in Jira and make sure that they are created in less than the time given",
        "examples": [
          {
            "Num_Of_Issues": "385",
            "Percents_Threshold": "95",
            "Primary_Duration_Threshold": "230",
            "Secondary_Duration_Threshold": "253",
            "samples": "1"
          },
          {
            "Num_Of_Issues": "300",
            "Percents_Threshold": "95",
            "Primary_Duration_Threshold": "180",
            "Secondary_Duration_Threshold": "198",
            "samples": "1"
          },
          {
            "Num_Of_Issues": "200",
            "Percents_Threshold": "95",
            "Primary_Duration_Threshold": "120",
            "Secondary_Duration_Threshold": "134",
            "samples": "1"
          },
          {
            "Num_Of_Issues": "100",
            "Percents_Threshold": "95",
            "Primary_Duration_Threshold": "60",
            "Secondary_Duration_Threshold": "66",
            "samples": "1"
          }
        ],
        "steps": [
          {
            "step": "Given SAST results with that should result in <Num_Of_Issues> JIRS issues",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 892
          },
          {
            "step": "When results are parsed and published <samples> times, and time is recorded for each sample",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 893
          },
          {
            "step": "Then <Percents_Threshold> percents of publish request should take less than <Primary_Duration_Threshold> seconds",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 894
          },
          {
            "step": "And the other tests should take less than <Secondary_Duration_Threshold> seconds",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 895
          }
        ]
      }
    ]
  },
  {
    "feature": "When there are no closed or open statuses for Jira in YML, CxFlow should auto config it from Jira",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "There are values for jira closed and open statuses in yml, and so they should be used",
        "examples": [],
        "steps": [
          {
            "step": "Then we should use te values from yml",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 888
          }
        ]
      }
    ]
  },
  {
    "feature": "parse, and then publish processing given SAST XML results, findings should open an issue in Jira.",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "publish new issues to JIRA, one new issue is getting created per scan vulnerability type",
        "examples": [
          {
            "Number_Of": "0"
          },
          {
            "Number_Of": "1"
          },
          {
            "Number_Of": "3"
          }
        ],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And results contain <Number_Of> findings each having a different vulnerability type in one source file",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 912
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then verify <Number_Of> new issues got created",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 924
          }
        ]
      },
      {
        "scenario_name": "publish new issue to JIRA which contains only one vulnerability type in one source file",
        "examples": [
          {
            "Number_Of": "0",
            "Total_Of": "0"
          },
          {
            "Number_Of": "1",
            "Total_Of": "1"
          },
          {
            "Number_Of": "2",
            "Total_Of": "1"
          }
        ],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And results contains <Number_Of> findings with the same type in one source file",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 913
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then verify <Total_Of> new issues got created",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 924
          },
          {
            "step": "And verify <Number_Of> findings in body",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 925
          },
          {
            "step": "And issue status will be present in the body",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 926
          }
        ]
      },
      {
        "scenario_name": "publish new issues to JIRA and filtered by a single severity - (\"High\" in this case).",
        "examples": [
          {
            "Number_Of_Total": "0",
            "Number_Of": "0"
          },
          {
            "Number_Of_Total": "1",
            "Number_Of": "1"
          },
          {
            "Number_Of_Total": "3",
            "Number_Of": "1"
          },
          {
            "Number_Of_Total": "10",
            "Number_Of": "5"
          },
          {
            "Number_Of_Total": "10",
            "Number_Of": "10"
          }
        ],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there are <Number_Of_Total> findings from which <Number_Of> results match the filter",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 905
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then verify <Number_Of> new issues got created",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 924
          }
        ]
      },
      {
        "scenario_name": "sanity of publishing new issues to JIRA, with filter that may contain multiple severities.",
        "examples": [
          {
            "Filter_Severity": "High",
            "High_Vulnerabilities_Expected": "2",
            "Medium_Vulnerabilities_Expected": "0",
            "Low_Vulnerabilities_Expected": "0",
            "Info_Vulnerabilities_Expected": "0"
          },
          {
            "Filter_Severity": "High,Medium",
            "High_Vulnerabilities_Expected": "2",
            "Medium_Vulnerabilities_Expected": "10",
            "Low_Vulnerabilities_Expected": "0",
            "Info_Vulnerabilities_Expected": "0"
          },
          {
            "Filter_Severity": "High,Low",
            "High_Vulnerabilities_Expected": "2",
            "Medium_Vulnerabilities_Expected": "0",
            "Low_Vulnerabilities_Expected": "19",
            "Info_Vulnerabilities_Expected": "0"
          }
        ],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And filter-severity is <Filter_Severity>",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 906
          },
          {
            "step": "And using sanity findings",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 907
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then verify results contains <High_Vulnerabilities_Expected>, <Medium_Vulnerabilities_Expected>, <Low_Vulnerabilities_Expected>, <Info_Vulnerabilities_Expected> for severities <Filter_Severity>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 922
          }
        ]
      },
      {
        "scenario_name": "updating an existing JIRA issue during publish",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there is an existing issue",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 908
          },
          {
            "step": "And SAST results contain 1 finding, with the same vulnerability type and filename",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 909
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then JIRA still contains 1 issue",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 917
          },
          {
            "step": "And issue ID hasn't changed",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And issue's updated field is set to a more recent timestamp",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And issue has the same vulnerability type and filename",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 916
          }
        ]
      },
      {
        "scenario_name": "updating an existing JIRA issue during publish",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there is an existing issue",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 908
          },
          {
            "step": "And there is status change in the issue",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 918
          },
          {
            "step": "And SAST results contain 1 finding, with the same vulnerability type and filename",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 909
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then JIRA still contains 1 issue",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 917
          },
          {
            "step": "And issue ID hasn't changed",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And issue's updated field is set to a more recent timestamp",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And issue has the same vulnerability type and filename",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 916
          },
          {
            "step": "And the updated issue has the new status field in the body",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 919
          },
          {
            "step": "And the updated issue has a recommended fix link",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 920
          }
        ]
      },
      {
        "scenario_name": "publish updated issue to JIRA with different parameters",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there is an existing issue",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 908
          },
          {
            "step": "When publishing same issue with different parameters",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 910
          },
          {
            "step": "Then original issues is updated both with 'last updated' value and with new body content",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "publish closed issue to JIRA",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there is an existing issue",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 908
          },
          {
            "step": "When all issue's findings are false-positive",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then the issue should be closed",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 921
          }
        ]
      },
      {
        "scenario_name": "two issues exists in jira. SAST findings contains only one of them, and after publish one should be closed.",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And there are two existing issues",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 914
          },
          {
            "step": "And SAST result contains only one of the findings",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 915
          },
          {
            "step": "When publishing results to JIRA",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 911
          },
          {
            "step": "Then there should be one closed and one open issue",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 923
          }
        ]
      },
      {
        "scenario_name": "Perform a GET REST call to unreachable JIRA environment",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And JIRA is configured with invalid URL",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 901
          },
          {
            "step": "When preparing a getIssues call to deliver",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 902
          },
          {
            "step": "Then the call execution should throw a JiraClientRunTimeException since JIRA is un-accessible",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 903
          }
        ]
      },
      {
        "scenario_name": "Fail to publish tickets to JIRA environment",
        "examples": [],
        "steps": [
          {
            "step": "Given target is JIRA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 900
          },
          {
            "step": "And Cx-Flow is configured with invalid project key",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 889
          },
          {
            "step": "When preparing results to deliver",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 890
          },
          {
            "step": "Then the call execution should throw a JiraClientRunTimeException since an error occurred when published new tickets",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 891
          }
        ]
      },
      {
        "scenario_name": "Open a new ticket in Jira via command line and validate matching data in the analytics json file",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is Jira",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 883
          },
          {
            "step": "When opening a new Jira issue via the command line",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 884
          },
          {
            "step": "Then a matching ticket creation data should be recorded in the analytics json file",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 885
          }
        ]
      },
      {
        "scenario_name": "Update a current ticket in Jira via command line and validate matching data in the analytics json file",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is Jira",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 883
          },
          {
            "step": "When updating a new Jira issue via the command line",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 881
          },
          {
            "step": "Then a matching ticket updating data should be recorded in the analytics json file",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 882
          }
        ]
      },
      {
        "scenario_name": "Open new GitHub tickets while GitHub default configuration is in comment-out and an optional scm-instance is defined",
        "examples": [],
        "steps": [
          {
            "step": "Given bug tracker is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 877
          },
          {
            "step": "And GitHub optional instance configuration is defined",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 897
          },
          {
            "step": "When processing the results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 898
          },
          {
            "step": "Then new GitHub Issues should be open respectively",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 899
          }
        ]
      }
    ]
  },
  {
    "feature": "After scan that was initiated by pull request, CxFlow should update the PR comments, instead of creating new one.",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "CxFlow should create new comments on Github Pull request with scan results summary",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 930
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for comments",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 934
          },
          {
            "step": "And verify new comments",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 935
          }
        ]
      },
      {
        "scenario_name": "CxFlow should update existing comments on Github Pull request with scan results summary",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is GitHub",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 930
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "And pull request arrives to CxFlow",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 933
          },
          {
            "step": "And Wait for comments",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 934
          },
          {
            "step": "And different filters configuration is set",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 927
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for updated comment",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 936
          }
        ]
      },
      {
        "scenario_name": "CxFlow should create new comments on ADO Pull request with scan results summary",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is ADO",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 931
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for comments",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 934
          },
          {
            "step": "And verify new comments",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 935
          }
        ]
      },
      {
        "scenario_name": "ADO Pull request arrives to CxFlow, then scan is initiated, and pull request comments should be updated.",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is ADO",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 931
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "And pull request arrives to CxFlow",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 933
          },
          {
            "step": "And Wait for comments",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 934
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for comments",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 934
          },
          {
            "step": "And Wait for updated comment",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 936
          }
        ]
      },
      {
        "scenario_name": "CxFlow should create new comments on Gitlab Pull request with scan results summary",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is Gitlab",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 932
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for comments",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 934
          },
          {
            "step": "And verify new comments",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 935
          }
        ]
      },
      {
        "scenario_name": "CxFlow should update existing comments on Gitlab Pull request with scan results summary",
        "examples": [
          {
            "scanner": "sca"
          },
          {
            "scanner": "sast"
          },
          {
            "scanner": "both"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is set to \"<scanner>\"",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 929
          },
          {
            "step": "Given source control is Gitlab",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 932
          },
          {
            "step": "And no comments on pull request",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 928
          },
          {
            "step": "And pull request arrives to CxFlow",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 933
          },
          {
            "step": "And Wait for comments",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 934
          },
          {
            "step": "And different filters configuration is set",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 927
          },
          {
            "step": "When pull request arrives to CxFlow",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 933
          },
          {
            "step": "Then Wait for updated comment",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 936
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Integration tests Batch functionality - retrieve scans of existing project",
    "background": [
      {
        "step": "Given running SAST environment",
        "original_keyword": "Given",
        "keyword": "Given",
        "template": "running SAST environment",
        "simple_template": "running SAST environment",
        "regex_to_link_to_step": "^running\\ SAST\\ environment$",
        "step_definition_id": -1
      }
    ],
    "scenarios": [
      {
        "scenario_name": "retrieve SAST results for a specific for specific project",
        "examples": [
          {
            "batchMode": "--project",
            "cx-project": "CodeInjection1",
            "team": "CxServer",
            "number": "3"
          },
          {
            "batchMode": "--project",
            "cx-project": "",
            "team": "CxServer",
            "number": "exception"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team>\" and project is: \"<cx-project>\" and batch mode is <batchMode>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain the vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve last scan of a project with many scans",
        "examples": [
          {
            "batchMode": "--project",
            "number": "2"
          }
        ],
        "steps": [
          {
            "step": "Given SAST env with project CodeInjection and scans 2",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And first scan had 3 results and second scan has 2 results",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When batch mode is <batchMode>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain the vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve SAST results for a all projects of a team",
        "examples": [
          {
            "batchMode": "--batch",
            "teamIn": "\\CxServer\\MyTeam1",
            "teamOut": "\\CxServer\\MyTeam1",
            "projectList": "CodeInjection1,CodeInjection2,CodeInjection3"
          },
          {
            "batchMode": "--batch",
            "teamIn": "\\CxServer\\MyTeam2",
            "teamOut": "\\CxServer\\MyTeam2",
            "projectList": "CodeInjection4,CodeInjection5,CodeInjection6"
          },
          {
            "batchMode": "--batch",
            "teamIn": "\\CxServer",
            "teamOut": "\\CxServer\\MyTeam2",
            "projectList": "CodeInjection0"
          },
          {
            "batchMode": "--project",
            "teamIn": "\\CxServer\\MyTeam1",
            "teamOut": "\\CxServer\\MyTeam1",
            "projectList": "CodeInjection1"
          }
        ],
        "steps": [
          {
            "step": "Given SAST environment which contains project CodeInjection0 under team \\CxServer",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And 3 projects CodeInjection1,CodeInjection2,CodeInjection3 under team \\CxServer\\MyTeam1",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And 3 projects CodeInjection4,CodeInjection5,CodeInjection6 under team \\CxServer\\MyTeam2",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "But no other projects exist in SAST",
            "original_keyword": "But",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When input team is: \"<teamIn>\" and batch mode is <batchMode> and",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain projects: the following project list \"<projectList>\" under \"<teamOut>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve SAST results for all projects in SAST instance",
        "examples": [
          {
            "batchMode": "--batch",
            "teamOut": "\\CxServer\\MyTeam1",
            "project": "CodeInjection1"
          },
          {
            "batchMode": "--batch",
            "teamOut": "\\CxServer\\MyTeam1",
            "project": "CodeInjection2"
          },
          {
            "batchMode": "--batch",
            "teamOut": "\\CxServer\\MyTeam2",
            "project": "CodeInjection4"
          },
          {
            "batchMode": "--batch",
            "teamOut": "\\CxServer\\MyTeam2",
            "project": "CodeInjection5"
          },
          {
            "batchMode": "--batch",
            "teamOut": "\\CxServer",
            "project": "CodeInjection0"
          },
          {
            "batchMode": "--project",
            "teamOut": "exception - team is mandatory field",
            "project": "exception - team is mandatory field"
          }
        ],
        "steps": [
          {
            "step": "Given SAST environment which contains project CodeInjection0 under team \\CxServer",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And 3 projects CodeInjection1,CodeInjection2 under team \\CxServer\\MyTeam1",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "And 3 projects CodeInjection4,CodeInjection5 under team \\CxServer\\MyTeam2",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "But no other projects exist in SAST",
            "original_keyword": "But",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When input team not supplied and batch mode is <batchMode>",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain projects: the following project \"<project>\" under \"<teamOut>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retrieve SAST results of different size into output channels: Json, Csv, Xml",
        "examples": [
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Json",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Csv",
            "number": "0"
          },
          {
            "project": "ProjWitNoVulnerabilities",
            "team": "CxServer",
            "channel": "Xml",
            "number": "0"
          },
          {
            "project": "Android-java-2.7M",
            "team": "CxServer",
            "channel": "Json",
            "number": "100000"
          },
          {
            "project": "Android-java-2.7M",
            "team": "CxServer",
            "channel": "Csv",
            "number": "100000"
          },
          {
            "project": "Android-java-2.7M",
            "team": "CxServer",
            "channel": "Xml",
            "number": "100000"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team>\" and project is: \"<project>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then Output Object will be created for the appropriate bug tracker channel <channel> with with vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "retieve SAST results with the following filters: --filter-severity, --filter-category, --filter-status, --filter-cwe",
        "examples": [
          {
            "filter-severity": "High",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "Medium",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "3"
          },
          {
            "filter-severity": "",
            "filter-category": "SQL_Injection",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "79",
            "number": "?"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "Urgent",
            "filter-cwe": "",
            "number": "?"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "Confirmed",
            "filter-cwe": "",
            "number": "?"
          }
        ],
        "steps": [
          {
            "step": "When retrieving results for project CodeInjection with filter-severity is \"<filter-severity>\" and filter-category is \"<filter-category>\" and filter-cwe \"<filter-cwe>\" and filter-status \"<filter-status>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file will be create and will contain violations number <number> and",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "CxFlow should preserve SAST project settings if the project already exists in SAST",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Preserving SAST project settings for an existing project",
        "examples": [
          {
            "project name": "OverwritingProjectConfigTest",
            "initial preset": "High and Medium",
            "initial config": "Multi-language Scan",
            "global preset": "Checkmarx Default",
            "global config": "Default Configuration"
          }
        ],
        "steps": [
          {
            "step": "Given \"<project name>\" project exists in SAST",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 937
          },
          {
            "step": "And all of \"<initial preset>\", \"<initial config>\", \"<global preset>\", \"<global config>\" exist in SAST",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 938
          },
          {
            "step": "And project has the \"<initial preset>\" preset and the \"<initial config>\" scan configuration",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 939
          },
          {
            "step": "And CxFlow config has the \"<global preset>\" preset and the \"<global config>\" scan configuration",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 940
          },
          {
            "step": "And GitHub repository does not contain a config-as-code file",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 941
          },
          {
            "step": "When GitHub notifies CxFlow about a pull request for the \"<project name>\" project",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 942
          },
          {
            "step": "And CxFlow starts a SAST scan",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 943
          },
          {
            "step": "Then project preset is still \"<initial preset>\" and scan configuration is \"<initial config>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 944
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Component tests Parse functionality - parse report file which is result of a scan by CLI/Jenikns",
    "background": [
      {
        "step": "Given SAST running env",
        "original_keyword": "Given",
        "keyword": "Given",
        "template": "SAST running env",
        "simple_template": "SAST running env",
        "regex_to_link_to_step": "^SAST\\ running\\ env$",
        "step_definition_id": -1
      }
    ],
    "scenarios": [
      {
        "scenario_name": "parse OSA results to an output file (OSA Vulnerabilities, Osa Libraries)",
        "examples": [
          {
            "project": "OSAVulsLibs",
            "team": "CxServer",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "num"
          },
          {
            "project": "OSAVulsOnly",
            "team": "CxServer",
            "OSAVulnerailibiesNum": "num",
            "OSALibrariesNum": "0"
          },
          {
            "project": "OSALibsOnly",
            "team": "CxServer",
            "OSAVulnerailibiesNum": "0",
            "OSALibrariesNum": "num"
          }
        ],
        "steps": [
          {
            "step": "When project is: <project>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And OSALibrariesFile (--lib-file) = OSALibrariesFile and OSAVulnerailibies (--f) = OSAVulnerailibiesFile",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created that will contain the OSALibraries number <OSALibrariesNum> and OSAVulnerailibies number <OSAVulnerailibiesNum>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "parse SAST results to output file",
        "examples": [
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "preset": "Checkmarx Default",
            "number": "3"
          },
          {
            "project": "CodeInjection1",
            "team": "CxServer",
            "preset": "?",
            "number": "?"
          }
        ],
        "steps": [
          {
            "step": "When team is: \"<team>\" and project is: \"<project>\" and preset is \"<preset>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain the vulnerabilities number <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "parse SAST while applying filters: filter-severity , filter-category , filter-status , filter-cwe",
        "examples": [
          {
            "filter-severity": "High",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "Medium",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "3"
          },
          {
            "filter-severity": "",
            "filter-category": "SQL_Injection",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "79",
            "number": "?"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "Urgent",
            "filter-cwe": "",
            "number": "?"
          },
          {
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "Confirmed",
            "filter-cwe": "",
            "number": "?"
          }
        ],
        "steps": [
          {
            "step": "When filter-severity is \"<filter-severity>\" and filter-category is \"<filter-category>\" and filter-cwe \"<filter-cwe>\" and filter-status \"<filter-status>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 947
          },
          {
            "step": "Then output file is created  and will contain violations number <number> and",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "parse SAST results with custom fields and description - online/offline mode",
        "examples": [
          {
            "mode": "",
            "issueDescription": "notEmpty",
            "customFields": "notEmpty"
          },
          {
            "mode": "--offline",
            "issueDescription": "",
            "customFields": ""
          }
        ],
        "steps": [
          {
            "step": "Given SAST environment with custom fields defined",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When working in mode \"<mode>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then output file is created and will contain issue description \"<issueDescription>\" and custom fields \"<customFields>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      }
    ]
  },
  {
    "feature": "Check Integration tests command line functionality - scan.",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "retrieve SAST results with the following filters: --filter-severity, --filter-category, --filter-status, --filter-cwe",
        "examples": [
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "High",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "2"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "Medium",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "3"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "High,Medium",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "5"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "",
            "number": "5"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "",
            "filter-category": "SQL_Injection",
            "filter-status": "",
            "filter-cwe": "89",
            "number": "2"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/Code_Injection.git",
            "filter-severity": "Medium",
            "filter-category": "CGI_Reflected_XSS_All_Clients",
            "filter-status": "",
            "filter-cwe": "",
            "number": "1"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/Code_Injection.git",
            "filter-severity": "High",
            "filter-category": "CGI_Reflected_XSS_All_Clients",
            "filter-status": "",
            "filter-cwe": "79",
            "number": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/Code_Injection.git",
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "89",
            "number": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/Code_Injection.git",
            "filter-severity": "Medium",
            "filter-category": "CGI_Reflected_XSS_All_Clients,SQL_Injection",
            "filter-status": "",
            "filter-cwe": "79",
            "number": "1"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/VB_3845.git",
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "Urgent",
            "filter-cwe": "",
            "number": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/BookStoreJava",
            "filter-severity": "",
            "filter-category": "",
            "filter-status": "",
            "filter-cwe": "79,89",
            "number": "5"
          }
        ],
        "steps": [
          {
            "step": "Given there is a SAST environment configured and running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 708
          },
          {
            "step": "And running a scan for repository \"<repoUrl>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 950
          },
          {
            "step": "And filter-severity is \"<filter-severity>\" and filter-category is \"<filter-category>\" and filter-cwe \"<filter-cwe>\" and filter-status \"<filter-status>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 947
          },
          {
            "step": "Then output file will contain vulnerabilities <number>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 948
          }
        ]
      },
      {
        "scenario_name": "test which project name will be used or created for scan with parameters: cx-project,branch,repo-name,namespace,app,multi-tenant=false. Using github as a respoiroty.",
        "examples": [
          {
            "cx-project": "CodeInjection",
            "branch": "master",
            "repo-name": "",
            "namespace": "",
            "app": "MyApp",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\SP"
          },
          {
            "cx-project": "CodeInjection",
            "branch": "master",
            "repo-name": "",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\SP"
          },
          {
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "",
            "app": "MyApp",
            "OutProjectName": "MyApp",
            "teamOut": "\\CxServer\\SP"
          },
          {
            "cx-project": "",
            "branch": "master",
            "repo-name": "",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "OutProjectName": "MyApp",
            "teamOut": "\\CxServer\\SP"
          },
          {
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "MyNamespace",
            "app": "",
            "OutProjectName": "MyNamespace-MyRepoName-master",
            "teamOut": "\\CxServer\\SP"
          }
        ],
        "steps": [
          {
            "step": "Given github repository which contains project CodeInjection",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 958
          },
          {
            "step": "When project is: \"<cx-project>\" and branch=\"<branch>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 961
          },
          {
            "step": "And repo-name is \"<repo-name>\" and --repo-url is supplied and --github flag is supplied",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 965
          },
          {
            "step": "And namespace is: \"<namespace>\" and application is \"<app>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 964
          },
          {
            "step": "And team in application.yml is \\CxServer\\SP",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And multi-tenant=false",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 963
          },
          {
            "step": "Then The request sent to SAST reporitory will contain scan result with project name=\"<OutProjectName>\" and team \"<teamOut>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 966
          }
        ]
      },
      {
        "scenario_name": "test team name for different scan parameters: cx-project,branch,repo-name,namespace,app,multi-tenant=true. Using github as a respoiroty.",
        "examples": [
          {
            "cx-project": "CodeInjection",
            "branch": "master",
            "repo-name": "",
            "namespace": "",
            "app": "MyApp",
            "inputTeam": "\\CxServer\\SP",
            "teamOut": "\\CxServer\\SP",
            "OutProjectName": "CodeInjection"
          },
          {
            "cx-project": "",
            "branch": "master",
            "repo-name": "MyRepoName",
            "namespace": "",
            "app": "MyApp",
            "inputTeam": "",
            "teamOut": "\\CxServer\\SP",
            "OutProjectName": "MyRepoName-master"
          }
        ],
        "steps": [
          {
            "step": "Given github repository which contains project CodeInjection",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 958
          },
          {
            "step": "When project is: \"<cx-project>\" and branch=\"<branch>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 961
          },
          {
            "step": "And repo-name is \"<repo-name>\" and --repo-url is supplied and --github flag is supplied",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 965
          },
          {
            "step": "And namespace is: \"<namespace>\" and application is \"<app>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 964
          },
          {
            "step": "And team in application.yml is \"<inputTeam>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 959
          },
          {
            "step": "And multi-tenant=true",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 962
          },
          {
            "step": "Then The request sent to SAST reporitory will contain scan result with project name=\"<OutProjectName>\" and team \"<teamOut>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 966
          }
        ]
      },
      {
        "scenario_name": "test which project name will be used or created for scan with parameters: cx-project,branch,repo-name,namespace,app,multi-tenant. Using file system as a respoiroty.",
        "examples": [
          {
            "team": "",
            "cx-project": "CodeInjection",
            "namespace": "",
            "app": "",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer"
          },
          {
            "team": "\\CxServer",
            "cx-project": "CodeInjection",
            "namespace": "",
            "app": "",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer"
          },
          {
            "team": "\\CxServer\\MyTeam",
            "cx-project": "CodeInjection",
            "namespace": "",
            "app": "",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\MyTeam"
          },
          {
            "team": "",
            "cx-project": "CodeInjection",
            "namespace": "MyNamespace",
            "app": "MyApp",
            "multi-tenant": "true",
            "OutProjectName": "CodeInjection",
            "teamOut": "\\CxServer\\MyNamespace"
          },
          {
            "team": "",
            "cx-project": "CodeInjection",
            "namespace": "MyNamespace",
            "app": "",
            "multi-tenant": "false",
            "OutProjectName": "CodeInjection",
            "teamOut": "exception - team \\CxServer\\MyNamespace doesn't exist"
          }
        ],
        "steps": [
          {
            "step": "Given scan of a file",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When project is: \"<cx-project>\" and source is supplied as a file (-f)",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And team is set to CxServer in application.yml and team parameter is \"<team>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "And namespace is: \"<namespace>\" and application is \"<app>\" and multi-tenant=\"<multi-tenant>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then The request sent to SAST will contain scan result with project name=\"<OutProjectName>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Run multiple different scans in parallel, each with different expected output",
        "examples": [
          {
            "repo_url1": "https://github.com/cxflowtestuser/VB_3845.git",
            "repo_url2": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "high1": "2",
            "medium1": "3",
            "low1": "0",
            "high2": "0",
            "medium2": "0",
            "low2": "1"
          }
        ],
        "steps": [
          {
            "step": "Given there is a SAST environment configured and running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 708
          },
          {
            "step": "When running a scan for repositories \"<repo_url1>\" and \"<repo_url2>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then SAST output for repository1 will contain high severity vulnerabilities <high1>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And and medium vulnerabilities <medium1> and low severity vulnerabilities  <low1>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "Then SAST output for repository2 will contain high severity vulnerabilities <high2>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": -1
          },
          {
            "step": "And and medium vulnerabilities <medium2> and low severity vulnerabilities  <low2>",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": -1
          }
        ]
      },
      {
        "scenario_name": "Input Validation for parameters project, team, preset",
        "examples": [
          {
            "project": "unexisting",
            "team": "CxServer",
            "preset": "Checkmarx Default",
            "exception": "project not found"
          },
          {
            "project": "not_provided",
            "team": "CxServer",
            "preset": "Checkmarx Default",
            "exception": "project is mandatory"
          },
          {
            "project": "CodeInjection1",
            "team": "unexisting",
            "preset": "Checkmarx Default",
            "exception": "team not found in SAST"
          },
          {
            "project": "CodeInjection1",
            "team": "not_provided",
            "preset": "Checkmarx Default",
            "exception": "team is mandatory"
          }
        ],
        "steps": [
          {
            "step": "Given SAST env running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": -1
          },
          {
            "step": "When team is: \"<team>\" and project is: \"<project>\" and preset is \"<preset>\" but parameters are invalid",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": -1
          },
          {
            "step": "Then exception <exception> will be thrown",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 743
          }
        ]
      },
      {
        "scenario_name": "test how excluding folders and files will change scan result",
        "examples": [
          {
            "repoUrl": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "exclude-folders": "",
            "exclude-files": "",
            "loc": "13712",
            "high": "0",
            "medium": "0",
            "low": "1"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "exclude-folders": "public",
            "exclude-files": "",
            "loc": "13656",
            "high": "0",
            "medium": "0",
            "low": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "exclude-folders": "public,src",
            "exclude-files": "",
            "loc": "11482",
            "high": "0",
            "medium": "0",
            "low": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "exclude-folders": "src",
            "exclude-files": "index.html",
            "loc": "11497",
            "high": "0",
            "medium": "0",
            "low": "0"
          },
          {
            "repoUrl": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "exclude-folders": "amplify,graphql",
            "exclude-files": "App.js,serviceWorker.js",
            "loc": "10388",
            "high": "0",
            "medium": "0",
            "low": "1"
          }
        ],
        "steps": [
          {
            "step": "Given there is a SAST environment configured and running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 708
          },
          {
            "step": "When running a scan for repository \"<repoUrl>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 950
          },
          {
            "step": "And The request sent to SAST will contain exclude-folder \"<exclude-folders>\" and exclude files \"<exclude-files>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 945
          },
          {
            "step": "Then SAST output will contain high severity number <high> and medium severity number <medium> and low severity number <low>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 951
          },
          {
            "step": "And scanned lines of code will be \"<loc>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 946
          }
        ]
      },
      {
        "scenario_name": "test scan with different vulnerabilities numbers and verify the json scan report",
        "examples": [
          {
            "repo_url": "https://github.com/cxflowtestuser/amplify-multienv-example.git",
            "high": "0",
            "medium": "0",
            "low": "1",
            "scanType": "Full",
            "branch": "master"
          },
          {
            "repo_url": "https://github.com/cxflowtestuser/Code_Injection.git",
            "high": "0",
            "medium": "1",
            "low": "1",
            "scanType": "Full",
            "branch": "master"
          },
          {
            "repo_url": "https://github.com/cxflowtestuser/VB_3845.git",
            "high": "2",
            "medium": "3",
            "low": "0",
            "scanType": "Inc",
            "branch": "cxflowtestuser-patch-1"
          }
        ],
        "steps": [
          {
            "step": "Given there is a SAST environment configured and running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 708
          },
          {
            "step": "When running a scan for repository \"<repo_url>\"",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 950
          },
          {
            "step": "And parameter path is populated in application.xml and scanType is \"<scanType>\" and branch \"<branch>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 953
          },
          {
            "step": "Then SAST output will contain high severity number <high> and medium severity number <medium> and low severity number <low>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 951
          },
          {
            "step": "And output json logger will have Scan request \"<repo_url>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 955
          }
        ]
      },
      {
        "scenario_name": "test scan for file system repository with different vulnerabilities and verify the json scan report",
        "examples": [
          {
            "high": "2",
            "medium": "3",
            "low": "0",
            "scanType": "Full",
            "team": "\\CxServer\\SP",
            "LoggerScanStatus": "SUCCESS"
          },
          {
            "high": "2",
            "medium": "3",
            "low": "0",
            "scanType": "Inc",
            "team": "\\CxServer\\SP",
            "LoggerScanStatus": "SUCCESS"
          },
          {
            "high": "2",
            "medium": "3",
            "low": "0",
            "scanType": "Inc",
            "team": "invalidTeam",
            "LoggerScanStatus": "FAILURE"
          }
        ],
        "steps": [
          {
            "step": "Given there is a SAST environment configured and running",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 708
          },
          {
            "step": "When running a scan for a specified folder",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 957
          },
          {
            "step": "And parameter path is populated in application.xml and scanType is \"<scanType>\" and team is \"<team>\"",
            "original_keyword": "And",
            "keyword": "When",
            "step_definition_id": 954
          },
          {
            "step": "Then SAST output will contain high severity number <high> and medium severity number <medium> and low severity number <low> and  SAST team name will be \"<team>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 951
          },
          {
            "step": "And output json logger will have Scan request \"<folder>\" and scan status will be \"<LoggerScanStatus>\"",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 956
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow SCA Integration permutation tests",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "create different remote repository scans types and check the returned results",
        "examples": [
          {
            "visibility": "public"
          },
          {
            "visibility": "private"
          }
        ],
        "steps": [
          {
            "step": "Given scan initiator is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 967
          },
          {
            "step": "And scan is configured as a \"<visibility>\" GIT remote repository source",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 989
          },
          {
            "step": "When scan is finished",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 992
          },
          {
            "step": "Then the returned results are not null",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 991
          }
        ]
      },
      {
        "scenario_name": "SCA scan generates a scan report entry is created in Json Logger",
        "examples": [
          {
            "visibility": "public"
          }
        ],
        "steps": [
          {
            "step": "Given scan initiator is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 967
          },
          {
            "step": "And scan is configured as a \"<visibility>\" GIT remote repository source",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 989
          },
          {
            "step": "When scan is finished",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 992
          },
          {
            "step": "Then the returned results are not null",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 991
          },
          {
            "step": "And SCA scan report entry is created in Json Logger",
            "original_keyword": "And",
            "keyword": "Then",
            "step_definition_id": 993
          }
        ]
      },
      {
        "scenario_name": "A failed SCA scan generates an entry with error message in Json Logger",
        "examples": [
          {
            "repository": "http://some_invalid_url"
          }
        ],
        "steps": [
          {
            "step": "Given scan initiator is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 967
          },
          {
            "step": "And scan is configured using invalid GIT remote repository source \"<repository>\"",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 990
          },
          {
            "step": "Then SCA scan report entry is created in Json Logger with corresponding error message",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 993
          }
        ]
      },
      {
        "scenario_name": "Apply filter severity and filter score on SCA results",
        "examples": [
          {
            "severities": "HIGH",
            "score": "7.5",
            "expected_vulnerabilities": "7"
          },
          {
            "severities": "High, medium",
            "score": "6.3",
            "expected_vulnerabilities": "11"
          },
          {
            "severities": "high, invalid",
            "score": "8.7",
            "expected_vulnerabilities": "2"
          },
          {
            "severities": "",
            "score": "6.4",
            "expected_vulnerabilities": "10"
          },
          {
            "severities": "medium",
            "score": "0.0",
            "expected_vulnerabilities": "10"
          },
          {
            "severities": "",
            "score": "0.0",
            "expected_vulnerabilities": "19"
          },
          {
            "severities": "low",
            "score": "0.0",
            "expected_vulnerabilities": "2"
          },
          {
            "severities": "",
            "score": "-0.3",
            "expected_vulnerabilities": "19"
          }
        ],
        "steps": [
          {
            "step": "Given scan initiator is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 967
          },
          {
            "step": "And SCA filter severity is enabled with \"<severities>\" filter",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 980
          },
          {
            "step": "And Sca filter score is enabled with <score> filter",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 981
          },
          {
            "step": "When SCA runs a new scan on Filters-Tests-Repo which contains 8 vulnerabilities results",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 982
          },
          {
            "step": "Then the expected number of sanitized vulnerabilities are <expected_vulnerabilities>",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 983
          }
        ]
      },
      {
        "scenario_name": "Publish SCA results and check ADO tickets are getting created",
        "examples": [],
        "steps": [
          {
            "step": "Given scan initiator is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 967
          },
          {
            "step": "And bug tracker is Azure",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 968
          },
          {
            "step": "When publishing new known unfiltered SCA results with 8 findings including 2 high and 6 medium vulnerabilities",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 969
          },
          {
            "step": "Then new 8 tickets should be created",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 970
          }
        ]
      },
      {
        "scenario_name": "Resolve an open vulnerability and check status updates to closed",
        "examples": [],
        "steps": [
          {
            "step": "Given scanner is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 971
          },
          {
            "step": "And bug tracker is Jira",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 883
          },
          {
            "step": "And bug tracker contains open vulnerabilities",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 973
          },
          {
            "step": "When resolving on of the vulnerabilities",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 974
          },
          {
            "step": "Then resolved vulnerability status should getting update to closed",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 975
          }
        ]
      },
      {
        "scenario_name": "Publish SCA results by zip folder",
        "examples": [],
        "steps": [
          {
            "step": "Given scanner is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 971
          },
          {
            "step": "And enabledZipScan property is set with true",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 999
          }
        ]
      },
      {
        "scenario_name": "Assign new violated policy to a project scan and validate that isPolicyViolated flag in SCA results is positive",
        "examples": [],
        "steps": [
          {
            "step": "Given scanner is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 971
          },
          {
            "step": "And a violated policy is assigned to an existing project",
            "original_keyword": "And",
            "keyword": "Given",
            "step_definition_id": 985
          },
          {
            "step": "When initiating a new scan",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 986
          },
          {
            "step": "Then isPolicyViolated flag in SCA results should be positive",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 987
          }
        ]
      }
    ]
  },
  {
    "feature": "Cx-Flow SCA teams tests",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Create project team and validated returned assignedTeams value",
        "examples": [
          {
            "team": "",
            "returned_value": ""
          },
          {
            "team": "null",
            "returned_value": ""
          },
          {
            "team": "/CxServer",
            "returned_value": "/CxServer"
          },
          {
            "team": "/CxServer/MyTeam",
            "returned_value": "/CxServer/MyTeam"
          }
        ],
        "steps": [
          {
            "step": "Given scanner is SCA",
            "original_keyword": "Given",
            "keyword": "Given",
            "step_definition_id": 971
          },
          {
            "step": "When creating a new project with associated \"<team>\" value",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 996
          },
          {
            "step": "Then project assignedTeams returned value is \"<returned_value>\"",
            "original_keyword": "Then",
            "keyword": "Then",
            "step_definition_id": 997
          }
        ]
      }
    ]
  },
  {
    "feature": "Zipping files",
    "background": [],
    "scenarios": [
      {
        "scenario_name": "Zip a file created and deleted successfully",
        "examples": [],
        "steps": [
          {
            "step": "When Creating zip File at a time",
            "original_keyword": "When",
            "keyword": "When",
            "step_definition_id": 1002
          }
        ]
      }
    ]
  }
]